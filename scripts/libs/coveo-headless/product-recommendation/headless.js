/*! For license information please see headless.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CoveoHeadlessProductRecommendation={})}(this,(function(e){"use strict";var t=Object.create,r=Object.defineProperty,n=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,o=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,s=e=>r(e,"__esModule",{value:!0}),c=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),u=e=>((e,t,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let s of i(t))!a.call(e,s)&&"default"!==s&&r(e,s,{get:()=>t[s],enumerable:!(o=n(t,s))||o.enumerable});return e})(s(r(null!=e?t(o(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e),l=c(((e,t)=>{t.exports=fetch})),d=c((e=>{var t=e&&e.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},t.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var r={delayFirstAttempt:!1,jitter:"none",maxDelay:1/0,numOfAttempts:10,retry:function(){return!0},startingDelay:100,timeMultiple:2};e.getSanitizedOptions=function(e){var n=t(t({},r),e);return n.numOfAttempts<1&&(n.numOfAttempts=1),n}})),h=c((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fullJitter=function(e){var t=Math.random()*e;return Math.round(t)}})),p=c((e=>{Object.defineProperty(e,"__esModule",{value:!0}),e.noJitter=function(e){return e}})),g=c((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=h(),r=p();e.JitterFactory=function(e){return"full"===e.jitter?t.fullJitter:r.noJitter}})),f=c((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=g(),r=function(){function e(e){this.options=e,this.attempt=0}return e.prototype.apply=function(){var e=this;return new Promise((function(t){return setTimeout(t,e.jitteredDelay)}))},e.prototype.setAttemptNumber=function(e){this.attempt=e},Object.defineProperty(e.prototype,"jitteredDelay",{get:function(){return t.JitterFactory(this.options)(this.delay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delay",{get:function(){var e=this.options.startingDelay,t=this.options.timeMultiple,r=this.numOfDelayedAttempts,n=e*Math.pow(t,r);return Math.min(n,this.options.maxDelay)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt},enumerable:!0,configurable:!0}),e}();e.Delay=r})),m=c((e=>{var t,r=e&&e.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,r)},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}),n=e&&e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}c((n=n.apply(e,t||[])).next())}))},i=e&&e.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.apply=function(){return n(this,void 0,void 0,(function(){return i(this,(function(t){return[2,!!this.isFirstAttempt||e.prototype.apply.call(this)]}))}))},Object.defineProperty(t.prototype,"isFirstAttempt",{get:function(){return 0===this.attempt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"numOfDelayedAttempts",{get:function(){return this.attempt-1},enumerable:!0,configurable:!0}),t}(f().Delay);e.SkipFirstDelay=o})),v=c((e=>{var t,r=e&&e.__extends||(t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,r)},function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t}(f().Delay);e.AlwaysDelay=n})),y=c((e=>{Object.defineProperty(e,"__esModule",{value:!0});var t=m(),r=v();e.DelayFactory=function(e,n){var i=function(e){return e.delayFirstAttempt?new r.AlwaysDelay(e):new t.SkipFirstDelay(e)}(e);return i.setAttemptNumber(n),i}})),b=c((e=>{var t=e&&e.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}c((n=n.apply(e,t||[])).next())}))},r=e&&e.__generator||function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(e,"__esModule",{value:!0});var n=d(),i=y();e.backOff=function(e,i){return void 0===i&&(i={}),t(this,void 0,void 0,(function(){var t;return r(this,(function(r){switch(r.label){case 0:return t=n.getSanitizedOptions(i),[4,new o(e,t).execute()];case 1:return[2,r.sent()]}}))}))};var o=function(){function e(e,t){this.request=e,this.options=t,this.attemptNumber=0}return e.prototype.execute=function(){return t(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:if(this.attemptLimitReached)return[3,7];t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.applyDelay()];case 2:return t.sent(),[4,this.request()];case 3:return[2,t.sent()];case 4:return e=t.sent(),this.attemptNumber++,[4,this.options.retry(e,this.attemptNumber)];case 5:if(!t.sent()||this.attemptLimitReached)throw e;return[3,6];case 6:return[3,0];case 7:throw new Error("Something went wrong.")}}))}))},Object.defineProperty(e.prototype,"attemptLimitReached",{get:function(){return this.attemptNumber>=this.options.numOfAttempts},enumerable:!0,configurable:!0}),e.prototype.applyDelay=function(){return t(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return[4,i.DelayFactory(this.options,this.attemptNumber).apply()];case 1:return e.sent(),[2]}}))}))},e}()})),S=c(((e,t)=>{function r(e){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(e);return t<0?void 0:t}t.exports=function(e){if(0===arguments.length)throw new TypeError("1 argument required, but only 0 present.");if((e=(e=`${e}`).replace(/[ \t\n\f\r]/g,"")).length%4==0&&(e=e.replace(/==?$/,"")),e.length%4==1||/[^+/0-9A-Za-z]/.test(e))return null;let t="",n=0,i=0;for(let o=0;o<e.length;o++)n<<=6,n|=r(e[o]),i+=6,24===i&&(t+=String.fromCharCode((16711680&n)>>16),t+=String.fromCharCode((65280&n)>>8),t+=String.fromCharCode(255&n),n=i=0);return 12===i?(n>>=4,t+=String.fromCharCode(n)):18===i&&(n>>=2,t+=String.fromCharCode((65280&n)>>8),t+=String.fromCharCode(255&n)),t}})),w=c(((e,t)=>{function r(e){if(e>=0&&e<64)return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[e]}t.exports=function(e){if(0===arguments.length)throw new TypeError("1 argument required, but only 0 present.");let t;for(e=`${e}`,t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return null;let n="";for(t=0;t<e.length;t+=3){let i=[void 0,void 0,void 0,void 0];i[0]=e.charCodeAt(t)>>2,i[1]=(3&e.charCodeAt(t))<<4,e.length>t+1&&(i[1]|=e.charCodeAt(t+1)>>4,i[2]=(15&e.charCodeAt(t+1))<<2),e.length>t+2&&(i[2]|=e.charCodeAt(t+2)>>6,i[3]=63&e.charCodeAt(t+2));for(let e=0;e<i.length;e++)void 0===i[e]?n+="=":n+=r(i[e])}return n}})),k=c(((e,t)=>{var r=S(),n=w();t.exports={atob:r,btoa:n}})),O=c(((e,t)=>{var r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0;if(!r)throw new Error("Unable to find global scope. Are you sure this is running in the browser?");if(!r.AbortController)throw new Error('Could not find "AbortController" in the global scope. You need to polyfill it first');t.exports.AbortController=r.AbortController})),C=c(((e,t)=>{t.exports=()=>document.cookie.includes("Coveo-Pendagron")})),I=c(((e,t)=>{var r,n;r=e,n=function(){var e=6e4,t=36e5,r="millisecond",n="second",i="minute",o="hour",a="day",s="week",c="month",u="quarter",l="year",d="date",h="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,f={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||t[0])+"]"}},m=function(e,t,r){var n=String(e);return!n||n.length>=t?e:""+Array(t+1-n.length).join(r)+e},v={s:m,z:function(e){var t=-e.utcOffset(),r=Math.abs(t),n=Math.floor(r/60),i=r%60;return(t<=0?"+":"-")+m(n,2,"0")+":"+m(i,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var n=12*(r.year()-t.year())+(r.month()-t.month()),i=t.clone().add(n,c),o=r-i<0,a=t.clone().add(n+(o?-1:1),c);return+(-(n+(r-i)/(o?i-a:a-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:l,w:s,d:a,D:d,h:o,m:i,s:n,ms:r,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",b={};b[y]=f;var S="$isDayjsObject",w=function(e){return e instanceof I||!(!e||!e[S])},k=function e(t,r,n){var i;if(!t)return y;if("string"==typeof t){var o=t.toLowerCase();b[o]&&(i=o),r&&(b[o]=r,i=o);var a=t.split("-");if(!i&&a.length>1)return e(a[0])}else{var s=t.name;b[s]=t,i=s}return!n&&i&&(y=i),i||!n&&y},O=function(e,t){if(w(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new I(r)},C=v;C.l=k,C.i=w,C.w=function(e,t){return O(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var I=function(){function f(e){this.$L=k(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[S]=!0}var m=f.prototype;return m.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(C.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var n=t.match(p);if(n){var i=n[2]-1||0,o=(n[7]||"0").substring(0,3);return r?new Date(Date.UTC(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)):new Date(n[1],i,n[3]||1,n[4]||0,n[5]||0,n[6]||0,o)}}return new Date(t)}(e),this.init()},m.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},m.$utils=function(){return C},m.isValid=function(){return this.$d.toString()!==h},m.isSame=function(e,t){var r=O(e);return this.startOf(t)<=r&&r<=this.endOf(t)},m.isAfter=function(e,t){return O(e)<this.startOf(t)},m.isBefore=function(e,t){return this.endOf(t)<O(e)},m.$g=function(e,t,r){return C.u(e)?this[t]:this.set(r,e)},m.unix=function(){return Math.floor(this.valueOf()/1e3)},m.valueOf=function(){return this.$d.getTime()},m.startOf=function(e,t){var r=this,u=!!C.u(t)||t,h=C.p(e),p=function(e,t){var n=C.w(r.$u?Date.UTC(r.$y,t,e):new Date(r.$y,t,e),r);return u?n:n.endOf(a)},g=function(e,t){return C.w(r.toDate()[e].apply(r.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(t)),r)},f=this.$W,m=this.$M,v=this.$D,y="set"+(this.$u?"UTC":"");switch(h){case l:return u?p(1,0):p(31,11);case c:return u?p(1,m):p(0,m+1);case s:var b=this.$locale().weekStart||0,S=(f<b?f+7:f)-b;return p(u?v-S:v+(6-S),m);case a:case d:return g(y+"Hours",0);case o:return g(y+"Minutes",1);case i:return g(y+"Seconds",2);case n:return g(y+"Milliseconds",3);default:return this.clone()}},m.endOf=function(e){return this.startOf(e,!1)},m.$set=function(e,t){var s,u=C.p(e),h="set"+(this.$u?"UTC":""),p=(s={},s[a]=h+"Date",s[d]=h+"Date",s[c]=h+"Month",s[l]=h+"FullYear",s[o]=h+"Hours",s[i]=h+"Minutes",s[n]=h+"Seconds",s[r]=h+"Milliseconds",s)[u],g=u===a?this.$D+(t-this.$W):t;if(u===c||u===l){var f=this.clone().set(d,1);f.$d[p](g),f.init(),this.$d=f.set(d,Math.min(this.$D,f.daysInMonth())).$d}else p&&this.$d[p](g);return this.init(),this},m.set=function(e,t){return this.clone().$set(e,t)},m.get=function(e){return this[C.p(e)]()},m.add=function(r,u){var d,h=this;r=Number(r);var p=C.p(u),g=function(e){var t=O(h);return C.w(t.date(t.date()+Math.round(e*r)),h)};if(p===c)return this.set(c,this.$M+r);if(p===l)return this.set(l,this.$y+r);if(p===a)return g(1);if(p===s)return g(7);var f=(d={},d[i]=e,d[o]=t,d[n]=1e3,d)[p]||1,m=this.$d.getTime()+r*f;return C.w(m,this)},m.subtract=function(e,t){return this.add(-1*e,t)},m.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||h;var n=e||"YYYY-MM-DDTHH:mm:ssZ",i=C.z(this),o=this.$H,a=this.$m,s=this.$M,c=r.weekdays,u=r.months,l=r.meridiem,d=function(e,r,i,o){return e&&(e[r]||e(t,n))||i[r].slice(0,o)},p=function(e){return C.s(o%12||12,e,"0")},f=l||function(e,t,r){var n=e<12?"AM":"PM";return r?n.toLowerCase():n};return n.replace(g,(function(e,n){return n||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return C.s(t.$y,4,"0");case"M":return s+1;case"MM":return C.s(s+1,2,"0");case"MMM":return d(r.monthsShort,s,u,3);case"MMMM":return d(u,s);case"D":return t.$D;case"DD":return C.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(r.weekdaysMin,t.$W,c,2);case"ddd":return d(r.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(o);case"HH":return C.s(o,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return f(o,a,!0);case"A":return f(o,a,!1);case"m":return String(a);case"mm":return C.s(a,2,"0");case"s":return String(t.$s);case"ss":return C.s(t.$s,2,"0");case"SSS":return C.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")}))},m.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},m.diff=function(r,d,h){var p,g=this,f=C.p(d),m=O(r),v=(m.utcOffset()-this.utcOffset())*e,y=this-m,b=function(){return C.m(g,m)};switch(f){case l:p=b()/12;break;case c:p=b();break;case u:p=b()/3;break;case s:p=(y-v)/6048e5;break;case a:p=(y-v)/864e5;break;case o:p=y/t;break;case i:p=y/e;break;case n:p=y/1e3;break;default:p=y}return h?p:C.a(p)},m.daysInMonth=function(){return this.endOf(c).$D},m.$locale=function(){return b[this.$L]},m.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),n=k(e,t,!0);return n&&(r.$L=n),r},m.clone=function(){return C.w(this.$d,this)},m.toDate=function(){return new Date(this.valueOf())},m.toJSON=function(){return this.isValid()?this.toISOString():null},m.toISOString=function(){return this.$d.toISOString()},m.toString=function(){return this.$d.toUTCString()},f}(),E=I.prototype;return O.prototype=E,[["$ms",r],["$s",n],["$m",i],["$H",o],["$W",a],["$M",c],["$y",l],["$D",d]].forEach((function(e){E[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),O.extend=function(e,t){return e.$i||(e(t,I,O),e.$i=!0),O},O.locale=k,O.isDayjs=w,O.unix=function(e){return O(1e3*e)},O.en=b[y],O.Ls=b,O.p={},O},"object"==typeof e&&void 0!==t?t.exports=n():"function"==typeof define&&define.amd?define(n):(r="undefined"!=typeof globalThis?globalThis:r||self).dayjs=n()})),E=c(((e,t)=>{var r,n;r=e,n=function(){var e={year:0,month:1,day:2,hour:3,minute:4,second:5},t={};return function(r,n,i){var o,a=function(e,r,n){void 0===n&&(n={});var i=new Date(e);return function(e,r){void 0===r&&(r={});var n=r.timeZoneName||"short",i=e+"|"+n,o=t[i];return o||(o=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:e,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:n}),t[i]=o),o}(r,n).formatToParts(i)},s=function(t,r){for(var n=a(t,r),o=[],s=0;s<n.length;s+=1){var c=n[s],u=c.type,l=c.value,d=e[u];d>=0&&(o[d]=parseInt(l,10))}var h=o[3],p=24===h?0:h,g=o[0]+"-"+o[1]+"-"+o[2]+" "+p+":"+o[4]+":"+o[5]+":000",f=+t;return(i.utc(g).valueOf()-(f-=f%1e3))/6e4},c=n.prototype;c.tz=function(e,t){void 0===e&&(e=o);var r=this.utcOffset(),n=this.toDate(),a=n.toLocaleString("en-US",{timeZone:e}),s=Math.round((n-new Date(a))/1e3/60),c=i(a,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(15*-Math.round(n.getTimezoneOffset()/15)-s,!0);if(t){var u=c.utcOffset();c=c.add(r-u,"minute")}return c.$x.$timezone=e,c},c.offsetName=function(e){var t=this.$x.$timezone||i.tz.guess(),r=a(this.valueOf(),t,{timeZoneName:e}).find((function(e){return"timezonename"===e.type.toLowerCase()}));return r&&r.value};var u=c.startOf;c.startOf=function(e,t){if(!this.$x||!this.$x.$timezone)return u.call(this,e,t);var r=i(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return u.call(r,e,t).tz(this.$x.$timezone,!0)},i.tz=function(e,t,r){var n=r&&t,a=r||t||o,c=s(+i(),a);if("string"!=typeof e)return i(e).tz(a);var u=function(e,t,r){var n=e-60*t*1e3,i=s(n,r);if(t===i)return[n,t];var o=s(n-=60*(i-t)*1e3,r);return i===o?[n,i]:[e-60*Math.min(i,o)*1e3,Math.max(i,o)]}(i.utc(e,n).valueOf(),c,a),l=u[0],d=u[1],h=i(l).utcOffset(d);return h.$x.$timezone=a,h},i.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},i.tz.setDefault=function(e){o=e}}},"object"==typeof e&&void 0!==t?t.exports=n():"function"==typeof define&&define.amd?define(n):(r="undefined"!=typeof globalThis?globalThis:r||self).dayjs_plugin_timezone=n()})),A=c(((e,t)=>{var r,n;r=e,n=function(){var e="minute",t=/[+-]\d\d(?::?\d\d)?/g,r=/([+-]|\d\d)/g;return function(n,i,o){var a=i.prototype;o.utc=function(e){return new i({date:e,utc:!0,args:arguments})},a.utc=function(t){var r=o(this.toDate(),{locale:this.$L,utc:!0});return t?r.add(this.utcOffset(),e):r},a.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var s=a.parse;a.parse=function(e){e.utc&&(this.$u=!0),this.$utils().u(e.$offset)||(this.$offset=e.$offset),s.call(this,e)};var c=a.init;a.init=function(){if(this.$u){var e=this.$d;this.$y=e.getUTCFullYear(),this.$M=e.getUTCMonth(),this.$D=e.getUTCDate(),this.$W=e.getUTCDay(),this.$H=e.getUTCHours(),this.$m=e.getUTCMinutes(),this.$s=e.getUTCSeconds(),this.$ms=e.getUTCMilliseconds()}else c.call(this)};var u=a.utcOffset;a.utcOffset=function(n,i){var o=this.$utils().u;if(o(n))return this.$u?0:o(this.$offset)?u.call(this):this.$offset;if("string"==typeof n&&null===(n=function(e){void 0===e&&(e="");var n=e.match(t);if(!n)return null;var i=(""+n[0]).match(r)||["-",0,0],o=i[0],a=60*+i[1]+ +i[2];return 0===a?0:"+"===o?a:-a}(n)))return this;var a=Math.abs(n)<=16?60*n:n,s=this;if(i)return s.$offset=a,s.$u=0===n,s;if(0!==n){var c=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(s=this.local().add(a+c,e)).$offset=a,s.$x.$localOffset=c}else s=this.utc();return s};var l=a.format;a.format=function(e){var t=e||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return l.call(this,t)},a.valueOf=function(){var e=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*e},a.isUTC=function(){return!!this.$u},a.toISOString=function(){return this.toDate().toISOString()},a.toString=function(){return this.toDate().toUTCString()};var d=a.toDate;a.toDate=function(e){return"s"===e&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():d.call(this)};var h=a.diff;a.diff=function(e,t,r){if(e&&this.$u===e.$u)return h.call(this,e,t,r);var n=this.local(),i=o(e).local();return h.call(n,i,t,r)}}},"object"==typeof e&&void 0!==t?t.exports=n():"function"==typeof define&&define.amd?define(n):(r="undefined"!=typeof globalThis?globalThis:r||self).dayjs_plugin_utc=n()})),D=c(((e,t)=>{function r(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}t.exports=function(e,t,n){var i=n&&n.stringify||r;if("object"==typeof e&&null!==e){var o=t.length+1;if(1===o)return e;var a=new Array(o);a[0]=i(e);for(var s=1;s<o;s++)a[s]=i(t[s]);return a.join(" ")}if("string"!=typeof e)return e;var c=t.length;if(0===c)return e;for(var u="",l=0,d=-1,h=e&&e.length||0,p=0;p<h;){if(37===e.charCodeAt(p)&&p+1<h){switch(d=d>-1?d:0,e.charCodeAt(p+1)){case 100:case 102:if(l>=c||null==t[l])break;d<p&&(u+=e.slice(d,p)),u+=Number(t[l]),d=p+2,p++;break;case 105:if(l>=c||null==t[l])break;d<p&&(u+=e.slice(d,p)),u+=Math.floor(Number(t[l])),d=p+2,p++;break;case 79:case 111:case 106:if(l>=c||void 0===t[l])break;d<p&&(u+=e.slice(d,p));var g=typeof t[l];if("string"===g){u+="'"+t[l]+"'",d=p+2,p++;break}if("function"===g){u+=t[l].name||"<anonymous>",d=p+2,p++;break}u+=i(t[l]),d=p+2,p++;break;case 115:if(l>=c)break;d<p&&(u+=e.slice(d,p)),u+=String(t[l]),d=p+2,p++;break;case 37:d<p&&(u+=e.slice(d,p)),u+="%",d=p+2,p++,l--}++l}++p}return-1===d?e:(d<h&&(u+=e.slice(d)),u)}})),R=c(((e,t)=>{var r=D();t.exports=l;var n=function(){function e(e){return void 0!==e&&e}try{return"undefined"!=typeof globalThis||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}().console||{},i={mapHttpRequest:m,mapHttpResponse:m,wrapRequestSerializer:v,wrapResponseSerializer:v,wrapErrorSerializer:v,req:m,res:m,err:g,errWithCause:g};function o(e,t){return"silent"===e?1/0:t.levels.values[e]}var a=Symbol("pino.logFuncs"),s=Symbol("pino.hierarchy"),c={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function u(e,t){let r={logger:t,parent:e[s]};t[s]=r}function l(e){(e=e||{}).browser=e.browser||{};let t=e.browser.transmit;if(t&&"function"!=typeof t.send)throw Error("pino: transmit option must have a send function");let r=e.browser.write||n;e.browser.write&&(e.browser.asObject=!0);let i=e.serializers||{},s=function(e,t){return Array.isArray(e)?e.filter((function(e){return"!stdSerializers.err"!==e})):!0===e&&Object.keys(t)}(e.browser.serialize,i),g=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(g=!1);let m=Object.keys(e.customLevels||{}),v=["error","fatal","warn","info","debug","trace"].concat(m);"function"==typeof r&&v.forEach((function(e){r[e]=r})),(!1===e.enabled||e.browser.disabled)&&(e.level="silent");let b=e.level||"info",S=Object.create(r);S.log||(S.log=y),function(e,t,r){let i={};t.forEach((e=>{i[e]=r[e]?r[e]:n[e]||n[c[e]||"log"]||y})),e[a]=i}(S,v,r),u({},S),Object.defineProperty(S,"levelVal",{get:function(){return o(this.level,this)}}),Object.defineProperty(S,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,d(this,w,S,"error"),d(this,w,S,"fatal"),d(this,w,S,"warn"),d(this,w,S,"info"),d(this,w,S,"debug"),d(this,w,S,"trace"),m.forEach((e=>{d(this,w,S,e)}))}});let w={transmit:t,serialize:s,asObject:e.browser.asObject,levels:v,timestamp:f(e)};return S.levels=function(e){let t=e.customLevels||{},r=Object.assign({},l.levels.values,t),n=Object.assign({},l.levels.labels,function(e){let t={};return Object.keys(e).forEach((function(r){t[e[r]]=r})),t}(t));return{values:r,labels:n}}(e),S.level=b,S.setMaxListeners=S.getMaxListeners=S.emit=S.addListener=S.on=S.prependListener=S.once=S.prependOnceListener=S.removeListener=S.removeAllListeners=S.listeners=S.listenerCount=S.eventNames=S.write=S.flush=y,S.serializers=i,S._serialize=s,S._stdErrSerialize=g,S.child=function(r,n){if(!r)throw new Error("missing bindings for child Pino");n=n||{},s&&r.serializers&&(n.serializers=r.serializers);let o=n.serializers;if(s&&o){var a=Object.assign({},i,o),c=!0===e.browser.serialize?Object.keys(a):s;delete r.serializers,h([r],c,a,this._stdErrSerialize)}function l(e){this._childLevel=1+(0|e._childLevel),this.bindings=r,a&&(this.serializers=a,this._serialize=c),t&&(this._logEvent=p([].concat(e._logEvent.bindings,r)))}l.prototype=this;let d=new l(this);return u(this,d),d.level=this.level,d},t&&(S._logEvent=p()),S}function d(e,t,i,c){if(e[c]=o(e.level,i)>o(c,i)?y:i[a][c],!t.transmit&&e[c]===y)return;e[c]=function(e,t,i,s){return function(a){return function(){let c=t.timestamp(),u=new Array(arguments.length),l=Object.getPrototypeOf&&Object.getPrototypeOf(this)===n?n:this;for(var d=0;d<u.length;d++)u[d]=arguments[d];if(t.serialize&&!t.asObject&&h(u,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?a.call(l,function(e,t,n,i){e._serialize&&h(n,e._serialize,e.serializers,e._stdErrSerialize);let o=n.slice(),a=o[0],s={};i&&(s.time=i),s.level=e.levels.values[t];let c=1+(0|e._childLevel);if(c<1&&(c=1),null!==a&&"object"==typeof a){for(;c--&&"object"==typeof o[0];)Object.assign(s,o.shift());a=o.length?r(o.shift(),o):void 0}else"string"==typeof a&&(a=r(o.shift(),o));return void 0!==a&&(s.msg=a),s}(this,s,u,c)):a.apply(l,u),t.transmit){let r=t.transmit.level||e._level,n=i.levels.values[r],a=i.levels.values[s];if(a<n)return;!function(e,t,r){let n=t.send,i=t.ts,o=t.methodLevel,a=t.methodValue,s=t.val,c=e._logEvent.bindings;h(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter((function(e){return-1===c.indexOf(e)})),e._logEvent.level.label=o,e._logEvent.level.value=a,n(o,e._logEvent,s),e._logEvent=p(c)}(this,{ts:c,methodLevel:s,methodValue:a,transmitLevel:r,transmitValue:i.levels.values[t.transmit.level||e._level],send:t.transmit.send,val:o(e._level,i)},u)}}}(e[a][s])}(e,t,i,c);let u=function(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[s];for(;r.parent;)r=r.parent,r.logger.bindings&&t.push(r.logger.bindings);return t.reverse()}(e);0!==u.length&&(e[c]=function(e,t){return function(){return t.apply(this,[...e,...arguments])}}(u,e[c]))}function h(e,t,r,n){for(let i in e)if(n&&e[i]instanceof Error)e[i]=l.stdSerializers.err(e[i]);else if("object"==typeof e[i]&&!Array.isArray(e[i]))for(let n in e[i])t&&t.indexOf(n)>-1&&n in r&&(e[i][n]=r[n](e[i][n]))}function p(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function g(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)void 0===t[r]&&(t[r]=e[r]);return t}function f(e){return"function"==typeof e.timestamp?e.timestamp:!1===e.timestamp?b:S}function m(){return{}}function v(e){return e}function y(){}function b(){return!1}function S(){return Date.now()}l.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},l.stdSerializers=i,l.stdTimeFunctions=Object.assign({},{nullTime:b,epochTime:S,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),t.exports.default=l,t.exports.pino=l}));((e,t)=>{for(var n in s(e),t)r(e,n,{get:t[n],enumerable:!0})})(e,{buildCartRecommendationsList:()=>Aa,buildContext:()=>_a,buildController:()=>Sa,buildDictionaryFieldContext:()=>$a,buildFrequentlyBoughtTogetherList:()=>Ia,buildFrequentlyViewedDifferentCategoryList:()=>Na,buildFrequentlyViewedSameCategoryList:()=>qa,buildFrequentlyViewedTogetherList:()=>Ra,buildPopularBoughtRecommendationsList:()=>xa,buildPopularViewedRecommendationsList:()=>Pa,buildProductRecommendationEngine:()=>na,buildUserInterestRecommendationsList:()=>Fa,getSampleProductRecommendationEngineConfiguration:()=>ta,loadClickAnalyticsActions:()=>aa,loadConfigurationActions:()=>ia,loadContextActions:()=>pa,loadDictionaryFieldContextActions:()=>ya,loadProductRecommendationsActions:()=>oa,loadSearchHubActions:()=>ba});var U=()=>global.crypto,x=class extends Error{constructor(e){super(e),this.name="SchemaValidationError"}},j=class{constructor(e){this.definition=e}validate(e={},t=""){let r={...this.default,...e},n=[];for(let e in this.definition){let t=this.definition[e].validate(r[e]);t&&n.push(`${e}: ${t}`)}if(n.length)throw function(e,t){let r=`\n  The following properties are invalid:\n\n    ${e.join("\n\t")}\n  \n  ${t}\n  `;return new x(r)}(n,t);return r}get default(){let e={};for(let t in this.definition){let r=this.definition[t].default;void 0!==r&&(e[t]=r)}return e}},P=class{constructor(e={}){this.baseConfig=e}validate(e){return this.baseConfig.required&&F(e)?"value is required.":null}get default(){return this.baseConfig.default instanceof Function?this.baseConfig.default():this.baseConfig.default}get required(){return!0===this.baseConfig.required}};function T(e){return void 0===e}function F(e){return T(e)||function(e){return null===e}(e)}var _=class{constructor(e={}){this.config=e,this.value=new P(e)}validate(e){return this.value.validate(e)||(function(e){return T(e)||$(e)}(e)?e<this.config.min?`minimum value of ${this.config.min} not respected.`:e>this.config.max?`maximum value of ${this.config.max} not respected.`:null:"value is not a number.")}get default(){return this.value.default}get required(){return this.value.required}};function $(e){return"number"==typeof e&&!isNaN(e)}var L=class{constructor(e={}){this.value=new P(e)}validate(e){return this.value.validate(e)||(function(e){return T(e)||q(e)}(e)?null:"value is not a boolean.")}get default(){return this.value.default}get required(){return this.value.required}};function q(e){return"boolean"==typeof e}var M=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i,N=class{constructor(e={}){this.config={emptyAllowed:!0,url:!1,...e},this.value=new P(this.config)}validate(e){let{emptyAllowed:t,url:r,regex:n,constrainTo:i}=this.config;return this.value.validate(e)||(T(e)?null:V(e)?t||e.length?r&&!M.test(e)?"value is not a valid URL.":n&&!n.test(e)?`value did not match provided regex ${n}`:i&&!i.includes(e)?`value should be one of: ${i.join(", ")}.`:null:"value is an empty string.":"value is not a string.")}get default(){return this.value.default}get required(){return this.value.required}};function V(e){return"[object String]"===Object.prototype.toString.call(e)}var z=class{constructor(e={}){this.config={options:{required:!1},values:{},...e}}validate(e){if(T(e))return this.config.options.required?"value is required and is currently undefined":null;if(!H(e))return"value is not an object";for(let[t,r]of Object.entries(this.config.values))if(r.required&&F(e[t]))return`value does not contain ${t}`;let t="";for(let[r,n]of Object.entries(this.config.values)){let i=e[r],o=n.validate(i);null!==o&&(t+=" "+o)}return""===t?null:t}get default(){}get required(){return!!this.config.options.required}};function H(e){return void 0!==e&&"object"==typeof e}var B=class{constructor(e={}){this.config=e,this.value=new P(this.config)}validate(e){if(!F(e)&&!Array.isArray(e))return"value is not an array";let t=this.value.validate(e);if(null!==t)return t;if(F(e))return null;if(void 0!==this.config.max&&e.length>this.config.max)return`value contains more than ${this.config.max}`;if(void 0!==this.config.min&&e.length<this.config.min)return`value contains less than ${this.config.min}`;if(void 0!==this.config.each){let t="";return e.forEach((r=>{this.config.each.required&&F(r)&&(t=`value is null or undefined: ${e.join(",")}`);let n=this.validatePrimitiveValue(r,this.config.each);null!==n&&(t+=" "+n)})),""===t?null:t}return null}validatePrimitiveValue(e,t){return q(e)||V(e)||$(e)||H(e)?t.validate(e):"value is not a primitive value"}get default(){}get required(){return this.value.required}},Q=e=>e;function G(e){let{url:t,accessToken:r,organizationId:n,authentication:i,...o}=e;return o}var Y=e=>{let{response:t}=e;return t.body?W(e):K(t)},W=e=>function(e){return void 0!==e.body.exception}(e)?J(e):function(e){return void 0!==e.body.statusCode}(e)?e.body:{message:"unknown",statusCode:0,type:"unknown"},K=e=>{let t=JSON.parse(JSON.stringify(e,Object.getOwnPropertyNames(e)));return{...t,message:`Client side error: ${t.message||""}`,statusCode:400,type:"ClientError"}},J=e=>({message:e.body.exception.code,statusCode:e.response.status,type:e.body.exception.code}),Z=u(l()),X=u(b()),ee=new Error("Failed to load reducers."),te=class extends Error{constructor(){super(),this.name="ExpiredToken",this.message="The token being used to perform the request is expired."}},re=class extends Error{constructor(e,t){super(),this.name="Disconnected",this.message=`Client could not connect to the following URL: ${e}`,this.statusCode=null!=t?t:0}},ne=(u(k()),new Set(["1",1,"yes",!0]));function ie(){if("undefined"==typeof navigator||"undefined"==typeof window)return!1;let e=navigator,t=window;return[e.globalPrivacyControl,e.doNotTrack,e.msDoNotTrack,t.doNotTrack].some((e=>ne.has(e)))}function oe(e){if("object"!=typeof e||!e)return e;try{return JSON.parse(JSON.stringify(e))}catch(t){return e}}function ae(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e}function se(e){return 429===e}var ce=class{static async call(e){let t=function(e){let{url:t,method:r,requestParams:n,contentType:i,accessToken:o,signal:a}=e,s="POST"===e.method||"PUT"===e.method,c=function(e,t){return"application/x-www-form-urlencoded"===t?function(e){return!("object"!=typeof e||!e)&&Object.values(e).every(ae)}(e)?function(e){let t=[];for(let r in e){let n=encodeURIComponent(r),i=encodeURIComponent(e[r]);t.push(`${n}=${i}`)}return t.join("&")}(e):"":JSON.stringify(e)}(n,i);return{url:t,method:r,headers:{"Content-Type":i,Authorization:`Bearer ${o}`,...e.headers},...s&&{body:c},signal:a}}(e),{logger:r}=e,n=await ce.preprocessRequest(t,e);r.info(n,"Platform request");let{url:i,...o}=n,a=async()=>{let e=await(0,Z.default)(i,o);if(se(e.status))throw e;return e};try{let e=await(0,X.backOff)(a,{retry:e=>{let t=e&&se(e.status);return t&&r.info("Platform retrying request"),t}});if(419===e.status)throw r.info("Platform renewing token"),new te;if(404===e.status)throw new re(i,e.status);return r.info({response:e,requestInfo:n},"Platform response"),e}catch(e){return"Failed to fetch"===e.message?new re(i):e}}static async preprocessRequest(e,t){let{origin:r,preprocessRequest:n,logger:i,requestMetadata:o}=t,{signal:a,...s}=e,c=oe(s);try{let t=await n(e,r,o);return{...e,...t}}catch(e){i.error(e,"Platform request preprocessing failed. Returning default request options.")}return c}};function ue(e,t){return`https://${e}${t&&t.environment&&"prod"!==t.environment?t.environment:""}${t&&t.region&&"us"!==t.region?`-${t.region}`:""}.cloud.coveo.com`}function le(e,t="prod"){let r="prod"===t?"":t,n=`https://${e}.org${r}.coveo.com`;return{platform:n,analytics:`https://${e}.analytics.org${r}.coveo.com`,search:`${n}/rest/search/v2`,admin:`https://${e}.admin.org${r}.coveo.com`}}function de(e){return(null==e?void 0:e.multiRegionSubDomain)?`https://${e.multiRegionSubDomain}.org.coveo.com`:ue("platform",e)}var he=class{constructor(){this.currentAbortController=null}async enqueue(e,t){var r;let n=this.currentAbortController,i=this.currentAbortController=function(){if("undefined"==typeof window){let{AbortController:e}=O();return new e}return"undefined"==typeof AbortController?null:new AbortController}();n&&(t.warnOnAbort&&t.logger.warn("Cancelling current pending search query"),n.abort());try{return await e(null!=(r=null==i?void 0:i.signal)?r:null)}finally{this.currentAbortController===i&&(this.currentAbortController=null)}}},pe=class{constructor(e){this._params={},this._basePath=e}addParam(e,t){this._params={...this.params,[e]:t}}get basePath(){return this._basePath}get params(){return this._params}get hasParams(){return Object.entries(this._params).length}get href(){return this.hasParams?`${this.basePath}?${Object.entries(this.params).map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&")}`:this.basePath}},ge=e=>{let t=e.match(/^https:\/\/(?<organizationId>\w+)\.org(?<environment>dev|stg|hipaa)?\.coveo\.com/);return(null==t?void 0:t.groups)?t.groups:null},fe=(e,t,r,n)=>{let i=new pe(`${e.url}${n}`);return i.addParam("organizationId",e.organizationId),e.authentication&&i.addParam("authentication",e.authentication),{accessToken:e.accessToken,method:t,contentType:r,url:i.href,origin:"searchApiFetch"}};function me(e){return{statusCode:e.statusCode,type:e.name,message:e.message}}function ve(e){return{statusCode:e.code,type:e.name,message:e.message,ignored:!0}}function ye(e,t){if(t&&"AbortError"===e.name)return{error:ve(e)};if(e instanceof re)return{error:me(e)};throw e}var be=class{constructor(e){this.options=e,this.apiCallsQueues={unknown:new he,mainSearch:new he,facetValues:new he,foldingCollection:new he,instantResults:new he}}async plan(e){let t=await ce.call({...fe(e,"POST","application/json","/plan"),requestParams:G(e),requestMetadata:{method:"plan"},...this.options});if(t instanceof Error)return ye(t);let r=await t.json();return void 0!==r.preprocessingOutput?{success:r}:{error:Y({response:t,body:r})}}async querySuggest(e){let t=await ce.call({...fe(e,"POST","application/json","/querySuggest"),requestMetadata:{method:"querySuggest"},requestParams:G(e),...this.options});if(t instanceof Error)return ye(t);let r=await t.json(),n={response:t,body:r};return void 0!==r.completions?{success:(await this.options.postprocessQuerySuggestResponseMiddleware(n)).body}:{error:Y(n)}}async search(e,t){var r;let n=null!=(r=null==t?void 0:t.origin)?r:"unknown",i=await this.apiCallsQueues[n].enqueue((r=>ce.call({...fe(e,"POST","application/json",""),requestParams:G(e),requestMetadata:{method:"search",origin:null==t?void 0:t.origin},...this.options,signal:null!=r?r:void 0})),{logger:this.options.logger,warnOnAbort:!(null==t?void 0:t.disableAbortWarning)});if(i instanceof Error)return ye(i,null==t?void 0:t.disableAbortWarning);let o=await i.json(),a={response:i,body:o};return Se(o)?(a.body=function(e){let t={answerSnippet:"",documentId:{contentIdKey:"",contentIdValue:""},question:"",relatedQuestions:[],score:0};return F(e.questionAnswer)?(e.questionAnswer=t,e):(e.questionAnswer={...t,...e.questionAnswer},e)}(o),{success:(await this.options.postprocessSearchResponseMiddleware(a)).body}):{error:Y(a)}}async facetSearch(e){let t=await ce.call({...fe(e,"POST","application/json","/facet"),requestParams:G(e),requestMetadata:{method:"facetSearch"},...this.options});if(t instanceof Error)throw t;let r=await t.json(),n={response:t,body:r};return(await this.options.postprocessFacetSearchResponseMiddleware(n)).body}async recommendations(e){let t=await ce.call({...fe(e,"POST","application/json",""),requestParams:G(e),requestMetadata:{method:"recommendations"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return Se(r)?{success:r}:{error:Y({response:t,body:r})}}async html(e){return(async(e,t)=>{let r=await ce.call({...fe(e,"POST","application/x-www-form-urlencoded","/html"),requestParams:G(e),requestMetadata:{method:"html"},...t});if(r instanceof Error)throw r;let n=await r.text();return function(e){return"string"==typeof e}(n)?{success:n}:{error:Y({response:r,body:n})}})(e,{...this.options})}async productRecommendations(e){let t=await ce.call({...fe(e,"POST","application/json",""),requestParams:G(e),requestMetadata:{method:"productRecommendations"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return Se(r)?{success:r}:{error:Y({response:t,body:r})}}async fieldDescriptions(e){let t=await ce.call({...fe(e,"GET","application/json","/fields"),requestParams:{},requestMetadata:{method:"fieldDescriptions"},...this.options});if(t instanceof Error)throw t;let r=await t.json();return void 0!==r.fields?{success:r}:{error:Y({response:t,body:r})}}};function Se(e){return void 0!==e.results}var we=e=>e,ke=e=>e,Oe=e=>e;function Ce(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw Error("[Immer] minified error nr: "+e+(r.length?" "+r.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Ie(e){return!!e&&!!e[lt]}function Ee(e){var t;return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object||"function"==typeof r&&Function.toString.call(r)===dt}(e)||Array.isArray(e)||!!e[ut]||!!(null===(t=e.constructor)||void 0===t?void 0:t[ut])||je(e)||Pe(e))}function Ae(e,t,r){void 0===r&&(r=!1),0===De(e)?(r?Object.keys:ht)(e).forEach((function(n){r&&"symbol"==typeof n||t(n,e[n],e)})):e.forEach((function(r,n){return t(n,r,e)}))}function De(e){var t=e[lt];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:je(e)?2:Pe(e)?3:0}function Re(e,t){return 2===De(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function Ue(e,t,r){var n=De(e);2===n?e.set(t,r):3===n?e.add(r):e[t]=r}function xe(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}function je(e){return ot&&e instanceof Map}function Pe(e){return at&&e instanceof Set}function Te(e){return e.o||e.t}function Fe(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=pt(e);delete t[lt];for(var r=ht(t),n=0;n<r.length;n++){var i=r[n],o=t[i];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Object.getPrototypeOf(e),t)}function _e(e,t){return void 0===t&&(t=!1),Le(e)||Ie(e)||!Ee(e)||(De(e)>1&&(e.set=e.add=e.clear=e.delete=$e),Object.freeze(e),t&&Ae(e,(function(e,t){return _e(t,!0)}),!0)),e}function $e(){Ce(2)}function Le(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function qe(e){var t=gt[e];return t||Ce(18,e),t}function Me(){return nt}function Ne(e,t){t&&(qe("Patches"),e.u=[],e.s=[],e.v=t)}function Ve(e){ze(e),e.p.forEach(Be),e.p=null}function ze(e){e===nt&&(nt=e.l)}function He(e){return nt={p:[],l:nt,h:e,m:!0,_:0}}function Be(e){var t=e[lt];0===t.i||1===t.i?t.j():t.g=!0}function Qe(e,t){t._=t.p.length;var r=t.p[0],n=void 0!==e&&e!==r;return t.h.O||qe("ES5").S(t,e,n),n?(r[lt].P&&(Ve(t),Ce(4)),Ee(e)&&(e=Ge(t,e),t.l||We(t,e)),t.u&&qe("Patches").M(r[lt].t,e,t.u,t.s)):e=Ge(t,r,[]),Ve(t),t.u&&t.v(t.u,t.s),e!==ct?e:void 0}function Ge(e,t,r){if(Le(t))return t;var n=t[lt];if(!n)return Ae(t,(function(i,o){return Ye(e,n,t,i,o,r)}),!0),t;if(n.A!==e)return t;if(!n.P)return We(e,n.t,!0),n.t;if(!n.I){n.I=!0,n.A._--;var i=4===n.i||5===n.i?n.o=Fe(n.k):n.o,o=i,a=!1;3===n.i&&(o=new Set(i),i.clear(),a=!0),Ae(o,(function(t,o){return Ye(e,n,i,t,o,r,a)})),We(e,i,!1),r&&e.u&&qe("Patches").N(n,r,e.u,e.s)}return n.o}function Ye(e,t,r,n,i,o,a){if(Ie(i)){var s=Ge(e,i,o&&t&&3!==t.i&&!Re(t.R,n)?o.concat(n):void 0);if(Ue(r,n,s),!Ie(s))return;e.m=!1}else a&&r.add(i);if(Ee(i)&&!Le(i)){if(!e.h.D&&e._<1)return;Ge(e,i),t&&t.A.l||We(e,i)}}function We(e,t,r){void 0===r&&(r=!1),!e.l&&e.h.D&&e.m&&_e(t,r)}function Ke(e,t){var r=e[lt];return(r?Te(r):e)[t]}function Je(e,t){if(t in e)for(var r=Object.getPrototypeOf(e);r;){var n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Object.getPrototypeOf(r)}}function Ze(e){e.P||(e.P=!0,e.l&&Ze(e.l))}function Xe(e){e.o||(e.o=Fe(e.t))}function et(e,t,r){var n=je(t)?qe("MapSet").F(t,r):Pe(t)?qe("MapSet").T(t,r):e.O?function(e,t){var r=Array.isArray(e),n={i:r?1:0,A:t?t.A:Me(),P:!1,I:!1,R:{},l:t,t:e,k:null,o:null,j:null,C:!1},i=n,o=ft;r&&(i=[n],o=mt);var a=Proxy.revocable(i,o),s=a.revoke,c=a.proxy;return n.k=c,n.j=s,c}(t,r):qe("ES5").J(t,r);return(r?r.A:Me()).p.push(n),n}function tt(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Fe(e)}var rt,nt,it="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),ot="undefined"!=typeof Map,at="undefined"!=typeof Set,st="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,ct=it?Symbol.for("immer-nothing"):((rt={})["immer-nothing"]=!0,rt),ut=it?Symbol.for("immer-draftable"):"__$immer_draftable",lt=it?Symbol.for("immer-state"):"__$immer_state",dt=("undefined"!=typeof Symbol&&Symbol.iterator,""+Object.prototype.constructor),ht="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,pt=Object.getOwnPropertyDescriptors||function(e){var t={};return ht(e).forEach((function(r){t[r]=Object.getOwnPropertyDescriptor(e,r)})),t},gt={},ft={get:function(e,t){if(t===lt)return e;var r,n,i,o=Te(e);if(!Re(o,t))return r=e,(i=Je(o,t))?"value"in i?i.value:null===(n=i.get)||void 0===n?void 0:n.call(r.k):void 0;var a=o[t];return e.I||!Ee(a)?a:a===Ke(e.t,t)?(Xe(e),e.o[t]=et(e.A.h,a,e)):a},has:function(e,t){return t in Te(e)},ownKeys:function(e){return Reflect.ownKeys(Te(e))},set:function(e,t,r){var n=Je(Te(e),t);if(null==n?void 0:n.set)return n.set.call(e.k,r),!0;if(!e.P){var i=Ke(Te(e),t),o=null==i?void 0:i[lt];if(o&&o.t===r)return e.o[t]=r,e.R[t]=!1,!0;if(xe(r,i)&&(void 0!==r||Re(e.t,t)))return!0;Xe(e),Ze(e)}return e.o[t]===r&&(void 0!==r||t in e.o)||Number.isNaN(r)&&Number.isNaN(e.o[t])||(e.o[t]=r,e.R[t]=!0),!0},deleteProperty:function(e,t){return void 0!==Ke(e.t,t)||t in e.t?(e.R[t]=!1,Xe(e),Ze(e)):delete e.R[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var r=Te(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:n.enumerable,value:r[t]}},defineProperty:function(){Ce(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Ce(12)}},mt={};Ae(ft,(function(e,t){mt[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),mt.deleteProperty=function(e,t){return mt.set.call(this,e,t,void 0)},mt.set=function(e,t,r){return ft.set.call(this,e[0],t,r,e[0])};var vt=function(){function e(e){var t=this;this.O=st,this.D=!0,this.produce=function(e,r,n){if("function"==typeof e&&"function"!=typeof r){var i=r;r=e;var o=t;return function(e){var t=this;void 0===e&&(e=i);for(var n=arguments.length,a=Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];return o.produce(e,(function(e){var n;return(n=r).call.apply(n,[t,e].concat(a))}))}}var a;if("function"!=typeof r&&Ce(6),void 0!==n&&"function"!=typeof n&&Ce(7),Ee(e)){var s=He(t),c=et(t,e,void 0),u=!0;try{a=r(c),u=!1}finally{u?Ve(s):ze(s)}return"undefined"!=typeof Promise&&a instanceof Promise?a.then((function(e){return Ne(s,n),Qe(e,s)}),(function(e){throw Ve(s),e})):(Ne(s,n),Qe(a,s))}if(!e||"object"!=typeof e){if(void 0===(a=r(e))&&(a=e),a===ct&&(a=void 0),t.D&&_e(a,!0),n){var l=[],d=[];qe("Patches").M(e,a,l,d),n(l,d)}return a}Ce(21,e)},this.produceWithPatches=function(e,r){if("function"==typeof e)return function(r){for(var n=arguments.length,i=Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return t.produceWithPatches(r,(function(t){return e.apply(void 0,[t].concat(i))}))};var n,i,o=t.produce(e,r,(function(e,t){n=e,i=t}));return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return[e,n,i]})):[o,n,i]},"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze)}var t=e.prototype;return t.createDraft=function(e){Ee(e)||Ce(8),Ie(e)&&(e=function(e){return Ie(e)||Ce(22,e),function e(t){if(!Ee(t))return t;var r,n=t[lt],i=De(t);if(n){if(!n.P&&(n.i<4||!qe("ES5").K(n)))return n.t;n.I=!0,r=tt(t,i),n.I=!1}else r=tt(t,i);return Ae(r,(function(t,i){n&&function(e,t){return 2===De(e)?e.get(t):e[t]}(n.t,t)===i||Ue(r,t,e(i))})),3===i?new Set(r):r}(e)}(e));var t=He(this),r=et(this,e,void 0);return r[lt].C=!0,ze(t),r},t.finishDraft=function(e,t){var r=(e&&e[lt]).A;return Ne(r,t),Qe(void 0,r)},t.setAutoFreeze=function(e){this.D=e},t.setUseProxies=function(e){e&&!st&&Ce(20),this.O=e},t.applyPatches=function(e,t){var r;for(r=t.length-1;r>=0;r--){var n=t[r];if(0===n.path.length&&"replace"===n.op){e=n.value;break}}r>-1&&(t=t.slice(r+1));var i=qe("Patches").$;return Ie(e)?i(e,t):this.produce(e,(function(e){return i(e,t)}))},e}(),yt=new vt,bt=yt.produce,St=(yt.produceWithPatches.bind(yt),yt.setAutoFreeze.bind(yt),yt.setUseProxies.bind(yt),yt.applyPatches.bind(yt),yt.createDraft.bind(yt),yt.finishDraft.bind(yt),bt);function wt(e){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kt(e,t,r){return(t=function(e){var t=function(e,t){if("object"!==wt(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==wt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===wt(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ot(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ct(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(r),!0).forEach((function(t){kt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ot(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function It(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}var Et="function"==typeof Symbol&&Symbol.observable||"@@observable",At=function(){return Math.random().toString(36).substring(7).split("").join(".")},Dt={INIT:"@@redux/INIT"+At(),REPLACE:"@@redux/REPLACE"+At(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+At()}};function Rt(e,t,r){var n;if("function"==typeof t&&"function"==typeof r||"function"==typeof r&&"function"==typeof arguments[3])throw new Error(It(0));if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error(It(1));return r(Rt)(e,t)}if("function"!=typeof e)throw new Error(It(2));var i=e,o=t,a=[],s=a,c=!1;function u(){s===a&&(s=a.slice())}function l(){if(c)throw new Error(It(3));return o}function d(e){if("function"!=typeof e)throw new Error(It(4));if(c)throw new Error(It(5));var t=!0;return u(),s.push(e),function(){if(t){if(c)throw new Error(It(6));t=!1,u();var r=s.indexOf(e);s.splice(r,1),a=null}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error(It(7));if(void 0===e.type)throw new Error(It(8));if(c)throw new Error(It(9));try{c=!0,o=i(o,e)}finally{c=!1}for(var t=a=s,r=0;r<t.length;r++)(0,t[r])();return e}return h({type:Dt.INIT}),(n={dispatch:h,subscribe:d,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error(It(10));i=e,h({type:Dt.REPLACE})}})[Et]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(It(11));function r(){e.next&&e.next(l())}return r(),{unsubscribe:t(r)}}})[Et]=function(){return this},e},n}function Ut(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var i=t[n];"function"==typeof e[i]&&(r[i]=e[i])}var o,a=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:Dt.INIT}))throw new Error(It(12));if(void 0===r(void 0,{type:Dt.PROBE_UNKNOWN_ACTION()}))throw new Error(It(13))}))}(r)}catch(e){o=e}return function(e,t){if(void 0===e&&(e={}),o)throw o;for(var n=!1,i={},s=0;s<a.length;s++){var c=a[s],u=r[c],l=e[c],d=u(l,t);if(void 0===d)throw t&&t.type,new Error(It(14));i[c]=d,n=n||d!==l}return(n=n||a.length!==Object.keys(e).length)?i:e}}function xt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function jt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error(It(15))},i={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},o=t.map((function(e){return e(i)}));return n=xt.apply(void 0,o)(r.dispatch),Ct(Ct({},r),{},{dispatch:n})}}}function Pt(e){return function(t){var r=t.dispatch,n=t.getState;return function(t){return function(i){return"function"==typeof i?i(r,n,e):t(i)}}}}var Tt=Pt();Tt.withExtraArgument=Pt;var Ft,_t=Tt,$t=(Ft=function(e,t){return(Ft=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Ft(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),Lt=function(e,t){for(var r=0,n=t.length,i=e.length;r<n;r++,i++)e[i]=t[r];return e},qt=Object.defineProperty,Mt=Object.defineProperties,Nt=Object.getOwnPropertyDescriptors,Vt=Object.getOwnPropertySymbols,zt=Object.prototype.hasOwnProperty,Ht=Object.prototype.propertyIsEnumerable,Bt=function(e,t,r){return t in e?qt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r},Qt=function(e,t){for(var r in t||(t={}))zt.call(t,r)&&Bt(e,r,t[r]);if(Vt)for(var n=0,i=Vt(t);n<i.length;n++)r=i[n],Ht.call(t,r)&&Bt(e,r,t[r]);return e},Gt=function(e,t){return Mt(e,Nt(t))},Yt="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?xt:xt.apply(null,arguments)};function Wt(e,t){function r(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];if(t){var i=t.apply(void 0,r);if(!i)throw new Error("prepareAction did not return an object");return Qt(Qt({type:e,payload:i.payload},"meta"in i&&{meta:i.meta}),"error"in i&&{error:i.error})}return{type:e,payload:r[0]}}return r.toString=function(){return""+e},r.type=e,r.match=function(t){return t.type===e},r}"undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__;var Kt=function(e){function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=e.apply(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i}return $t(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,Lt([void 0],e[0].concat(this)))):new(t.bind.apply(t,Lt([void 0],e.concat(this))))},t}(Array),Jt=function(e){function t(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var i=e.apply(this,r)||this;return Object.setPrototypeOf(i,t.prototype),i}return $t(t,e),Object.defineProperty(t,Symbol.species,{get:function(){return t},enumerable:!1,configurable:!0}),t.prototype.concat=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.prototype.concat.apply(this,t)},t.prototype.prepend=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return 1===e.length&&Array.isArray(e[0])?new(t.bind.apply(t,Lt([void 0],e[0].concat(this)))):new(t.bind.apply(t,Lt([void 0],e.concat(this))))},t}(Array);function Zt(e){return Ee(e)?St(e,(function(){})):e}var Xt=!0;function er(e){var t,r=function(e){return function(e){void 0===e&&(e={});var t=e.thunk,r=void 0===t||t,n=(e.immutableCheck,e.serializableCheck,e.actionCreatorCheck,new Kt);return r&&(function(e){return"boolean"==typeof e}(r)?n.push(_t):n.push(_t.withExtraArgument(r.extraArgument))),n}(e)},n=e||{},i=n.reducer,o=void 0===i?void 0:i,a=n.middleware,s=void 0===a?r():a,c=n.devTools,u=void 0===c||c,l=n.preloadedState,d=void 0===l?void 0:l,h=n.enhancers,p=void 0===h?void 0:h;if("function"==typeof o)t=o;else{if(!function(e){if("object"!=typeof e||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var r=t;null!==Object.getPrototypeOf(r);)r=Object.getPrototypeOf(r);return t===r}(o))throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');t=Ut(o)}var g=s;if("function"==typeof g&&(g=g(r),!Xt&&!Array.isArray(g)))throw new Error("when using a middleware builder function, an array of middleware must be returned");if(!Xt&&g.some((function(e){return"function"!=typeof e})))throw new Error("each middleware provided to configureStore must be a function");var f=jt.apply(void 0,g),m=xt;u&&(m=Yt(Qt({trace:!Xt},"object"==typeof u&&u)));var v=new Jt(f),y=v;return Array.isArray(p)?y=Lt([f],p):"function"==typeof p&&(y=p(v)),Rt(t,d,m.apply(void 0,y))}function tr(e,t,r,n){void 0===r&&(r=[]);var i,o="function"==typeof t?function(e){var t,r={},n=[],i={addCase:function(e,t){var n="string"==typeof e?e:e.type;if(!n)throw new Error("`builder.addCase` cannot be called with an empty action type");if(n in r)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return r[n]=t,i},addMatcher:function(e,t){return n.push({matcher:e,reducer:t}),i},addDefaultCase:function(e){return t=e,i}};return e(i),[r,n,t]}(t):[t,r,n],a=o[0],s=o[1],c=o[2];if(function(e){return"function"==typeof e}(e))i=function(){return Zt(e())};else{var u=Zt(e);i=function(){return u}}function l(e,t){void 0===e&&(e=i());var r=Lt([a[t.type]],s.filter((function(e){return(0,e.matcher)(t)})).map((function(e){return e.reducer})));return 0===r.filter((function(e){return!!e})).length&&(r=[c]),r.reduce((function(e,r){if(r){var n;if(Ie(e))return void 0===(n=r(e,t))?e:n;if(Ee(e))return St(e,(function(e){return r(e,t)}));if(void 0===(n=r(e,t))){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return n}return e}),e)}return l.getInitialState=i,l}var rr=["name","message","stack","code"],nr=function(e,t){this.payload=e,this.meta=t},ir=function(e,t){this.payload=e,this.meta=t},or=function(e){if("object"==typeof e&&null!==e){for(var t={},r=0,n=rr;r<n.length;r++){var i=n[r];"string"==typeof e[i]&&(t[i]=e[i])}return t}return{message:String(e)}},ar=function(){function e(e,t,r){var n=Wt(e+"/fulfilled",(function(e,t,r,n){return{payload:e,meta:Gt(Qt({},n||{}),{arg:r,requestId:t,requestStatus:"fulfilled"})}})),i=Wt(e+"/pending",(function(e,t,r){return{payload:void 0,meta:Gt(Qt({},r||{}),{arg:t,requestId:e,requestStatus:"pending"})}})),o=Wt(e+"/rejected",(function(e,t,n,i,o){return{payload:i,error:(r&&r.serializeError||or)(e||"Rejected"),meta:Gt(Qt({},o||{}),{arg:n,requestId:t,rejectedWithValue:!!i,requestStatus:"rejected",aborted:"AbortError"===(null==e?void 0:e.name),condition:"ConditionError"===(null==e?void 0:e.name)})}})),a="undefined"!=typeof AbortController?AbortController:function(){function e(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return e.prototype.abort=function(){},e}();return Object.assign((function(e){return function(s,c,u){var l,d=(null==r?void 0:r.idGenerator)?r.idGenerator(e):function(e){void 0===e&&(e=21);for(var t="",r=e;r--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t}(),h=new a;function p(e){l=e,h.abort()}var g=function(){return function(e,t,r){return new Promise((function(t,n){var i=function(e){try{a(r.next(e))}catch(e){n(e)}},o=function(e){try{a(r.throw(e))}catch(e){n(e)}},a=function(e){return e.done?t(e.value):Promise.resolve(e.value).then(i,o)};a((r=r.apply(e,null)).next())}))}(this,0,(function(){var a,g,f,m,v,y;return function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}(this,(function(b){switch(b.label){case 0:return b.trys.push([0,4,,5]),function(e){return null!==e&&"object"==typeof e&&"function"==typeof e.then}(m=null==(a=null==r?void 0:r.condition)?void 0:a.call(r,e,{getState:c,extra:u}))?[4,m]:[3,2];case 1:m=b.sent(),b.label=2;case 2:if(!1===m||h.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return v=new Promise((function(e,t){return h.signal.addEventListener("abort",(function(){return t({name:"AbortError",message:l||"Aborted"})}))})),s(i(d,e,null==(g=null==r?void 0:r.getPendingMeta)?void 0:g.call(r,{requestId:d,arg:e},{getState:c,extra:u}))),[4,Promise.race([v,Promise.resolve(t(e,{dispatch:s,getState:c,extra:u,requestId:d,signal:h.signal,abort:p,rejectWithValue:function(e,t){return new nr(e,t)},fulfillWithValue:function(e,t){return new ir(e,t)}})).then((function(t){if(t instanceof nr)throw t;return t instanceof ir?n(t.payload,d,e,t.meta):n(t,d,e)}))])];case 3:return f=b.sent(),[3,5];case 4:return y=b.sent(),f=y instanceof nr?o(null,d,e,y.payload,y.meta):o(y,d,e),[3,5];case 5:return r&&!r.dispatchConditionRejection&&o.match(f)&&f.meta.condition||s(f),[2,f]}}))}))}();return Object.assign(g,{abort:p,requestId:d,arg:e,unwrap:function(){return g.then(sr)}})}}),{pending:i,rejected:o,fulfilled:n,typePrefix:e})}return e.withTypes=function(){return e},e}();function sr(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}var cr="listenerMiddleware";Wt(cr+"/add"),Wt(cr+"/removeAll"),Wt(cr+"/remove"),"function"==typeof queueMicrotask&&queueMicrotask.bind("undefined"!=typeof window?window:"undefined"!=typeof global?global:globalThis),"undefined"!=typeof window&&window.requestAnimationFrame&&window.requestAnimationFrame,function(){function e(e,t){var r=i[e];return r?r.enumerable=t:i[e]=r={configurable:!0,enumerable:t,get:function(){var t=this[lt];return ft.get(t,e)},set:function(t){var r=this[lt];ft.set(r,e,t)}},r}function t(e){for(var t=e.length-1;t>=0;t--){var i=e[t][lt];if(!i.P)switch(i.i){case 5:n(i)&&Ze(i);break;case 4:r(i)&&Ze(i)}}}function r(e){for(var t=e.t,r=e.k,n=ht(r),i=n.length-1;i>=0;i--){var o=n[i];if(o!==lt){var a=t[o];if(void 0===a&&!Re(t,o))return!0;var s=r[o],c=s&&s[lt];if(c?c.t!==a:!xe(s,a))return!0}}var u=!!t[lt];return n.length!==ht(t).length+(u?0:1)}function n(e){var t=e.k;if(t.length!==e.t.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);if(r&&!r.get)return!0;for(var n=0;n<t.length;n++)if(!t.hasOwnProperty(n))return!0;return!1}var i={};!function(e,t){gt.ES5||(gt.ES5=t)}(0,{J:function(t,r){var n=Array.isArray(t),i=function(t,r){if(t){for(var n=Array(r.length),i=0;i<r.length;i++)Object.defineProperty(n,""+i,e(i,!0));return n}var o=pt(r);delete o[lt];for(var a=ht(o),s=0;s<a.length;s++){var c=a[s];o[c]=e(c,t||!!o[c].enumerable)}return Object.create(Object.getPrototypeOf(r),o)}(n,t),o={i:n?5:4,A:r?r.A:Me(),P:!1,I:!1,R:{},l:r,t,k:i,o:null,g:!1,C:!1};return Object.defineProperty(i,lt,{value:o,writable:!0}),i},S:function(e,r,i){i?Ie(r)&&r[lt].A===e&&t(e.p):(e.u&&function e(t){if(t&&"object"==typeof t){var r=t[lt];if(r){var i=r.t,o=r.k,a=r.R,s=r.i;if(4===s)Ae(o,(function(t){t!==lt&&(void 0!==i[t]||Re(i,t)?a[t]||e(o[t]):(a[t]=!0,Ze(r)))})),Ae(i,(function(e){void 0!==o[e]||Re(o,e)||(a[e]=!1,Ze(r))}));else if(5===s){if(n(r)&&(Ze(r),a.length=!0),o.length<i.length)for(var c=o.length;c<i.length;c++)a[c]=!1;else for(var u=i.length;u<o.length;u++)a[u]=!0;for(var l=Math.min(o.length,i.length),d=0;d<l;d++)o.hasOwnProperty(d)||(a[d]=!0),void 0===a[d]&&e(o[d])}}}}(e.p[0]),t(e.p))},K:function(e){return 4===e.i?r(e):n(e)}})}();var ur,lr=new N({required:!0,emptyAllowed:!1}),dr=new N({required:!1,emptyAllowed:!1}),hr=new N({required:!0,emptyAllowed:!0}),pr=({message:e,name:t,stack:r})=>({message:e,name:t,stack:r}),gr=(e,t)=>{if("required"in t)return{payload:new j({value:t}).validate({value:e}).value};let r=new z({options:{required:!0},values:t}).validate(e);if(r)throw new x(r);return{payload:e}},fr=(e,t)=>{try{return gr(e,t)}catch(t){return{payload:e,error:pr(t)}}},mr=(e,t,r,n)=>vr(e,t,r,`Check the options of ${n}`,"Controller initialization error"),vr=(e,t,r,n,i)=>{try{return t.validate(r,n)}catch(t){throw e.logger.error(t,i),t}},yr=()=>dr,br=()=>lr,Sr=Wt("configuration/updateBasicConfiguration",(e=>fr(e,{accessToken:dr,organizationId:dr,platformUrl:dr}))),wr=Wt("configuration/updateSearchConfiguration",(e=>fr(e,{apiBaseUrl:dr,pipeline:new N({required:!1,emptyAllowed:!0}),searchHub:dr,timezone:dr,locale:dr,authenticationProviders:new B({required:!1,each:lr})}))),kr=Wt("configuration/updateAnalyticsConfiguration",(e=>(ie()&&(e.enabled=!1),fr(e,{enabled:new L({default:!0}),originContext:yr(),originLevel2:yr(),originLevel3:yr(),apiBaseUrl:dr,nextApiBaseUrl:dr,runtimeEnvironment:new P,anonymous:new L({default:!1}),deviceId:dr,userDisplayName:dr,documentLocation:dr,trackingId:dr,analyticsMode:new N({constrainTo:["legacy","next"],required:!1,default:"legacy"})})))),Or=Wt("configuration/analytics/disable"),Cr=Wt("configuration/analytics/enable"),Ir=Wt("configuration/analytics/originlevel2",(e=>fr(e,{originLevel2:br()}))),Er=Wt("configuration/analytics/originlevel3",(e=>fr(e,{originLevel3:br()})));function Ar(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function Dr(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){e.done?i(e.value):function(e){return e instanceof r?e:new r((function(t){t(e)}))}(e.value).then(a,s)}c((n=n.apply(e,t||[])).next())}))}function Rr(){return"undefined"!=typeof navigator}function Ur(){return"undefined"!=typeof document}function xr(){try{return"undefined"!=typeof localStorage}catch{return!1}}function jr(){return Rr()&&navigator.cookieEnabled}!function(e){e.search="search",e.click="click",e.custom="custom",e.view="view",e.collect="collect"}(ur||(ur={}));var Pr=[ur.click,ur.custom,ur.search,ur.view],Tr=(e,t)=>-1!==Pr.indexOf(e)?Object.assign({language:Ur()?document.documentElement.lang:"unknown",userAgent:Rr()?navigator.userAgent:"unknown"},t):t,Fr=class{static set(e,t,r){var n,i,o;r&&(n=new Date).setTime(n.getTime()+r),-1===(o=window.location.hostname).indexOf(".")?_r(e,t,n):_r(e,t,n,(i=o.split("."))[i.length-2]+"."+i[i.length-1])}static get(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){var i=r[n];if(0===(i=i.replace(/^\s+/,"")).lastIndexOf(t,0))return i.substring(t.length,i.length)}return null}static erase(e){Fr.set(e,"",-1)}};function _r(e,t,r,n){document.cookie=`${e}=${t}`+(r?`;expires=${r.toUTCString()}`:"")+(n?`;domain=${n}`:"")+";path=/;SameSite=Lax"}var $r=class{getItem(e){return Fr.get(`${$r.prefix}${e}`)}removeItem(e){Fr.erase(`${$r.prefix}${e}`)}setItem(e,t,r){Fr.set(`${$r.prefix}${e}`,t,r)}};$r.prefix="coveo_";var Lr,qr=class{constructor(){this.cookieStorage=new $r}getItem(e){return localStorage.getItem(e)||this.cookieStorage.getItem(e)}removeItem(e){this.cookieStorage.removeItem(e),localStorage.removeItem(e)}setItem(e,t){localStorage.setItem(e,t),this.cookieStorage.setItem(e,t,31556926e3)}},Mr=class{getItem(e){return null}removeItem(e){}setItem(e,t){}},Nr="__coveo.analytics.history",Vr=class{constructor(e){this.store=e||(xr()?localStorage:jr()?new $r:function(){try{return"undefined"!=typeof sessionStorage}catch{return!1}}()?sessionStorage:new Mr)}addElement(e){e.internalTime=(new Date).getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=this.getHistoryWithInternalTime();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}addElementAsync(e){return Dr(this,void 0,void 0,(function*(){e.internalTime=(new Date).getTime(),e=this.cropQueryElement(this.stripEmptyQuery(e));let t=yield this.getHistoryWithInternalTimeAsync();null!=t?this.isValidEntry(e)&&this.setHistory([e].concat(t)):this.setHistory([e])}))}getHistory(){let e=this.getHistoryWithInternalTime();return this.stripEmptyQueries(this.stripInternalTime(e))}getHistoryAsync(){return Dr(this,void 0,void 0,(function*(){let e=yield this.getHistoryWithInternalTimeAsync();return this.stripEmptyQueries(this.stripInternalTime(e))}))}getHistoryWithInternalTime(){try{let e=this.store.getItem(Nr);return e&&"string"==typeof e?JSON.parse(e):[]}catch{return[]}}getHistoryWithInternalTimeAsync(){return Dr(this,void 0,void 0,(function*(){try{let e=yield this.store.getItem(Nr);return e?JSON.parse(e):[]}catch{return[]}}))}setHistory(e){try{this.store.setItem(Nr,JSON.stringify(e.slice(0,20)))}catch{}}clear(){try{this.store.removeItem(Nr)}catch{}}getMostRecentElement(){let e=this.getHistoryWithInternalTime();return Array.isArray(e)?e.sort(((e,t)=>(t.internalTime||0)-(e.internalTime||0)))[0]:null}cropQueryElement(e){return e.name&&e.value&&"query"===e.name.toLowerCase()&&(e.value=e.value.slice(0,75)),e}isValidEntry(e){let t=this.getMostRecentElement();return!t||t.value!=e.value||(e.internalTime||0)-(t.internalTime||0)>6e4}stripInternalTime(e){return Array.isArray(e)?e.map((e=>{let{name:t,time:r,value:n}=e;return{name:t,time:r,value:n}})):[]}stripEmptyQuery(e){let{name:t,time:r,value:n}=e;return t&&"string"==typeof n&&"query"===t.toLowerCase()&&""===n.trim()?{name:t,time:r}:e}stripEmptyQueries(e){return e.map((e=>this.stripEmptyQuery(e)))}},zr=Object.freeze({__proto__:null,HistoryStore:Vr,MAX_NUMBER_OF_HISTORY_ELEMENTS:20,MAX_VALUE_SIZE:75,MIN_THRESHOLD_FOR_DUPLICATE_VALUE:6e4,STORE_KEY:Nr,default:Vr}),Hr=(e,t)=>Dr(void 0,void 0,void 0,(function*(){return e===ur.view?(yield Br(t.contentIdValue),Object.assign({location:window.location.toString(),referrer:document.referrer,title:document.title},t)):t})),Br=e=>Dr(void 0,void 0,void 0,(function*(){let t=new Vr,r={name:"PageView",value:e,time:(new Date).toISOString()};yield t.addElementAsync(r)})),Qr=new Uint8Array(16);function Gr(){if(!Lr&&!(Lr="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Lr(Qr)}var Yr=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Wr(e){return"string"==typeof e&&Yr.test(e)}var Kr=[];for(let e=0;e<256;++e)Kr.push((e+256).toString(16).slice(1));function Jr(e,t=0){return(Kr[e[t+0]]+Kr[e[t+1]]+Kr[e[t+2]]+Kr[e[t+3]]+"-"+Kr[e[t+4]]+Kr[e[t+5]]+"-"+Kr[e[t+6]]+Kr[e[t+7]]+"-"+Kr[e[t+8]]+Kr[e[t+9]]+"-"+Kr[e[t+10]]+Kr[e[t+11]]+Kr[e[t+12]]+Kr[e[t+13]]+Kr[e[t+14]]+Kr[e[t+15]]).toLowerCase()}var Zr={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function Xr(e,t,r){if(Zr.randomUUID&&!t&&!e)return Zr.randomUUID();let n=(e=e||{}).random||(e.rng||Gr)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=n[e];return t}return Jr(n)}function en(e,t,r,n){switch(e){case 0:return t&r^~t&n;case 1:case 3:return t^r^n;case 2:return t&r^t&n^r&n}}function tn(e,t){return e<<t|e>>>32-t}var rn=function(e,t,r){function n(e,t,r,n){var i;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));let t=[];for(let r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t}(e)),"string"==typeof t&&(t=function(e){if(!Wr(e))throw TypeError("Invalid UUID");let t,r=new Uint8Array(16);return r[0]=(t=parseInt(e.slice(0,8),16))>>>24,r[1]=t>>>16&255,r[2]=t>>>8&255,r[3]=255&t,r[4]=(t=parseInt(e.slice(9,13),16))>>>8,r[5]=255&t,r[6]=(t=parseInt(e.slice(14,18),16))>>>8,r[7]=255&t,r[8]=(t=parseInt(e.slice(19,23),16))>>>8,r[9]=255&t,r[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,r[11]=t/4294967296&255,r[12]=t>>>24&255,r[13]=t>>>16&255,r[14]=t>>>8&255,r[15]=255&t,r}(t)),16!==(null===(i=t)||void 0===i?void 0:i.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let o=new Uint8Array(16+e.length);if(o.set(t),o.set(e,t.length),o=function(e){let t=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){let t=unescape(encodeURIComponent(e));e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);let n=e.length/4+2,i=Math.ceil(n/16),o=new Array(i);for(let t=0;t<i;++t){let r=new Uint32Array(16);for(let n=0;n<16;++n)r[n]=e[64*t+4*n]<<24|e[64*t+4*n+1]<<16|e[64*t+4*n+2]<<8|e[64*t+4*n+3];o[t]=r}o[i-1][14]=8*(e.length-1)/Math.pow(2,32),o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<i;++e){let n=new Uint32Array(80);for(let t=0;t<16;++t)n[t]=o[e][t];for(let e=16;e<80;++e)n[e]=tn(n[e-3]^n[e-8]^n[e-14]^n[e-16],1);let i=r[0],a=r[1],s=r[2],c=r[3],u=r[4];for(let e=0;e<80;++e){let r=Math.floor(e/20),o=tn(i,5)+en(r,a,s,c)+u+t[r]+n[e]>>>0;u=c,c=s,s=tn(a,30)>>>0,a=i,i=o}r[0]=r[0]+i>>>0,r[1]=r[1]+a>>>0,r[2]=r[2]+s>>>0,r[3]=r[3]+c>>>0,r[4]=r[4]+u>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}(o),o[6]=15&o[6]|80,o[8]=63&o[8]|128,r){n=n||0;for(let e=0;e<16;++e)r[n+e]=o[e];return r}return Jr(o)}try{n.name="v5"}catch{}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}(),nn=rn,on="2.28.20",an=e=>`${e.protocol}//${e.hostname}${0===e.pathname.indexOf("/")?e.pathname:`/${e.pathname}`}${e.search}`,sn={pageview:"pageview",event:"event"},cn=class{constructor({client:e,uuidGenerator:t=Xr}){this.client=e,this.uuidGenerator=t}},un=class extends cn{constructor({client:e,uuidGenerator:t=Xr}){super({client:e,uuidGenerator:t}),this.actionData={},this.pageViewId=t(),this.nextPageViewId=this.pageViewId,this.currentLocation=an(window.location),this.lastReferrer=Ur()?document.referrer:"",this.addHooks()}getApi(e){return"setAction"===e?this.setAction:null}setAction(e,t){this.action=e,this.actionData=t}clearData(){this.clearPluginData(),this.action=void 0,this.actionData={}}getLocationInformation(e,t){return Object.assign({hitType:e},this.getNextValues(e,t))}updateLocationInformation(e,t){this.updateLocationForNextPageView(e,t)}getDefaultContextInformation(e){let t={title:Ur()?document.title:"",encoding:Ur()?document.characterSet:"UTF-8"},r={screenResolution:`${screen.width}x${screen.height}`,screenColor:`${screen.colorDepth}-bit`},n={language:navigator.language,userAgent:navigator.userAgent},i={time:Date.now(),eventId:this.uuidGenerator()};return Object.assign(Object.assign(Object.assign(Object.assign({},i),r),n),t)}updateLocationForNextPageView(e,t){let{pageViewId:r,referrer:n,location:i}=this.getNextValues(e,t);this.lastReferrer=n,this.pageViewId=r,this.currentLocation=i,e===sn.pageview&&(this.nextPageViewId=this.uuidGenerator(),this.hasSentFirstPageView=!0)}getNextValues(e,t){return{pageViewId:e===sn.pageview?this.nextPageViewId:this.pageViewId,referrer:e===sn.pageview&&this.hasSentFirstPageView?this.currentLocation:this.lastReferrer,location:e===sn.pageview?this.getCurrentLocationFromPayload(t):this.currentLocation}}getCurrentLocationFromPayload(e){if(e.page){let t=e=>e.replace(/^\/?(.*)$/,"/$1");return`${(e=>this.currentLocation.split("/").slice(0,3).join("/"))()}${t(e.page)}`}return an(window.location)}},ln=class{constructor(e,t){if(!Wr(e))throw Error("Not a valid uuid");this.clientId=e,this.creationDate=Math.floor(t/1e3)}toString(){return this.clientId.replace(/-/g,"")+"."+this.creationDate.toString()}get expired(){let e=Math.floor(Date.now()/1e3)-this.creationDate;return e<0||e>ln.expirationTime}validate(e,t){return!this.expired&&this.matchReferrer(e,t)}matchReferrer(e,t){try{let r=new URL(e);return t.some((e=>new RegExp(e.replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")+"$").test(r.host)))}catch{return!1}}static fromString(e){let t=e.split(".");if(2!==t.length)return null;let[r,n]=t;if(32!==r.length||isNaN(parseInt(n)))return null;let i=r.substring(0,8)+"-"+r.substring(8,12)+"-"+r.substring(12,16)+"-"+r.substring(16,20)+"-"+r.substring(20,32);return Wr(i)?new ln(i,1e3*Number.parseInt(n)):null}};ln.cvo_cid="cvo_cid",ln.expirationTime=120,class extends cn{constructor({client:e,uuidGenerator:t=Xr}){super({client:e,uuidGenerator:t})}getApi(e){switch(e){case"decorate":return this.decorate;case"acceptFrom":return this.acceptFrom;default:return null}}decorate(e){return Dr(this,void 0,void 0,(function*(){if(!this.client.getCurrentVisitorId)throw new Error("Could not retrieve current clientId");try{let t=new URL(e),r=yield this.client.getCurrentVisitorId();return t.searchParams.set(ln.cvo_cid,new ln(r,Date.now()).toString()),t.toString()}catch{throw new Error("Invalid URL provided")}}))}acceptFrom(e){this.client.setAcceptedLinkReferrers(e)}}.Id="link";var dn=Object.keys;function hn(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}var pn={id:"svc_ticket_id",subject:"svc_ticket_subject",description:"svc_ticket_description",category:"svc_ticket_category",productId:"svc_ticket_product_id",custom:"svc_ticket_custom"},gn=dn(pn).map((e=>pn[e])),fn=[...gn].join("|"),mn=new RegExp(`^(${fn}$)`),vn=[e=>mn.test(e)],yn={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",price:"pr",quantity:"qt",coupon:"cc",position:"ps",group:"group"},bn={id:"id",name:"nm",brand:"br",category:"ca",variant:"va",position:"ps",price:"pr",group:"group"},Sn={action:"pa",list:"pal",listSource:"pls"},wn={id:"ti",revenue:"tr",tax:"tt",shipping:"ts",coupon:"tcc",affiliation:"ta",step:"cos",option:"col"},kn={id:"quoteId",affiliation:"quoteAffiliation"},On={id:"reviewId",rating:"reviewRating",comment:"reviewComment"},Cn={add:Sn,bookmark_add:Sn,bookmark_remove:Sn,click:Sn,checkout:Sn,checkout_option:Sn,detail:Sn,impression:Sn,remove:Sn,refund:Object.assign(Object.assign({},Sn),wn),purchase:Object.assign(Object.assign({},Sn),wn),quickview:Sn,quote:Object.assign(Object.assign({},Sn),kn),review:Object.assign(Object.assign({},Sn),On)},In=dn(yn).map((e=>yn[e])),En=dn(bn).map((e=>bn[e])),An=dn(Sn).map((e=>Sn[e])),Dn=dn(wn).map((e=>wn[e])),Rn=dn(On).map((e=>On[e])),Un=dn(kn).map((e=>kn[e])),xn=[...In,"custom"].join("|"),jn=[...En,"custom"].join("|"),Pn="(pr[0-9]+)",Tn="(il[0-9]+pi[0-9]+)",Fn=new RegExp(`^${Pn}(${xn})$`),_n=new RegExp(`^(${Tn}(${jn}))|(il[0-9]+nm)$`),$n=new RegExp(`^(${An.join("|")})$`),Ln=new RegExp(`^(${Dn.join("|")})$`),qn=new RegExp(`^${Pn}custom$`),Mn=new RegExp(`^${Tn}custom$`),Nn=new RegExp(`^(${["loyaltyCardId","loyaltyTier","thirdPartyPersona","companyName","favoriteStore","storeName","userIndustry","userRole","userDepartment","businessUnit",...Rn,...Un].join("|")})$`),Vn=[e=>_n.test(e),e=>Fn.test(e),e=>$n.test(e),e=>Ln.test(e),e=>Nn.test(e)],zn=[qn,Mn],Hn=Object.assign(Object.assign(Object.assign(Object.assign({},{anonymizeIp:"aip"}),{eventCategory:"ec",eventAction:"ea",eventLabel:"el",eventValue:"ev",page:"dp",visitorId:"cid",clientId:"cid",userId:"uid",currencyCode:"cu"}),{hitType:"t",pageViewId:"pid",encoding:"de",location:"dl",referrer:"dr",screenColor:"sd",screenResolution:"sr",title:"dt",userAgent:"ua",language:"ul",eventId:"z",time:"tm"}),["contentId","contentIdKey","contentType","searchHub","tab","searchUid","permanentId","contentLocale","trackingId"].reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:t})),{})),Bn=Object.assign(Object.assign({},Hn),{svcAction:"svc_action",svcActionData:"svc_action_data"}),Qn=dn(Bn).map((e=>Bn[e])),Gn=e=>-1!==Qn.indexOf(e),Yn=e=>"custom"===e,Wn=class{constructor(e){this.opts=e}sendEvent(e,t){return Dr(this,void 0,void 0,(function*(){if(!this.isAvailable())throw new Error('navigator.sendBeacon is not supported in this browser. Consider adding a polyfill like "sendbeacon-polyfill".');let{baseUrl:r,preprocessRequest:n}=this.opts,i=yield this.getQueryParamsForEventType(e),{url:o,payload:a}=yield this.preProcessRequestAsPotentialJSONString(`${r}/analytics/${e}?${i}`,t,n),s=this.encodeForEventType(e,a),c=new Blob([s],{type:"application/x-www-form-urlencoded"});navigator.sendBeacon(o,c)}))}isAvailable(){return"sendBeacon"in navigator}deleteHttpCookieVisitorId(){return Promise.resolve()}preProcessRequestAsPotentialJSONString(e,t,r){return Dr(this,void 0,void 0,(function*(){let n=e,i=t;if(r){let o=yield r({url:e,body:JSON.stringify(t)},"analyticsBeacon"),{url:a,body:s}=o;n=a||e;try{i=JSON.parse(s)}catch(e){console.error("Unable to process the request body as a JSON string",e)}}return{payload:i,url:n}}))}encodeForEventType(e,t){return this.isEventTypeLegacy(e)?this.encodeForLegacyType(e,t):this.encodeForFormUrlEncoded(Object.assign({access_token:this.opts.token},t))}getQueryParamsForEventType(e){return Dr(this,void 0,void 0,(function*(){let{token:t,visitorIdProvider:r}=this.opts,n=yield r.getCurrentVisitorId();return[t&&this.isEventTypeLegacy(e)?`access_token=${t}`:"",n?`visitorId=${n}`:"","discardVisitInfo=true"].filter((e=>!!e)).join("&")}))}isEventTypeLegacy(e){return-1!==[ur.click,ur.custom,ur.search,ur.view].indexOf(e)}encodeForLegacyType(e,t){return`${e}Event=${encodeURIComponent(JSON.stringify(t))}`}encodeForFormUrlEncoded(e){return Object.keys(e).filter((t=>!!e[t])).map((t=>`${encodeURIComponent(t)}=${encodeURIComponent(this.encodeValue(e[t]))}`)).join("&")}encodeValue(e){return"number"==typeof e||"string"==typeof e||"boolean"==typeof e?e:JSON.stringify(e)}},Kn=class{sendEvent(e,t){return Dr(this,void 0,void 0,(function*(){return Promise.resolve()}))}deleteHttpCookieVisitorId(){return Dr(this,void 0,void 0,(function*(){return Promise.resolve()}))}},Jn=window.fetch,Zn=class{constructor(e){this.opts=e}sendEvent(e,t){return Dr(this,void 0,void 0,(function*(){let{baseUrl:r,visitorIdProvider:n,preprocessRequest:i}=this.opts,o=this.shouldAppendVisitorId(e)?yield this.getVisitorIdParam():"",a={url:`${r}/analytics/${e}${o}`,credentials:"include",mode:"cors",headers:this.getHeaders(),method:"POST",body:JSON.stringify(t)},s=Object.assign(Object.assign({},a),i?yield i(a,"analyticsFetch"):{}),{url:c}=s,u=Ar(s,["url"]),l=yield Jn(c,u);if(l.ok){let e=yield l.json();return e.visitorId&&n.setCurrentVisitorId(e.visitorId),e}try{l.json()}catch{}throw console.error(`An error has occured when sending the "${e}" event.`,l,t),new Error(`An error has occurred when sending the "${e}" event. Check the console logs for more details.`)}))}deleteHttpCookieVisitorId(){return Dr(this,void 0,void 0,(function*(){let{baseUrl:e}=this.opts,t=`${e}/analytics/visit`;yield Jn(t,{headers:this.getHeaders(),method:"DELETE"})}))}shouldAppendVisitorId(e){return-1!==[ur.click,ur.custom,ur.search,ur.view].indexOf(e)}getVisitorIdParam(){return Dr(this,void 0,void 0,(function*(){let{visitorIdProvider:e}=this.opts,t=yield e.getCurrentVisitorId();return t?`?visitor=${t}`:""}))}getHeaders(){let{token:e}=this.opts;return Object.assign(Object.assign({},e?{Authorization:`Bearer ${e}`}:{}),{"Content-Type":"application/json"})}},Xn=class{constructor(e,t){xr()&&jr()?this.storage=new qr:xr()?this.storage=localStorage:(console.warn("BrowserRuntime detected no valid storage available.",this),this.storage=new Mr),this.client=new Zn(e),this.beaconClient=new Wn(e),window.addEventListener("beforeunload",(()=>{let e=t();for(let{eventType:t,payload:r}of e)this.beaconClient.sendEvent(t,r)}))}getClientDependingOnEventType(e){return"click"===e&&this.beaconClient.isAvailable()?this.beaconClient:this.client}},ei=class{constructor(e,t){this.storage=t||new Mr,this.client=new Zn(e)}getClientDependingOnEventType(e){return this.client}},ti=class{constructor(){this.storage=new Mr,this.client=new Kn}getClientDependingOnEventType(e){return this.client}},ri=["1",1,"yes",!0];function ni(){return Rr()&&[navigator.globalPrivacyControl,navigator.doNotTrack,navigator.msDoNotTrack,window.doNotTrack].some((e=>-1!==ri.indexOf(e)))}var ii,oi,ai="https://analytics.cloud.coveo.com/rest/ua",si=class{get defaultOptions(){return{endpoint:ai,isCustomEndpoint:!1,token:"",version:"v15",beforeSendHooks:[],afterSendHooks:[]}}get version(){return on}constructor(e){if(this.acceptedLinkReferrers=[],!e)throw new Error("You have to pass options to this constructor");this.options=Object.assign(Object.assign({},this.defaultOptions),e),this.visitorId="",this.bufferedRequests=[],this.beforeSendHooks=[Hr,Tr].concat(this.options.beforeSendHooks),this.afterSendHooks=this.options.afterSendHooks,this.eventTypeMapping={};let t={baseUrl:this.baseUrl,token:this.options.token,visitorIdProvider:this,preprocessRequest:this.options.preprocessRequest};this.runtime=this.options.runtimeEnvironment||this.initRuntime(t),ni()&&(this.clear(),this.runtime.storage=new Mr)}initRuntime(e){return"undefined"!=typeof window&&Ur()?new Xn(e,(()=>{let e=[...this.bufferedRequests];return this.bufferedRequests=[],e})):("undefined"!=typeof navigator&&"ReactNative"==navigator.product&&console.warn("\n        We've detected you're using React Native but have not provided the corresponding runtime, \n        for an optimal experience please use the \"coveo.analytics/react-native\" subpackage.\n        Follow the Readme on how to set it up: https://github.com/coveo/coveo.analytics.js#using-react-native\n    "),new ei(e))}get storage(){return this.runtime.storage}determineVisitorId(){return Dr(this,void 0,void 0,(function*(){try{return this.extractClientIdFromLink(window.location.href)||(yield this.storage.getItem("visitorId"))||Xr()}catch(e){return console.log("Could not get visitor ID from the current runtime environment storage. Using a random ID instead.",e),Xr()}}))}getCurrentVisitorId(){return Dr(this,void 0,void 0,(function*(){if(!this.visitorId){let e=yield this.determineVisitorId();yield this.setCurrentVisitorId(e)}return this.visitorId}))}setCurrentVisitorId(e){return Dr(this,void 0,void 0,(function*(){this.visitorId=e,yield this.storage.setItem("visitorId",e)}))}setClientId(e,t){return Dr(this,void 0,void 0,(function*(){if(Wr(e))this.setCurrentVisitorId(e.toLowerCase());else{if(!t)throw Error("Cannot generate uuid client id without a specific namespace string.");this.setCurrentVisitorId(nn(e,nn(t,"38824e1f-37f5-42d3-8372-a4b8fa9df946")))}}))}getParameters(e,...t){return Dr(this,void 0,void 0,(function*(){return yield this.resolveParameters(e,...t)}))}getPayload(e,...t){return Dr(this,void 0,void 0,(function*(){let r=yield this.resolveParameters(e,...t);return yield this.resolvePayloadForParameters(e,r)}))}get currentVisitorId(){return"string"!=typeof(this.visitorId||this.storage.getItem("visitorId"))&&this.setCurrentVisitorId(Xr()),this.visitorId}set currentVisitorId(e){this.visitorId=e,this.storage.setItem("visitorId",e)}extractClientIdFromLink(e){if(ni())return null;try{let t=new URL(e).searchParams.get(ln.cvo_cid);if(null==t)return null;let r=ln.fromString(t);return r&&Ur()&&r.validate(document.referrer,this.acceptedLinkReferrers)?r.clientId:null}catch{}return null}resolveParameters(e,...t){return Dr(this,void 0,void 0,(function*(){let{variableLengthArgumentsNames:r=[],addVisitorIdParameter:n=!1,usesMeasurementProtocol:i=!1,addClientIdParameter:o=!1}=this.eventTypeMapping[e]||{};return yield[e=>r.length>0?this.parseVariableArgumentsPayload(r,e):e[0],e=>Dr(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},e),{visitorId:n?yield this.getCurrentVisitorId():""})})),e=>Dr(this,void 0,void 0,(function*(){return o?Object.assign(Object.assign({},e),{clientId:yield this.getCurrentVisitorId()}):e})),e=>i?this.ensureAnonymousUserWhenUsingApiKey(e):e,t=>this.beforeSendHooks.reduce(((t,r)=>Dr(this,void 0,void 0,(function*(){let n=yield t;return yield r(e,n)}))),t)].reduce(((e,t)=>Dr(this,void 0,void 0,(function*(){let r=yield e;return yield t(r)}))),Promise.resolve(t))}))}resolvePayloadForParameters(e,t){return Dr(this,void 0,void 0,(function*(){let{usesMeasurementProtocol:r=!1}=this.eventTypeMapping[e]||{};return yield[e=>this.setTrackingIdIfTrackingIdNotPresent(e),t=>this.removeEmptyPayloadValues(t,e),t=>this.validateParams(t,e),e=>r?(e=>{let t=!!e.action&&Cn[e.action]||{};return dn(e).reduce(((r,n)=>{let i=t[n]||Bn[n]||n;return Object.assign(Object.assign({},r),{[i]:e[n]})}),{})})(e):e,e=>r?this.removeUnknownParameters(e):e,e=>r?this.processCustomParameters(e):this.mapCustomParametersToCustomData(e)].reduce(((e,t)=>Dr(this,void 0,void 0,(function*(){let r=yield e;return yield t(r)}))),Promise.resolve(t))}))}makeEvent(e,...t){return Dr(this,void 0,void 0,(function*(){let{newEventType:r=e}=this.eventTypeMapping[e]||{},n=yield this.resolveParameters(e,...t),i=yield this.resolvePayloadForParameters(e,n);return{eventType:r,payload:i,log:t=>Dr(this,void 0,void 0,(function*(){return this.bufferedRequests.push({eventType:r,payload:Object.assign(Object.assign({},i),t)}),yield Promise.all(this.afterSendHooks.map((r=>r(e,Object.assign(Object.assign({},n),t))))),yield this.deferExecution(),yield this.sendFromBuffer()}))}}))}sendEvent(e,...t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeEvent(e,...t)).log({})}))}deferExecution(){return new Promise((e=>setTimeout(e,0)))}sendFromBuffer(){return Dr(this,void 0,void 0,(function*(){let e=this.bufferedRequests.shift();if(e){let{eventType:t,payload:r}=e;return this.runtime.getClientDependingOnEventType(t).sendEvent(t,r)}}))}clear(){this.storage.removeItem("visitorId"),(new Vr).clear()}deleteHttpOnlyVisitorId(){this.runtime.client.deleteHttpCookieVisitorId()}makeSearchEvent(e){return Dr(this,void 0,void 0,(function*(){return this.makeEvent(ur.search,e)}))}sendSearchEvent(e){var{searchQueryUid:t}=e,r=Ar(e,["searchQueryUid"]);return Dr(this,void 0,void 0,(function*(){return(yield this.makeSearchEvent(r)).log({searchQueryUid:t})}))}makeClickEvent(e){return Dr(this,void 0,void 0,(function*(){return this.makeEvent(ur.click,e)}))}sendClickEvent(e){var{searchQueryUid:t}=e,r=Ar(e,["searchQueryUid"]);return Dr(this,void 0,void 0,(function*(){return(yield this.makeClickEvent(r)).log({searchQueryUid:t})}))}makeCustomEvent(e){return Dr(this,void 0,void 0,(function*(){return this.makeEvent(ur.custom,e)}))}sendCustomEvent(e){var{lastSearchQueryUid:t}=e,r=Ar(e,["lastSearchQueryUid"]);return Dr(this,void 0,void 0,(function*(){return(yield this.makeCustomEvent(r)).log({lastSearchQueryUid:t})}))}makeViewEvent(e){return Dr(this,void 0,void 0,(function*(){return this.makeEvent(ur.view,e)}))}sendViewEvent(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeViewEvent(e)).log({})}))}getVisit(){return Dr(this,void 0,void 0,(function*(){let e=yield(yield fetch(`${this.baseUrl}/analytics/visit`)).json();return this.visitorId=e.visitorId,e}))}getHealth(){return Dr(this,void 0,void 0,(function*(){return yield(yield fetch(`${this.baseUrl}/analytics/monitoring/health`)).json()}))}registerBeforeSendEventHook(e){this.beforeSendHooks.push(e)}registerAfterSendEventHook(e){this.afterSendHooks.push(e)}addEventTypeMapping(e,t){this.eventTypeMapping[e]=t}setAcceptedLinkReferrers(e){if(!Array.isArray(e)||!e.every((e=>"string"==typeof e)))throw Error("Parameter should be an array of domain strings");this.acceptedLinkReferrers=e}parseVariableArgumentsPayload(e,t){let r={};for(let n=0,i=t.length;n<i;n++){let i=t[n];if("string"==typeof i)r[e[n]]=i;else if("object"==typeof i)return Object.assign(Object.assign({},r),i)}return r}isKeyAllowedEmpty(e,t){return-1!==({[ur.search]:["queryText"]}[e]||[]).indexOf(t)}removeEmptyPayloadValues(e,t){return Object.keys(e).filter((r=>this.isKeyAllowedEmpty(t,r)||(e=>null!=e&&""!==e)(e[r]))).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}removeUnknownParameters(e){return Object.keys(e).filter((e=>{if((e=>[...Vn,...vn,Gn,Yn].some((t=>t(e))))(e))return!0;console.log(e,"is not processed by coveoua")})).reduce(((t,r)=>Object.assign(Object.assign({},t),{[r]:e[r]})),{})}processCustomParameters(e){let{custom:t}=e,r=Ar(e,["custom"]),n={};t&&hn(t)&&(n=this.lowercaseKeys(t));let i=(e=>dn(e).reduce(((t,r)=>{let n=(e=>{let t;return[...zn].every((r=>{var n;return t=null===(n=r.exec(e))||void 0===n?void 0:n[1],!Boolean(t)})),t})(r);return n?Object.assign(Object.assign({},t),((e,t)=>dn(t).reduce(((r,n)=>Object.assign(Object.assign({},r),{[`${e}${n}`]:t[n]})),{}))(n,e[r])):Object.assign(Object.assign({},t),{[r]:e[r]})}),{}))(r);return Object.assign(Object.assign({},n),i)}mapCustomParametersToCustomData(e){let{custom:t}=e,r=Ar(e,["custom"]);if(t&&hn(t)){let n=this.lowercaseKeys(t);return Object.assign(Object.assign({},r),{customData:Object.assign(Object.assign({},n),e.customData)})}return e}lowercaseKeys(e){let t=Object.keys(e),r={};return t.forEach((t=>{r[t.toLowerCase()]=e[t]})),r}validateParams(e,t){let{anonymizeIp:r}=e,n=Ar(e,["anonymizeIp"]);return void 0!==r&&-1==["0","false","undefined","null","{}","[]",""].indexOf(`${r}`.toLowerCase())&&(n.anonymizeIp=1),(t==ur.view||t==ur.click||t==ur.search||t==ur.custom)&&(n.originLevel3=this.limit(n.originLevel3,128)),t==ur.view&&(n.location=this.limit(n.location,128)),("pageview"==t||"event"==t)&&(n.referrer=this.limit(n.referrer,2048),n.location=this.limit(n.location,2048),n.page=this.limit(n.page,2048)),n}ensureAnonymousUserWhenUsingApiKey(e){let{userId:t}=e,r=Ar(e,["userId"]);return(e=>(null==e?void 0:e.startsWith("xx"))||!1)(this.options.token)&&!t?(r.userId="anonymous",r):e}setTrackingIdIfTrackingIdNotPresent(e){let{trackingId:t}=e,r=Ar(e,["trackingId"]);return t?e:(r.hasOwnProperty("custom")&&hn(r.custom)&&(r.custom.hasOwnProperty("context_website")||r.custom.hasOwnProperty("siteName"))&&(r.trackingId=r.custom.context_website||r.custom.siteName),r.hasOwnProperty("customData")&&hn(r.customData)&&(r.customData.hasOwnProperty("context_website")||r.customData.hasOwnProperty("siteName"))&&(r.trackingId=r.customData.context_website||r.customData.siteName),r)}limit(e,t){return"string"!=typeof e?e:e.substring(0,t)}get baseUrl(){return function(e=ai,t="v15",r=!1){if(e=e.replace(/\/$/,""),r)return`${e}/${t}`;let n=e.endsWith("/rest")||e.endsWith("/rest/ua");return`${e}${n?"":"/rest"}/${t}`}(this.options.endpoint,this.options.version,this.options.isCustomEndpoint)}};!function(e){e.contextChanged="contextChanged",e.expandToFullUI="expandToFullUI",e.openUserActions="openUserActions",e.showPrecedingSessions="showPrecedingSessions",e.showFollowingSessions="showFollowingSessions",e.clickViewedDocument="clickViewedDocument",e.clickPageView="clickPageView"}(ii||(ii={})),function(e){e.interfaceLoad="interfaceLoad",e.interfaceChange="interfaceChange",e.didyoumeanAutomatic="didyoumeanAutomatic",e.didyoumeanClick="didyoumeanClick",e.resultsSort="resultsSort",e.searchboxSubmit="searchboxSubmit",e.searchboxClear="searchboxClear",e.searchboxAsYouType="searchboxAsYouType",e.breadcrumbFacet="breadcrumbFacet",e.breadcrumbResetAll="breadcrumbResetAll",e.documentQuickview="documentQuickview",e.documentOpen="documentOpen",e.omniboxAnalytics="omniboxAnalytics",e.omniboxFromLink="omniboxFromLink",e.searchFromLink="searchFromLink",e.triggerNotify="notify",e.triggerExecute="execute",e.triggerQuery="query",e.undoTriggerQuery="undoQuery",e.triggerRedirect="redirect",e.pagerResize="pagerResize",e.pagerNumber="pagerNumber",e.pagerNext="pagerNext",e.pagerPrevious="pagerPrevious",e.pagerScrolling="pagerScrolling",e.staticFilterClearAll="staticFilterClearAll",e.staticFilterSelect="staticFilterSelect",e.staticFilterDeselect="staticFilterDeselect",e.facetClearAll="facetClearAll",e.facetSearch="facetSearch",e.facetSelect="facetSelect",e.facetSelectAll="facetSelectAll",e.facetDeselect="facetDeselect",e.facetExclude="facetExclude",e.facetUnexclude="facetUnexclude",e.facetUpdateSort="facetUpdateSort",e.facetShowMore="showMoreFacetResults",e.facetShowLess="showLessFacetResults",e.queryError="query",e.queryErrorBack="errorBack",e.queryErrorClear="errorClearQuery",e.queryErrorRetry="errorRetry",e.recommendation="recommendation",e.recommendationInterfaceLoad="recommendationInterfaceLoad",e.recommendationOpen="recommendationOpen",e.likeSmartSnippet="likeSmartSnippet",e.dislikeSmartSnippet="dislikeSmartSnippet",e.expandSmartSnippet="expandSmartSnippet",e.collapseSmartSnippet="collapseSmartSnippet",e.openSmartSnippetFeedbackModal="openSmartSnippetFeedbackModal",e.closeSmartSnippetFeedbackModal="closeSmartSnippetFeedbackModal",e.sendSmartSnippetReason="sendSmartSnippetReason",e.expandSmartSnippetSuggestion="expandSmartSnippetSuggestion",e.collapseSmartSnippetSuggestion="collapseSmartSnippetSuggestion",e.showMoreSmartSnippetSuggestion="showMoreSmartSnippetSuggestion",e.showLessSmartSnippetSuggestion="showLessSmartSnippetSuggestion",e.openSmartSnippetSource="openSmartSnippetSource",e.openSmartSnippetSuggestionSource="openSmartSnippetSuggestionSource",e.openSmartSnippetInlineLink="openSmartSnippetInlineLink",e.openSmartSnippetSuggestionInlineLink="openSmartSnippetSuggestionInlineLink",e.recentQueryClick="recentQueriesClick",e.clearRecentQueries="clearRecentQueries",e.recentResultClick="recentResultClick",e.clearRecentResults="clearRecentResults",e.noResultsBack="noResultsBack",e.showMoreFoldedResults="showMoreFoldedResults",e.showLessFoldedResults="showLessFoldedResults",e.copyToClipboard="copyToClipboard",e.caseSendEmail="Case.SendEmail",e.feedItemTextPost="FeedItem.TextPost",e.caseAttach="caseAttach",e.caseDetach="caseDetach",e.retryGeneratedAnswer="retryGeneratedAnswer",e.likeGeneratedAnswer="likeGeneratedAnswer",e.dislikeGeneratedAnswer="dislikeGeneratedAnswer",e.openGeneratedAnswerSource="openGeneratedAnswerSource",e.generatedAnswerStreamEnd="generatedAnswerStreamEnd",e.generatedAnswerSourceHover="generatedAnswerSourceHover",e.generatedAnswerCopyToClipboard="generatedAnswerCopyToClipboard",e.generatedAnswerHideAnswers="generatedAnswerHideAnswers",e.generatedAnswerShowAnswers="generatedAnswerShowAnswers",e.generatedAnswerFeedbackSubmit="generatedAnswerFeedbackSubmit",e.rephraseGeneratedAnswer="rephraseGeneratedAnswer"}(oi||(oi={}));var ci={[oi.triggerNotify]:"queryPipelineTriggers",[oi.triggerExecute]:"queryPipelineTriggers",[oi.triggerQuery]:"queryPipelineTriggers",[oi.triggerRedirect]:"queryPipelineTriggers",[oi.queryError]:"errors",[oi.queryErrorBack]:"errors",[oi.queryErrorClear]:"errors",[oi.queryErrorRetry]:"errors",[oi.pagerNext]:"getMoreResults",[oi.pagerPrevious]:"getMoreResults",[oi.pagerNumber]:"getMoreResults",[oi.pagerResize]:"getMoreResults",[oi.pagerScrolling]:"getMoreResults",[oi.facetSearch]:"facet",[oi.facetShowLess]:"facet",[oi.facetShowMore]:"facet",[oi.recommendation]:"recommendation",[oi.likeSmartSnippet]:"smartSnippet",[oi.dislikeSmartSnippet]:"smartSnippet",[oi.expandSmartSnippet]:"smartSnippet",[oi.collapseSmartSnippet]:"smartSnippet",[oi.openSmartSnippetFeedbackModal]:"smartSnippet",[oi.closeSmartSnippetFeedbackModal]:"smartSnippet",[oi.sendSmartSnippetReason]:"smartSnippet",[oi.expandSmartSnippetSuggestion]:"smartSnippetSuggestions",[oi.collapseSmartSnippetSuggestion]:"smartSnippetSuggestions",[oi.showMoreSmartSnippetSuggestion]:"smartSnippetSuggestions",[oi.showLessSmartSnippetSuggestion]:"smartSnippetSuggestions",[oi.clearRecentQueries]:"recentQueries",[oi.recentResultClick]:"recentlyClickedDocuments",[oi.clearRecentResults]:"recentlyClickedDocuments",[oi.showLessFoldedResults]:"folding",[ii.expandToFullUI]:"interface",[ii.openUserActions]:"User Actions",[ii.showPrecedingSessions]:"User Actions",[ii.showFollowingSessions]:"User Actions",[ii.clickViewedDocument]:"User Actions",[ii.clickPageView]:"User Actions",[oi.caseDetach]:"case",[oi.likeGeneratedAnswer]:"generatedAnswer",[oi.dislikeGeneratedAnswer]:"generatedAnswer",[oi.openGeneratedAnswerSource]:"generatedAnswer",[oi.generatedAnswerStreamEnd]:"generatedAnswer",[oi.generatedAnswerSourceHover]:"generatedAnswer",[oi.generatedAnswerCopyToClipboard]:"generatedAnswer",[oi.generatedAnswerHideAnswers]:"generatedAnswer",[oi.generatedAnswerShowAnswers]:"generatedAnswer",[oi.generatedAnswerFeedbackSubmit]:"generatedAnswer"},ui=class{constructor(){this.runtime=new ti,this.currentVisitorId=""}getPayload(){return Promise.resolve()}getParameters(){return Promise.resolve()}makeEvent(e){return Promise.resolve({eventType:e,payload:null,log:()=>Promise.resolve()})}sendEvent(){return Promise.resolve()}makeSearchEvent(){return this.makeEvent(ur.search)}sendSearchEvent(){return Promise.resolve()}makeClickEvent(){return this.makeEvent(ur.click)}sendClickEvent(){return Promise.resolve()}makeCustomEvent(){return this.makeEvent(ur.custom)}sendCustomEvent(){return Promise.resolve()}makeViewEvent(){return this.makeEvent(ur.view)}sendViewEvent(){return Promise.resolve()}getVisit(){return Promise.resolve({id:"",visitorId:""})}getHealth(){return Promise.resolve({status:""})}registerBeforeSendEventHook(){}registerAfterSendEventHook(){}addEventTypeMapping(){}get version(){return on}};function li(e){let t=e.join(";");return t.length<=256?t:li(e.slice(1))}var di=e=>{let t=function(e){return e.map((e=>e.replace(/;/g,"")))}(e),r=function(e){let t="";return e.filter((e=>{let r=e!==t;return t=e,r}))}(t);return li(r)};function hi(e){let t="string"==typeof e.partialQueries?e.partialQueries:di(e.partialQueries),r="string"==typeof e.suggestions?e.suggestions:di(e.suggestions);return Object.assign(Object.assign({},e),{partialQueries:t,suggestions:r})}var pi,gi,fi,mi=class{constructor(e,t){this.opts=e,this.provider=t;let r=!1===e.enableAnalytics||ni();this.coveoAnalyticsClient=r?new ui:new si(e)}disable(){this.coveoAnalyticsClient instanceof si&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new ui}enable(){this.coveoAnalyticsClient=new si(this.opts)}makeInterfaceLoad(){return this.makeSearchEvent(oi.interfaceLoad)}logInterfaceLoad(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendationInterfaceLoad(){return this.makeSearchEvent(oi.recommendationInterfaceLoad)}logRecommendationInterfaceLoad(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeRecommendationInterfaceLoad()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendation(){return this.makeCustomEvent(oi.recommendation)}logRecommendation(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeRecommendation()).log({searchUID:this.provider.getSearchUID()})}))}makeRecommendationOpen(e,t){return this.makeClickEvent(oi.recommendationOpen,e,t)}logRecommendationOpen(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeRecommendationOpen(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterClearAll(e){return this.makeSearchEvent(oi.staticFilterClearAll,e)}logStaticFilterClearAll(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterClearAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterSelect(e){return this.makeSearchEvent(oi.staticFilterSelect,e)}logStaticFilterSelect(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterSelect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeStaticFilterDeselect(e){return this.makeSearchEvent(oi.staticFilterDeselect,e)}logStaticFilterDeselect(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeStaticFilterDeselect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFetchMoreResults(){return this.makeCustomEvent(oi.pagerScrolling,{type:"getMoreResults"})}logFetchMoreResults(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeFetchMoreResults()).log({searchUID:this.provider.getSearchUID()})}))}makeInterfaceChange(e){return this.makeSearchEvent(oi.interfaceChange,e)}logInterfaceChange(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeInterfaceChange(e)).log({searchUID:this.provider.getSearchUID()})}))}makeDidYouMeanAutomatic(){return this.makeSearchEvent(oi.didyoumeanAutomatic)}logDidYouMeanAutomatic(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeDidYouMeanAutomatic()).log({searchUID:this.provider.getSearchUID()})}))}makeDidYouMeanClick(){return this.makeSearchEvent(oi.didyoumeanClick)}logDidYouMeanClick(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeDidYouMeanClick()).log({searchUID:this.provider.getSearchUID()})}))}makeResultsSort(e){return this.makeSearchEvent(oi.resultsSort,e)}logResultsSort(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeResultsSort(e)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxSubmit(){return this.makeSearchEvent(oi.searchboxSubmit)}logSearchboxSubmit(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeSearchboxSubmit()).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxClear(){return this.makeSearchEvent(oi.searchboxClear)}logSearchboxClear(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeSearchboxClear()).log({searchUID:this.provider.getSearchUID()})}))}makeSearchboxAsYouType(){return this.makeSearchEvent(oi.searchboxAsYouType)}logSearchboxAsYouType(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeSearchboxAsYouType()).log({searchUID:this.provider.getSearchUID()})}))}makeBreadcrumbFacet(e){return this.makeSearchEvent(oi.breadcrumbFacet,e)}logBreadcrumbFacet(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeBreadcrumbFacet(e)).log({searchUID:this.provider.getSearchUID()})}))}makeBreadcrumbResetAll(){return this.makeSearchEvent(oi.breadcrumbResetAll)}logBreadcrumbResetAll(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeBreadcrumbResetAll()).log({searchUID:this.provider.getSearchUID()})}))}makeDocumentQuickview(e,t){return this.makeClickEvent(oi.documentQuickview,e,t)}logDocumentQuickview(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeDocumentQuickview(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeDocumentOpen(e,t){return this.makeClickEvent(oi.documentOpen,e,t)}logDocumentOpen(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeDocumentOpen(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOmniboxAnalytics(e){return this.makeSearchEvent(oi.omniboxAnalytics,hi(e))}logOmniboxAnalytics(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeOmniboxAnalytics(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOmniboxFromLink(e){return this.makeSearchEvent(oi.omniboxFromLink,hi(e))}logOmniboxFromLink(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeOmniboxFromLink(e)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchFromLink(){return this.makeSearchEvent(oi.searchFromLink)}logSearchFromLink(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeSearchFromLink()).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerNotify(e){return this.makeCustomEvent(oi.triggerNotify,e)}logTriggerNotify(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeTriggerNotify(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerExecute(e){return this.makeCustomEvent(oi.triggerExecute,e)}logTriggerExecute(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeTriggerExecute(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerQuery(){return this.makeCustomEvent(oi.triggerQuery,{query:this.provider.getSearchEventRequestPayload().queryText},"queryPipelineTriggers")}logTriggerQuery(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeTriggerQuery()).log({searchUID:this.provider.getSearchUID()})}))}makeUndoTriggerQuery(e){return this.makeSearchEvent(oi.undoTriggerQuery,e)}logUndoTriggerQuery(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeUndoTriggerQuery(e)).log({searchUID:this.provider.getSearchUID()})}))}makeTriggerRedirect(e){return this.makeCustomEvent(oi.triggerRedirect,Object.assign(Object.assign({},e),{query:this.provider.getSearchEventRequestPayload().queryText}))}logTriggerRedirect(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeTriggerRedirect(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerResize(e){return this.makeCustomEvent(oi.pagerResize,e)}logPagerResize(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makePagerResize(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerNumber(e){return this.makeCustomEvent(oi.pagerNumber,e)}logPagerNumber(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makePagerNumber(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerNext(e){return this.makeCustomEvent(oi.pagerNext,e)}logPagerNext(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makePagerNext(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerPrevious(e){return this.makeCustomEvent(oi.pagerPrevious,e)}logPagerPrevious(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makePagerPrevious(e)).log({searchUID:this.provider.getSearchUID()})}))}makePagerScrolling(){return this.makeCustomEvent(oi.pagerScrolling)}logPagerScrolling(){return Dr(this,void 0,void 0,(function*(){return(yield this.makePagerScrolling()).log({searchUID:this.provider.getSearchUID()})}))}makeFacetClearAll(e){return this.makeSearchEvent(oi.facetClearAll,e)}logFacetClearAll(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeFacetClearAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSearch(e){return this.makeSearchEvent(oi.facetSearch,e)}logFacetSearch(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeFacetSearch(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSelect(e){return this.makeSearchEvent(oi.facetSelect,e)}logFacetSelect(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeFacetSelect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetDeselect(e){return this.makeSearchEvent(oi.facetDeselect,e)}logFacetDeselect(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeFacetDeselect(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetExclude(e){return this.makeSearchEvent(oi.facetExclude,e)}logFacetExclude(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeFacetExclude(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetUnexclude(e){return this.makeSearchEvent(oi.facetUnexclude,e)}logFacetUnexclude(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeFacetUnexclude(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetSelectAll(e){return this.makeSearchEvent(oi.facetSelectAll,e)}logFacetSelectAll(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeFacetSelectAll(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetUpdateSort(e){return this.makeSearchEvent(oi.facetUpdateSort,e)}logFacetUpdateSort(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeFacetUpdateSort(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetShowMore(e){return this.makeCustomEvent(oi.facetShowMore,e)}logFacetShowMore(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeFacetShowMore(e)).log({searchUID:this.provider.getSearchUID()})}))}makeFacetShowLess(e){return this.makeCustomEvent(oi.facetShowLess,e)}logFacetShowLess(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeFacetShowLess(e)).log({searchUID:this.provider.getSearchUID()})}))}makeQueryError(e){return this.makeCustomEvent(oi.queryError,e)}logQueryError(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeQueryError(e)).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorBack(){return Dr(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(oi.queryErrorBack);return{description:e.description,log:()=>Dr(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(oi.queryErrorBack)}))}}))}logQueryErrorBack(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorBack()).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorRetry(){return Dr(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(oi.queryErrorRetry);return{description:e.description,log:()=>Dr(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(oi.queryErrorRetry)}))}}))}logQueryErrorRetry(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorRetry()).log({searchUID:this.provider.getSearchUID()})}))}makeQueryErrorClear(){return Dr(this,void 0,void 0,(function*(){let e=yield this.makeCustomEvent(oi.queryErrorClear);return{description:e.description,log:()=>Dr(this,void 0,void 0,(function*(){return yield e.log({searchUID:this.provider.getSearchUID()}),this.logSearchEvent(oi.queryErrorClear)}))}}))}logQueryErrorClear(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeQueryErrorClear()).log({searchUID:this.provider.getSearchUID()})}))}makeLikeSmartSnippet(){return this.makeCustomEvent(oi.likeSmartSnippet)}logLikeSmartSnippet(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeLikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeDislikeSmartSnippet(){return this.makeCustomEvent(oi.dislikeSmartSnippet)}logDislikeSmartSnippet(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeDislikeSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeExpandSmartSnippet(){return this.makeCustomEvent(oi.expandSmartSnippet)}logExpandSmartSnippet(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeExpandSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeCollapseSmartSnippet(){return this.makeCustomEvent(oi.collapseSmartSnippet)}logCollapseSmartSnippet(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeCollapseSmartSnippet()).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetFeedbackModal(){return this.makeCustomEvent(oi.openSmartSnippetFeedbackModal)}logOpenSmartSnippetFeedbackModal(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})}))}makeCloseSmartSnippetFeedbackModal(){return this.makeCustomEvent(oi.closeSmartSnippetFeedbackModal)}logCloseSmartSnippetFeedbackModal(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeCloseSmartSnippetFeedbackModal()).log({searchUID:this.provider.getSearchUID()})}))}makeSmartSnippetFeedbackReason(e,t){return this.makeCustomEvent(oi.sendSmartSnippetReason,{reason:e,details:t})}logSmartSnippetFeedbackReason(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeSmartSnippetFeedbackReason(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeExpandSmartSnippetSuggestion(e){return this.makeCustomEvent(oi.expandSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logExpandSmartSnippetSuggestion(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeExpandSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeCollapseSmartSnippetSuggestion(e){return this.makeCustomEvent(oi.collapseSmartSnippetSuggestion,"documentId"in e?e:{documentId:e})}logCollapseSmartSnippetSuggestion(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeCollapseSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeShowMoreSmartSnippetSuggestion(e){return this.makeCustomEvent(oi.showMoreSmartSnippetSuggestion,e)}logShowMoreSmartSnippetSuggestion(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeShowMoreSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeShowLessSmartSnippetSuggestion(e){return this.makeCustomEvent(oi.showLessSmartSnippetSuggestion,e)}logShowLessSmartSnippetSuggestion(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeShowLessSmartSnippetSuggestion(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSource(e,t){return this.makeClickEvent(oi.openSmartSnippetSource,e,t)}logOpenSmartSnippetSource(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSource(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSuggestionSource(e,t){return this.makeClickEvent(oi.openSmartSnippetSuggestionSource,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}makeCopyToClipboard(e,t){return this.makeClickEvent(oi.copyToClipboard,e,t)}logCopyToClipboard(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeCopyToClipboard(e,t)).log({searchUID:this.provider.getSearchUID()})}))}logOpenSmartSnippetSuggestionSource(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSuggestionSource(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetInlineLink(e,t){return this.makeClickEvent(oi.openSmartSnippetInlineLink,e,{contentIDKey:t.contentIDKey,contentIDValue:t.contentIDValue},t)}logOpenSmartSnippetInlineLink(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenSmartSnippetSuggestionInlineLink(e,t){return this.makeClickEvent(oi.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},t)}logOpenSmartSnippetSuggestionInlineLink(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeOpenSmartSnippetSuggestionInlineLink(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeRecentQueryClick(){return this.makeSearchEvent(oi.recentQueryClick)}logRecentQueryClick(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeRecentQueryClick()).log({searchUID:this.provider.getSearchUID()})}))}makeClearRecentQueries(){return this.makeCustomEvent(oi.clearRecentQueries)}logClearRecentQueries(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeClearRecentQueries()).log({searchUID:this.provider.getSearchUID()})}))}makeRecentResultClick(e,t){return this.makeCustomEvent(oi.recentResultClick,{info:e,identifier:t})}logRecentResultClick(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeRecentResultClick(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeClearRecentResults(){return this.makeCustomEvent(oi.clearRecentResults)}logClearRecentResults(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeClearRecentResults()).log({searchUID:this.provider.getSearchUID()})}))}makeNoResultsBack(){return this.makeSearchEvent(oi.noResultsBack)}logNoResultsBack(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeNoResultsBack()).log({searchUID:this.provider.getSearchUID()})}))}makeShowMoreFoldedResults(e,t){return this.makeClickEvent(oi.showMoreFoldedResults,e,t)}logShowMoreFoldedResults(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeShowMoreFoldedResults(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeShowLessFoldedResults(){return this.makeCustomEvent(oi.showLessFoldedResults)}logShowLessFoldedResults(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeShowLessFoldedResults()).log({searchUID:this.provider.getSearchUID()})}))}makeEventDescription(e,t){var r;return{actionCause:t,customData:null===(r=e.payload)||void 0===r?void 0:r.customData}}makeCustomEvent(e,t,r=ci[e]){return Dr(this,void 0,void 0,(function*(){this.coveoAnalyticsClient.getParameters;let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:r,eventValue:e}),o=yield this.coveoAnalyticsClient.makeCustomEvent(i);return{description:this.makeEventDescription(o,e),log:({searchUID:e})=>o.log({lastSearchQueryUid:e})}}))}logCustomEvent(e,t,r=ci[e]){return Dr(this,void 0,void 0,(function*(){return(yield this.makeCustomEvent(e,t,r)).log({searchUID:this.provider.getSearchUID()})}))}makeCustomEventWithType(e,t,r){return Dr(this,void 0,void 0,(function*(){let n=Object.assign(Object.assign({},this.provider.getBaseMetadata()),r),i=Object.assign(Object.assign({},yield this.getBaseEventRequest(n)),{eventType:t,eventValue:e}),o=yield this.coveoAnalyticsClient.makeCustomEvent(i);return{description:this.makeEventDescription(o,e),log:({searchUID:e})=>o.log({lastSearchQueryUid:e})}}))}logCustomEventWithType(e,t,r){return Dr(this,void 0,void 0,(function*(){return(yield this.makeCustomEventWithType(e,t,r)).log({searchUID:this.provider.getSearchUID()})}))}logSearchEvent(e,t){return Dr(this,void 0,void 0,(function*(){return(yield this.makeSearchEvent(e,t)).log({searchUID:this.provider.getSearchUID()})}))}makeSearchEvent(e,t){return Dr(this,void 0,void 0,(function*(){let r=yield this.getBaseSearchEventRequest(e,t),n=yield this.coveoAnalyticsClient.makeSearchEvent(r);return{description:this.makeEventDescription(n,e),log:({searchUID:e})=>n.log({searchQueryUid:e})}}))}makeClickEvent(e,t,r,n){return Dr(this,void 0,void 0,(function*(){let i=Object.assign(Object.assign(Object.assign({},t),yield this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{queryPipeline:this.provider.getPipeline(),actionCause:e}),o=yield this.coveoAnalyticsClient.makeClickEvent(i);return{description:this.makeEventDescription(o,e),log:({searchUID:e})=>o.log({searchQueryUid:e})}}))}logClickEvent(e,t,r,n){return Dr(this,void 0,void 0,(function*(){return(yield this.makeClickEvent(e,t,r,n)).log({searchUID:this.provider.getSearchUID()})}))}getBaseSearchEventRequest(e,t){var r,n;return Dr(this,void 0,void 0,(function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},t),null===(n=(r=this.provider).getGeneratedAnswerMetadata)||void 0===n?void 0:n.call(r)))),this.provider.getSearchEventRequestPayload()),{queryPipeline:this.provider.getPipeline(),actionCause:e})}))}getBaseEventRequest(e){return Dr(this,void 0,void 0,(function*(){let t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign(Object.assign({},this.getOrigins()),this.getSplitTestRun()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})}))}getOrigins(){var e,t;return{originContext:null===(t=(e=this.provider).getOriginContext)||void 0===t?void 0:t.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof si?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}getSplitTestRun(){let e=this.provider.getSplitTestRunName?this.provider.getSplitTestRunName():"",t=this.provider.getSplitTestRunVersion?this.provider.getSplitTestRunVersion():"";return Object.assign(Object.assign({},e&&{splitTestRunName:e}),t&&{splitTestRunVersion:t})}makeLikeGeneratedAnswer(e){return this.makeCustomEvent(oi.likeGeneratedAnswer,e)}logLikeGeneratedAnswer(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeLikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeDislikeGeneratedAnswer(e){return this.makeCustomEvent(oi.dislikeGeneratedAnswer,e)}logDislikeGeneratedAnswer(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeDislikeGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeOpenGeneratedAnswerSource(e){return this.makeCustomEvent(oi.openGeneratedAnswerSource,e)}logOpenGeneratedAnswerSource(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeOpenGeneratedAnswerSource(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerSourceHover(e){return this.makeCustomEvent(oi.generatedAnswerSourceHover,e)}logGeneratedAnswerSourceHover(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerSourceHover(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerCopyToClipboard(e){return this.makeCustomEvent(oi.generatedAnswerCopyToClipboard,e)}logGeneratedAnswerCopyToClipboard(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerCopyToClipboard(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerHideAnswers(e){return this.makeCustomEvent(oi.generatedAnswerHideAnswers,e)}logGeneratedAnswerHideAnswers(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerHideAnswers(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerShowAnswers(e){return this.makeCustomEvent(oi.generatedAnswerShowAnswers,e)}logGeneratedAnswerShowAnswers(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerShowAnswers(e)).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerFeedbackSubmit(e){return this.makeCustomEvent(oi.generatedAnswerFeedbackSubmit,e)}logGeneratedAnswerFeedbackSubmit(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerFeedbackSubmit(e)).log({searchUID:this.provider.getSearchUID()})}))}makeRephraseGeneratedAnswer(e){return this.makeSearchEvent(oi.rephraseGeneratedAnswer,e)}logRephraseGeneratedAnswer(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeRephraseGeneratedAnswer(e)).log({searchUID:this.provider.getSearchUID()})}))}makeRetryGeneratedAnswer(){return this.makeSearchEvent(oi.retryGeneratedAnswer)}logRetryGeneratedAnswer(){return Dr(this,void 0,void 0,(function*(){return(yield this.makeRetryGeneratedAnswer()).log({searchUID:this.provider.getSearchUID()})}))}makeGeneratedAnswerStreamEnd(e){return this.makeCustomEvent(oi.generatedAnswerStreamEnd,e)}logGeneratedAnswerStreamEnd(e){return Dr(this,void 0,void 0,(function*(){return(yield this.makeGeneratedAnswerStreamEnd(e)).log({searchUID:this.provider.getSearchUID()})}))}},vi=Object.assign({},sn),yi=Object.keys(vi).map((e=>vi[e])),bi=class extends un{constructor({client:e,uuidGenerator:t=Xr}){super({client:e,uuidGenerator:t}),this.ticket={}}getApi(e){let t=super.getApi(e);return null!==t?t:"setTicket"===e?this.setTicket:null}addHooks(){this.addHooksForEvent(),this.addHooksForPageView(),this.addHooksForSVCEvents()}setTicket(e){this.ticket=e}clearPluginData(){this.ticket={}}addHooksForSVCEvents(){this.client.registerBeforeSendEventHook(((e,...[t])=>-1!==yi.indexOf(e)?this.addSVCDataToPayload(e,t):t)),this.client.registerAfterSendEventHook(((e,...[t])=>(-1!==yi.indexOf(e)&&this.updateLocationInformation(e,t),t)))}addHooksForPageView(){this.client.addEventTypeMapping(vi.pageview,{newEventType:ur.collect,variableLengthArgumentsNames:["page"],addVisitorIdParameter:!0,usesMeasurementProtocol:!0})}addHooksForEvent(){this.client.addEventTypeMapping(vi.event,{newEventType:ur.collect,variableLengthArgumentsNames:["eventCategory","eventAction","eventLabel","eventValue"],addVisitorIdParameter:!0,usesMeasurementProtocol:!0})}addSVCDataToPayload(e,t){var r;let n=Object.assign(Object.assign(Object.assign(Object.assign({},this.getLocationInformation(e,t)),this.getDefaultContextInformation(e)),this.action?{svcAction:this.action}:{}),Object.keys(null!==(r=this.actionData)&&void 0!==r?r:{}).length>0?{svcActionData:this.actionData}:{}),i=this.getTicketPayload();return this.clearData(),Object.assign(Object.assign(Object.assign({},i),n),t)}getTicketPayload(){return(e=>dn(e).filter((t=>void 0!==e[t])).reduce(((t,r)=>{let n=pn[r]||r;return Object.assign(Object.assign({},t),{[n]:e[r]})}),{}))(this.ticket)}};bi.Id="svc",function(e){e.click="click",e.flowStart="flowStart"}(pi||(pi={})),function(e){e.enterInterface="ticket_create_start",e.fieldUpdate="ticket_field_update",e.fieldSuggestionClick="ticket_classification_click",e.suggestionClick="suggestion_click",e.suggestionRate="suggestion_rate",e.nextCaseStep="ticket_next_stage",e.caseCancelled="ticket_cancel",e.caseSolved="ticket_cancel",e.caseCreated="ticket_create"}(gi||(gi={})),function(e){e.quit="Quit",e.solved="Solved"}(fi||(fi={}));var Si=class{constructor(e,t){var r;this.options=e,this.provider=t;let n=(null===(r=e.enableAnalytics)||void 0===r||r)&&!ni();this.coveoAnalyticsClient=n?new si(e):new ui,this.svc=new bi({client:this.coveoAnalyticsClient})}disable(){this.coveoAnalyticsClient instanceof si&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new ui,this.svc=new bi({client:this.coveoAnalyticsClient})}enable(){this.coveoAnalyticsClient=new si(this.options),this.svc=new bi({client:this.coveoAnalyticsClient})}logEnterInterface(e){return this.svc.setAction(gi.enterInterface),this.svc.setTicket(e.ticket),this.sendFlowStartEvent()}logUpdateCaseField(e){return this.svc.setAction(gi.fieldUpdate,{fieldName:e.fieldName}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logSelectFieldSuggestion(e){return this.svc.setAction(gi.fieldSuggestionClick,e.suggestion),this.svc.setTicket(e.ticket),this.sendClickEvent()}logSelectDocumentSuggestion(e){return this.svc.setAction(gi.suggestionClick,e.suggestion),this.svc.setTicket(e.ticket),this.sendClickEvent()}logRateDocumentSuggestion(e){return this.svc.setAction(gi.suggestionRate,Object.assign({rate:e.rating},e.suggestion)),this.svc.setTicket(e.ticket),this.sendClickEvent()}logMoveToNextCaseStep(e){return this.svc.setAction(gi.nextCaseStep,{stage:null==e?void 0:e.stage}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logCaseCancelled(e){return this.svc.setAction(gi.caseCancelled,{reason:fi.quit}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logCaseSolved(e){return this.svc.setAction(gi.caseSolved,{reason:fi.solved}),this.svc.setTicket(e.ticket),this.sendClickEvent()}logCaseCreated(e){return this.svc.setAction(gi.caseCreated),this.svc.setTicket(e.ticket),this.sendClickEvent()}sendFlowStartEvent(){return this.coveoAnalyticsClient.sendEvent("event","svc",pi.flowStart,this.provider?{searchHub:this.provider.getOriginLevel1()}:null)}sendClickEvent(){return this.coveoAnalyticsClient.sendEvent("event","svc",pi.click,this.provider?{searchHub:this.provider.getOriginLevel1()}:null)}},wi=(e,t=!0)=>{let{caseContext:r,caseId:n,caseNumber:i}=e,o=Ar(e,["caseContext","caseId","caseNumber"]),a=(e=>{let t={};return e.caseContext&&Object.keys(e.caseContext).forEach((r=>{var n;let i=null===(n=e.caseContext)||void 0===n?void 0:n[r];i&&(t[`context_${r}`]=i)})),t})(e);return Object.assign(Object.assign(Object.assign({CaseId:n,CaseNumber:i},o),!!a.context_Case_Subject&&{CaseSubject:a.context_Case_Subject}),t&&a)},ki=class{constructor(e,t){this.opts=e,this.provider=t;let r=!1===e.enableAnalytics||ni();this.coveoAnalyticsClient=r?new ui:new si(e)}disable(){this.coveoAnalyticsClient instanceof si&&this.coveoAnalyticsClient.clear(),this.coveoAnalyticsClient=new ui}enable(){this.coveoAnalyticsClient=new si(this.opts)}logInterfaceLoad(e){if(e){let t=wi(e);return this.logSearchEvent(oi.interfaceLoad,t)}return this.logSearchEvent(oi.interfaceLoad)}logInterfaceChange(e){let t=wi(e);return this.logSearchEvent(oi.interfaceChange,t)}logStaticFilterDeselect(e){let t=wi(e);return this.logSearchEvent(oi.staticFilterDeselect,t)}logFetchMoreResults(e){if(e){let t=wi(e);return this.logCustomEvent(oi.pagerScrolling,Object.assign(Object.assign({},t),{type:"getMoreResults"}))}return this.logCustomEvent(oi.pagerScrolling,{type:"getMoreResults"})}logBreadcrumbFacet(e){let t=wi(e);return this.logSearchEvent(oi.breadcrumbFacet,t)}logBreadcrumbResetAll(e){if(e){let t=wi(e);return this.logSearchEvent(oi.breadcrumbResetAll,t)}return this.logSearchEvent(oi.breadcrumbResetAll)}logFacetSelect(e){let t=wi(e);return this.logSearchEvent(oi.facetSelect,t)}logFacetExclude(e){let t=wi(e);return this.logSearchEvent(oi.facetExclude,t)}logFacetDeselect(e){let t=wi(e);return this.logSearchEvent(oi.facetDeselect,t)}logFacetUpdateSort(e){let t=wi(e);return this.logSearchEvent(oi.facetUpdateSort,t)}logFacetClearAll(e){let t=wi(e);return this.logSearchEvent(oi.facetClearAll,t)}logFacetShowMore(e){let t=wi(e,!1);return this.logCustomEvent(oi.facetShowMore,t)}logFacetShowLess(e){let t=wi(e,!1);return this.logCustomEvent(oi.facetShowLess,t)}logQueryError(e){let t=wi(e,!1);return this.logCustomEvent(oi.queryError,t)}logPagerNumber(e){let t=wi(e,!1);return this.logCustomEvent(oi.pagerNumber,t)}logPagerNext(e){let t=wi(e,!1);return this.logCustomEvent(oi.pagerNext,t)}logPagerPrevious(e){let t=wi(e,!1);return this.logCustomEvent(oi.pagerPrevious,t)}logDidYouMeanAutomatic(e){if(e){let t=wi(e);return this.logSearchEvent(oi.didyoumeanAutomatic,t)}return this.logSearchEvent(oi.didyoumeanAutomatic)}logDidYouMeanClick(e){if(e){let t=wi(e);return this.logSearchEvent(oi.didyoumeanClick,t)}return this.logSearchEvent(oi.didyoumeanClick)}logResultsSort(e){let t=wi(e);return this.logSearchEvent(oi.resultsSort,t)}logSearchboxSubmit(e){if(e){let t=wi(e);return this.logSearchEvent(oi.searchboxSubmit,t)}return this.logSearchEvent(oi.searchboxSubmit)}logContextChanged(e){let t=wi(e);return this.logSearchEvent(ii.contextChanged,t)}logExpandToFullUI(e){let t=wi(e);return this.logCustomEvent(ii.expandToFullUI,t)}logOpenUserActions(e){let t=wi(e,!1);return this.logCustomEvent(ii.openUserActions,t)}logShowPrecedingSessions(e){let t=wi(e,!1);return this.logCustomEvent(ii.showPrecedingSessions,t)}logShowFollowingSessions(e){let t=wi(e,!1);return this.logCustomEvent(ii.showFollowingSessions,t)}logViewedDocumentClick(e,t){return this.logCustomEvent(ii.clickViewedDocument,Object.assign(Object.assign({},wi(t,!1)),{document:e}))}logPageViewClick(e,t){return this.logCustomEvent(ii.clickPageView,Object.assign(Object.assign({},wi(t,!1)),{pageView:e}))}logDocumentOpen(e,t,r){return this.logClickEvent(oi.documentOpen,e,t,r?wi(r,!1):void 0)}logCopyToClipboard(e,t,r){return this.logClickEvent(oi.copyToClipboard,e,t,r?wi(r,!1):void 0)}logCaseSendEmail(e,t,r){return this.logClickEvent(oi.caseSendEmail,e,t,r?wi(r,!1):void 0)}logFeedItemTextPost(e,t,r){return this.logClickEvent(oi.feedItemTextPost,e,t,r?wi(r,!1):void 0)}logDocumentQuickview(e,t,r){let n={documentTitle:e.documentTitle,documentURL:e.documentUrl};return this.logClickEvent(oi.documentQuickview,e,t,r?Object.assign(Object.assign({},wi(r,!1)),n):n)}logCaseAttach(e,t,r){let n={documentTitle:e.documentTitle,documentURL:e.documentUrl,resultUriHash:e.documentUriHash};return this.logClickEvent(oi.caseAttach,e,t,r?Object.assign(Object.assign({},wi(r,!1)),n):n)}logCaseDetach(e,t){return this.logCustomEvent(oi.caseDetach,t?Object.assign(Object.assign({},wi(t,!1)),{resultUriHash:e}):{resultUriHash:e})}logLikeSmartSnippet(e){return this.logCustomEvent(oi.likeSmartSnippet,e?wi(e,!1):void 0)}logDislikeSmartSnippet(e){return this.logCustomEvent(oi.dislikeSmartSnippet,e?wi(e,!1):void 0)}logExpandSmartSnippet(e){return this.logCustomEvent(oi.expandSmartSnippet,e?wi(e,!1):void 0)}logCollapseSmartSnippet(e){return this.logCustomEvent(oi.collapseSmartSnippet,e?wi(e,!1):void 0)}logOpenSmartSnippetFeedbackModal(e){return this.logCustomEvent(oi.openSmartSnippetFeedbackModal,e?wi(e,!1):void 0)}logCloseSmartSnippetFeedbackModal(e){return this.logCustomEvent(oi.closeSmartSnippetFeedbackModal,e?wi(e,!1):void 0)}logSmartSnippetFeedbackReason(e,t,r){return this.logCustomEvent(oi.sendSmartSnippetReason,r?Object.assign(Object.assign({},wi(r,!1)),{reason:e,details:t}):{reason:e,details:t})}logExpandSmartSnippetSuggestion(e,t){let r="documentId"in e?e:{documentId:e};return this.logCustomEvent(oi.expandSmartSnippetSuggestion,t?Object.assign(Object.assign({},wi(t,!1)),r):r)}logCollapseSmartSnippetSuggestion(e,t){let r="documentId"in e?e:{documentId:e};return this.logCustomEvent(oi.collapseSmartSnippetSuggestion,t?Object.assign(Object.assign({},wi(t,!1)),r):r)}logOpenSmartSnippetSource(e,t,r){return this.logClickEvent(oi.openSmartSnippetSource,e,t,r?wi(r,!1):void 0)}logOpenSmartSnippetSuggestionSource(e,t,r){return this.logClickEvent(oi.openSmartSnippetSuggestionSource,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},r?Object.assign(Object.assign({},wi(r,!1)),t):t)}logOpenSmartSnippetInlineLink(e,t,r){return this.logClickEvent(oi.openSmartSnippetInlineLink,e,{contentIDKey:t.contentIDKey,contentIDValue:t.contentIDValue},r?Object.assign(Object.assign({},wi(r,!1)),t):t)}logOpenSmartSnippetSuggestionInlineLink(e,t,r){return this.logClickEvent(oi.openSmartSnippetSuggestionInlineLink,e,{contentIDKey:t.documentId.contentIdKey,contentIDValue:t.documentId.contentIdValue},r?Object.assign(Object.assign({},wi(r,!1)),t):t)}logLikeGeneratedAnswer(e,t){return this.logCustomEvent(oi.likeGeneratedAnswer,t?Object.assign(Object.assign({},wi(t,!1)),e):e)}logDislikeGeneratedAnswer(e,t){return this.logCustomEvent(oi.dislikeGeneratedAnswer,t?Object.assign(Object.assign({},wi(t,!1)),e):e)}logOpenGeneratedAnswerSource(e,t){return this.logCustomEvent(oi.openGeneratedAnswerSource,t?Object.assign(Object.assign({},wi(t,!1)),e):e)}logGeneratedAnswerSourceHover(e,t){return this.logCustomEvent(oi.generatedAnswerSourceHover,t?Object.assign(Object.assign({},wi(t,!1)),e):e)}logGeneratedAnswerCopyToClipboard(e,t){return this.logCustomEvent(oi.generatedAnswerCopyToClipboard,t?Object.assign(Object.assign({},wi(t,!1)),e):e)}logGeneratedAnswerHideAnswers(e,t){return this.logCustomEvent(oi.generatedAnswerHideAnswers,t?Object.assign(Object.assign({},wi(t,!1)),e):e)}logGeneratedAnswerShowAnswers(e,t){return this.logCustomEvent(oi.generatedAnswerShowAnswers,t?Object.assign(Object.assign({},wi(t,!1)),e):e)}logGeneratedAnswerFeedbackSubmit(e,t){return this.logCustomEvent(oi.generatedAnswerFeedbackSubmit,t?Object.assign(Object.assign({},wi(t,!1)),e):e)}logRephraseGeneratedAnswer(e,t){return this.logSearchEvent(oi.rephraseGeneratedAnswer,t?Object.assign(Object.assign({},wi(t,!1)),e):e)}logRetryGeneratedAnswer(e){return this.logSearchEvent(oi.retryGeneratedAnswer,e?Object.assign({},wi(e,!1)):{})}logGeneratedAnswerStreamEnd(e,t){return this.logCustomEvent(oi.generatedAnswerStreamEnd,t?Object.assign(Object.assign({},wi(t,!1)),e):e)}logCustomEvent(e,t){return Dr(this,void 0,void 0,(function*(){let r=Object.assign(Object.assign({},this.provider.getBaseMetadata()),t),n=Object.assign(Object.assign({},yield this.getBaseCustomEventRequest(r)),{eventType:ci[e],eventValue:e});return this.coveoAnalyticsClient.sendCustomEvent(n)}))}logSearchEvent(e,t){return Dr(this,void 0,void 0,(function*(){return this.coveoAnalyticsClient.sendSearchEvent(yield this.getBaseSearchEventRequest(e,t))}))}logClickEvent(e,t,r,n){return Dr(this,void 0,void 0,(function*(){let i=Object.assign(Object.assign(Object.assign({},t),yield this.getBaseEventRequest(Object.assign(Object.assign({},r),n))),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e});return this.coveoAnalyticsClient.sendClickEvent(i)}))}logShowMoreFoldedResults(e,t,r){return Dr(this,void 0,void 0,(function*(){return this.logClickEvent(oi.showMoreFoldedResults,e,t,r?wi(r,!1):void 0)}))}logShowLessFoldedResults(e){return Dr(this,void 0,void 0,(function*(){return this.logCustomEvent(oi.showLessFoldedResults,e?wi(e,!1):void 0)}))}getBaseCustomEventRequest(e){return Dr(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},yield this.getBaseEventRequest(e)),{lastSearchQueryUid:this.provider.getSearchUID()})}))}getBaseSearchEventRequest(e,t){var r,n;return Dr(this,void 0,void 0,(function*(){return Object.assign(Object.assign(Object.assign({},yield this.getBaseEventRequest(Object.assign(Object.assign({},t),null===(n=(r=this.provider).getGeneratedAnswerMetadata)||void 0===n?void 0:n.call(r)))),this.provider.getSearchEventRequestPayload()),{searchQueryUid:this.provider.getSearchUID(),queryPipeline:this.provider.getPipeline(),actionCause:e})}))}getBaseEventRequest(e){return Dr(this,void 0,void 0,(function*(){let t=Object.assign(Object.assign({},this.provider.getBaseMetadata()),e);return Object.assign(Object.assign({},this.getOrigins()),{customData:t,language:this.provider.getLanguage(),facetState:this.provider.getFacetState?this.provider.getFacetState():[],anonymous:this.provider.getIsAnonymous(),clientId:yield this.getClientId()})}))}getOrigins(){var e,t;return{originContext:null===(t=(e=this.provider).getOriginContext)||void 0===t?void 0:t.call(e),originLevel1:this.provider.getOriginLevel1(),originLevel2:this.provider.getOriginLevel2(),originLevel3:this.provider.getOriginLevel3()}}getClientId(){return this.coveoAnalyticsClient instanceof si?this.coveoAnalyticsClient.getCurrentVisitorId():void 0}},Oi=e=>new si(e).getCurrentVisitorId(),Ci=e=>{let t=new si(e);t.clear(),t.deleteHttpOnlyVisitorId()},Ii=new zr.HistoryStore,Ei=(e,t)=>"function"==typeof t?(...r)=>{let n=oe(r[0]);try{return t.apply(t,r)}catch(t){return e.error(t,"Error in analytics preprocessRequest. Returning original request."),n}}:void 0,Ai=(e,t)=>(...r)=>{let n=oe(r[1]);try{return t.apply(t,r)}catch(t){return e.error(t,"Error in analytics hook. Returning original request."),n}},Di=["uri","urihash","documentUri","documentUriHash","permanentid","ec_name","ec_brand","ec_category","ec_item_group_id","ec_price","ec_promo_price","ec_shortdesc","ec_thumbnails","ec_images","ec_in_stock","ec_rating","childResults","totalNumberOfChildResults"],Ri="2.38.3",Ui=class{constructor(e){this.getState=e,this.state=e()}getLanguage(){return(e=>{let t=this.state.configuration.search.locale.split("-")[0];return t&&2===t.length?t:"en"})()}getBaseMetadata(){let{context:e}=this.state,t=(null==e?void 0:e.contextValues)||{},r={};for(let[e,n]of Object.entries(t))r[`context_${e}`]=n;return r.coveoHeadlessVersion=Ri,r}getOriginContext(){return this.state.configuration.analytics.originContext}getOriginLevel1(){return this.state.searchHub||"default"}getOriginLevel2(){return this.state.configuration.analytics.originLevel2}getOriginLevel3(){return this.state.configuration.analytics.originLevel3}getIsAnonymous(){return this.state.configuration.analytics.anonymous}},xi=class extends Ui{constructor(){super(...arguments),this.initialState={id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},additionalFields:[],recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0}}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var e;return(null==(e=this.getState().productRecommendations)?void 0:e.searchUid)||this.initialState.searchUid}mapResultsToAnalyticsDocument(){var e;return null==(e=this.state.productRecommendations)?void 0:e.recommendations.map((e=>({documentUri:e.documentUri,documentUriHash:e.documentUriHash,permanentid:e.permanentid})))}get responseTime(){var e;return(null==(e=this.state.productRecommendations)?void 0:e.duration)||this.initialState.duration}get numberOfResults(){var e;return(null==(e=this.state.productRecommendations)?void 0:e.recommendations.length)||this.initialState.recommendations.length}},ji=class{constructor(e){this.state=e()}getSearchUID(){return null}getOriginLevel1(){return this.state.searchHub||"default"}},Pi=class extends Ui{constructor(){super(...arguments),this.initialState={url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""}}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var e;return(null==(e=this.getState().productListing)?void 0:e.responseId)||this.initialState.responseId}mapResultsToAnalyticsDocument(){var e;return null==(e=this.state.productListing)?void 0:e.products.map((e=>({documentUri:e.documentUri,documentUriHash:e.documentUriHash,permanentid:e.permanentid})))}get numberOfResults(){return this.state.productListing.products.length}};var Ti=(e,t)=>{var r;let n=((e,t)=>{var r;return null==(r=e.categoryFacetSet[t])?void 0:r.request})(e,t);return function(e){let{activeValue:t,ancestryMap:r}=function(e){let t=[...e],r=new Map;for(;t.length>0;){let e=t.shift();if("selected"===e.state)return{activeValue:e,ancestryMap:r};if(r)for(let t of e.children)r.set(t,e);t.unshift(...e.children)}return{}}(e);return t?function(e,t){let r=[];if(!e)return[];let n=e;do{r.unshift(n),n=t.get(n)}while(n);return r}(t,r):[]}(null!=(r=null==n?void 0:n.currentValues)?r:[])};function Fi(e){var t,r,n,i,o;return{facetSet:null!=(t=e.facetSet)?t:{},categoryFacetSet:null!=(r=e.categoryFacetSet)?r:{},dateFacetSet:null!=(n=e.dateFacetSet)?n:{},numericFacetSet:null!=(i=e.numericFacetSet)?i:{},automaticFacetSet:null!=(o=e.automaticFacetSet)?o:{desiredCount:5,numberOfValues:8,set:{}}}}var _i=e=>{let t=[];return qi(e).forEach(((r,n)=>{let i=Yi(e,r.facetId),o=Qi(r,n+1);if(Li(r)){if(!Ti(e,r.facetId).length)return;t.push({...o,...Hi(e,r.facetId),facetType:i,state:"selected"})}else r.currentValues.forEach(((e,n)=>{if("idle"===e.state)return;let a=Ni(e,n+1,i),s=$i(r)?zi(e):Vi(e);t.push({...o,...a,...s})}))})),Mi(e).forEach(((e,r)=>{let n=Bi(e,r+1);e.values.forEach(((e,r)=>{if("idle"===e.state)return;let i=Ni(e,r+1,"specific"),o=zi(e);t.push({...n,...i,...o})}))})),t},$i=e=>"specific"===e.type,Li=e=>"hierarchical"===e.type,qi=e=>[...Object.values(e.facetSet),...Object.values(e.categoryFacetSet),...Object.values(e.dateFacetSet),...Object.values(e.numericFacetSet)].map((e=>e.request)),Mi=e=>[...Object.values(e.automaticFacetSet.set)].map((e=>e.response)),Ni=(e,t,r)=>({state:e.state,valuePosition:t,facetType:r}),Vi=e=>({displayValue:`${e.start}..${e.end}`,value:`${e.start}..${e.end}`,start:e.start,end:e.end,endInclusive:e.endInclusive}),zi=e=>({displayValue:e.value,value:e.value}),Hi=(e,t)=>{let r=((e,t)=>Ti(e,t).map((e=>e.value)).join(";"))(e,t);return{value:r,valuePosition:1,displayValue:r}},Bi=(e,t)=>({title:Gi(e.field,e.field),field:e.field,id:e.field,facetPosition:t}),Qi=(e,t)=>({title:Gi(e.field,e.facetId),field:e.field,id:e.facetId,facetPosition:t}),Gi=(e,t)=>`${e}_${t}`,Yi=(e,t)=>{let r=((e,t)=>{var r,n,i,o,a;return(null==(r=e.facetSet[t])?void 0:r.request)||(null==(n=e.categoryFacetSet[t])?void 0:n.request)||(null==(i=e.dateFacetSet[t])?void 0:i.request)||(null==(o=e.numericFacetSet[t])?void 0:o.request)||(null==(a=e.automaticFacetSet.set[t])?void 0:a.response)})(e,t);return r?r.type:"specific"},Wi=class extends Ui{getSearchUID(){var e,t;let r=this.getState();return(null==(e=r.search)?void 0:e.searchResponseId)||(null==(t=r.search)?void 0:t.response.searchUid)||""}getPipeline(){var e;return this.state.pipeline||(null==(e=this.state.search)?void 0:e.response.pipeline)||"default"}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getFacetState(){return _i(Fi(this.state))}get queryText(){var e;return(null==(e=this.state.query)?void 0:e.q)||""}get responseTime(){var e;return(null==(e=this.state.search)?void 0:e.duration)||0}mapResultsToAnalyticsDocument(){var e;return null==(e=this.state.search)?void 0:e.response.results.map((e=>({documentUri:e.uri,documentUriHash:e.raw.urihash})))}get numberOfResults(){var e;return(null==(e=this.state.search)?void 0:e.response.results.length)||0}},Ki=class extends Ui{constructor(){super(...arguments),this.initialState={url:"",clientId:"",additionalFields:[],advancedParameters:{debug:!1},products:[],facets:{results:[]},error:null,isLoading:!1,responseId:""}}getPipeline(){return""}getSearchEventRequestPayload(){return{queryText:"",responseTime:0,results:this.mapResultsToAnalyticsDocument(),numberOfResults:this.numberOfResults}}getSearchUID(){var e;return(null==(e=this.getState().productListing)?void 0:e.responseId)||this.initialState.responseId}mapResultsToAnalyticsDocument(){var e;return null==(e=this.state.productListing)?void 0:e.products.map((e=>({documentUri:e.documentUri,documentUriHash:e.documentUriHash,permanentid:e.permanentid})))}get numberOfResults(){return this.state.productListing.products.length}};var Ji=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;var Zi=function(){let e="coveo_";return{getItem(t){let r=`${e}${t}=`,n=document.cookie.split(";");for(let e of n){let t=e.replace(/^\s+/,"");if(0===t.lastIndexOf(r,0))return t.substring(r.length,t.length)}return null},setItem(t,r,n){let i=(e=>{let t=window.location.hostname.split(".").slice(-2);return 2==t.length?t.join("."):""})(),o=`;expires=${new Date((new Date).getTime()+n).toUTCString()}`,a=i?`;domain=${i}`:"";document.cookie=`${e}${t}=${r}${o}${a};path=/;SameSite=Lax`},removeItem(e){this.setItem(e,"",-1)}}}();async function Xi(e,t){return fetch(e,t).catch((e=>{throw new Error(`${e.message}: The "host" value is invalid or a network error occured, according to the FetchAPI's response.`,{cause:e})}))}function eo(){return{getItem:()=>null,removeItem(){},setItem(){}}}function to(){return function(){try{return"object"==typeof window}catch{return!1}}()?{runtime:"browser",fetch:(e,t)=>Xi(e,t),send:async(e,t,r)=>{if(!navigator.sendBeacon(`${e}?access_token=${t}`,new Blob([r],{type:"application/json"})))throw new Error("Failed to send the event(s) because the payload size exceeded the maximum allowed size (32 KB). Please contact support if the problem persists.");return null},getReferrerUrl:()=>function(){let e=document.referrer;return""===e?null:e}(),getUrl:()=>window.location.href,getUserAgent:()=>navigator.userAgent,generateUUID:()=>crypto.randomUUID(),storage:{getItem:e=>Zi.getItem(e)||localStorage.getItem(e),removeItem(e){Zi.removeItem(e),localStorage.removeItem(e)},setItem(e,t){localStorage.setItem(e,t),Zi.setItem(e,t,31556952e3)}}}:{runtime:"node",fetch:(e,t)=>Xi(e,t),send:async(e,t,r)=>(Xi(e,{method:"POST",body:r,headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`}}),null),getReferrerUrl:()=>null,getUrl:()=>null,getUserAgent:()=>null,generateUUID:()=>crypto.randomUUID(),storage:eo()}}var ro="0.6.3";function no(e,t,r,n){let{getReferrerUrl:i,getUrl:o,getUserAgent:a}=r,s=function(e){let{trackingId:t}=e;return{trackingId:t}}(t),c=n.getClientId();return Object.freeze({type:e,config:s,ts:Date.now(),source:`relay@${ro}`,clientId:c,userAgent:a(),referrerUrl:i(),url:o()})}var io="*";function oo({url:e,token:t,trackingId:r,...n}){return Object.freeze({url:e,token:t,trackingId:r,...!!n.mode&&{mode:n.mode}})}function ao(e){let t=function(e){let t=oo(e);return{get:()=>t,update:e=>{t=oo({...t,...e})}}}(e),r=function(){let e=[];function t({type:t,callback:r}){return e.findIndex((e=>e.type===t&&e.callback===r))}function r(r,n){n?function(r){let n=t(r);n>=0&&e.splice(n,1)}({type:r,callback:n}):function(t){if(t===io)e.length=0;else for(let r=e.length-1;r>=0;r--)e[r].type===t&&e.splice(r,1)}(r)}return{add:function(n){return t(n)<0&&e.push(n),()=>r(n.type,n.callback)},call:function(t){e.forEach((e=>{if(function(e,t){return"*"===e.type||t===e.type}(e,t.meta.type))try{e.callback(t)}catch(e){console.error(e)}}))},remove:r}}(),n=()=>"disabled"==t.get().mode?{runtime:"null",fetch:()=>Promise.resolve(new Response(JSON.stringify(""))),send:async()=>null,getReferrerUrl:()=>null,getUrl:()=>null,getUserAgent:()=>null,generateUUID:()=>"",storage:eo()}:to(),i=function(e){let t="visitorId";return{getClientId:()=>{let r=e.storage,n=r.getItem(t),i=n&&function(e){return"string"==typeof e&&Ji.test(e)}(n)?n:e.generateUUID();return r.setItem(t,i),i},clear:()=>{e.storage.removeItem(t)}}}(n());return{emit:(e,o)=>{let a=t.get(),s=n(),c=function(e,t,r,n,i){return{...t,meta:no(e,r,n,i)}}(e,o,a,s,i);return async function(e){let{listenerManager:t,event:r,config:n}=e;return"disabled"!==n.mode&&t.call(r),"validate"===n.mode?async function({config:e,environment:t,event:r}){let{url:n,token:i}=e,o={"Content-Type":"application/json",Authorization:`Bearer ${i}`},a=await t.fetch(`${n}/validate`,{method:"POST",body:JSON.stringify([r]),headers:o}),s=await a.json();if(!a.ok)throw new Error({...s});if(!s)return{valid:!1,errors:[{type:"",message:"disabled",path:""}]};let{valid:c,errors:u}=s[0];return{valid:c,errors:u??[]}}(e):async function({event:e,config:t,environment:r}){let{url:n,token:i}=t;return r.send(n,i,JSON.stringify([e]))}(e)}({config:a,environment:s,event:c,listenerManager:r})},getMeta:e=>no(e,t.get(),n(),i),on:(e,t)=>r.add({type:e,callback:t}),off:(e,t)=>r.remove(e,t),updateConfig:e=>t.update(e),version:ro,clearStorage:()=>{i.clear()}}}var so=class extends Ui{getFacetState(){return _i(Fi(this.getState()))}getPipeline(){var e;return this.state.pipeline||(null==(e=this.state.search)?void 0:e.response.pipeline)||so.fallbackPipelineName}getSearchEventRequestPayload(){return{queryText:this.queryText,responseTime:this.responseTime,results:this.resultURIs,numberOfResults:this.numberOfResults}}getSearchUID(){var e,t;let r=this.getState();return(null==(e=r.search)?void 0:e.searchResponseId)||(null==(t=r.search)?void 0:t.response.searchUid)||""}getSplitTestRunName(){var e;return null==(e=this.state.search)?void 0:e.response.splitTestRun}getSplitTestRunVersion(){var e;let t=!!this.getSplitTestRunName(),r=(null==(e=this.state.search)?void 0:e.response.pipeline)||this.state.pipeline||so.fallbackPipelineName;return t?r:void 0}getBaseMetadata(){var e,t,r;let n=this.getState(),i=super.getBaseMetadata(),o=null==(r=null==(t=null==(e=n.search)?void 0:e.response)?void 0:t.extendedResults)?void 0:r.generativeQuestionAnsweringId;return o&&(i.generativeQuestionAnsweringId=o),i}getGeneratedAnswerMetadata(){var e;let t=this.getState(),r={};return void 0!==(null==(e=t.generatedAnswer)?void 0:e.isVisible)&&(r.showGeneratedAnswer=t.generatedAnswer.isVisible),r}get resultURIs(){var e;return null==(e=this.results)?void 0:e.map((e=>({documentUri:e.uri,documentUriHash:e.raw.urihash})))}get results(){var e;return null==(e=this.state.search)?void 0:e.response.results}get queryText(){var e;return(null==(e=this.state.query)?void 0:e.q)||""}get responseTime(){var e;return(null==(e=this.state.search)?void 0:e.duration)||0}get numberOfResults(){var e;return(null==(e=this.state.search)?void 0:e.response.totalCountFiltered)||0}},co=so;co.fallbackPipelineName="default";var uo=(e,t,r)=>function(...n){let i=1===n.length?{...n[0],__legacy__getBuilder:t(n[0].__legacy__getBuilder),analyticsConfigurator:e,providerClass:r}:{prefix:n[0],__legacy__getBuilder:t(n[1]),__legacy__provider:n[2],analyticsConfigurator:e,providerClass:r};return lo(i)},lo=({prefix:e,__legacy__getBuilder:t,__legacy__provider:r,analyticsPayloadBuilder:n,analyticsType:i,analyticsConfigurator:o,providerClass:a})=>(null!=r||(r=e=>new a(e)),function(e,t){let r=t=>function(e){return Object.assign(e,{instantlyCallable:!0})}(ar(e,t)),n=r((async(e,{getState:r,extra:n})=>{let{analyticsClientMiddleware:i,preprocessRequest:o,logger:a}=n;return await(await t({getState:r,analyticsClientMiddleware:i,preprocessRequest:o,logger:a})).log({state:r(),extra:n})}));return Object.assign(n,{prepare:async({getState:e,analyticsClientMiddleware:n,preprocessRequest:i,logger:o})=>{let{description:a,log:s}=await t({getState:e,analyticsClientMiddleware:n,preprocessRequest:i,logger:o});return{description:a,action:r((async(e,{getState:t,extra:r})=>await s({state:t(),extra:r})))}}}),n}(e,(async({getState:e,analyticsClientMiddleware:a,preprocessRequest:s,logger:c})=>{let u=[],l={log:async({state:e})=>{for(let t of u)await t(e)}},d=e(),h=o({getState:e,logger:c,analyticsClientMiddleware:a,preprocessRequest:s,provider:r(e)}),p=await t(h,e());l.description=null==p?void 0:p.description,u.push((async e=>{(e=>"legacy"===e.configuration.analytics.analyticsMode)(e)&&await async function(e,t,r,n,i){t((()=>r));let o=await(null==e?void 0:e.log({searchUID:t((()=>r)).getSearchUID()}));n.info({client:i,response:o},"Analytics response")}(p,r,e,c,h.coveoAnalyticsClient)}));let g=(e=>{let t=e.configuration.accessToken,r=e.configuration.analytics.trackingId,{emit:n}=ao({url:e.configuration.analytics.nextApiBaseUrl,token:t,trackingId:r});return n})(d);return u.push((async e=>{if((e=>"next"===e.configuration.analytics.analyticsMode)(e)&&i&&n){let t=n(e);await async function(e,t,r){await e(t,r)}(g,i,t)}})),l}))),ho=e=>(t,r)=>Promise.resolve({description:{actionCause:"caseAssist"},log:async n=>{e(t,r)}}),po=uo((({logger:e,getState:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new co(t)})=>{let o=t(),a=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new mi({token:a,endpoint:s,runtimeEnvironment:c,preprocessRequest:Ei(e,n),beforeSendHooks:[Ai(e,r),(t,r)=>(e.info({...r,type:t,endpoint:s,token:a},"Analytics request"),r)]},i);return u||l.disable(),l}),(e=>e),co),go=(uo((({logger:e,getState:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new ji(t)})=>{let o=t(),a=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new Si({enableAnalytics:u,token:a,endpoint:s,runtimeEnvironment:c,preprocessRequest:Ei(e,n),beforeSendHooks:[Ai(e,r),(t,r)=>(e.info({...r,type:t,endpoint:s,token:a},"Analytics request"),r)]},i);return u||l.disable(),l}),ho,ji),uo((({logger:e,getState:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new Wi(t)})=>{let o=t(),a=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new ki({enableAnalytics:u,token:a,endpoint:s,runtimeEnvironment:c,preprocessRequest:Ei(e,n),beforeSendHooks:[Ai(e,r),(t,r)=>(e.info({...r,type:t,endpoint:s,token:a},"Analytics request"),r)]},i);return u||l.disable(),l}),ho,Wi),uo((({logger:e,getState:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new Pi(t)})=>{let o=t(),a=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new mi({token:a,endpoint:s,runtimeEnvironment:c,preprocessRequest:Ei(e,n),beforeSendHooks:[Ai(e,r),(t,r)=>(e.info({...r,type:t,endpoint:s,token:a},"Analytics request"),r)]},i);return u||l.disable(),l}),(e=>e),Pi),uo((({logger:e,getState:t,analyticsClientMiddleware:r=((e,t)=>t),preprocessRequest:n,provider:i=new Ki(t)})=>{let o=t(),a=o.configuration.accessToken,s=o.configuration.analytics.apiBaseUrl,c=o.configuration.analytics.runtimeEnvironment,u=o.configuration.analytics.enabled,l=new mi({token:a,endpoint:s,runtimeEnvironment:c,preprocessRequest:Ei(e,n),beforeSendHooks:[Ai(e,r),(t,r)=>(e.info({...r,type:t,endpoint:s,token:a},"Analytics request"),r)]},i);return u||l.disable(),l}),(e=>e),Ki),{urihash:new N,sourcetype:new N,permanentid:new N}),fo={uniqueId:lr,raw:new z({values:go}),title:lr,uri:lr,clickUri:lr,rankingModifier:new N({required:!1,emptyAllowed:!0})},mo=e=>po("analytics/productRecommendation/open",((t,r)=>((e=>{new j(fo).validate(function(e){let t=function(e){return{uniqueId:e.permanentid,title:e.ec_name||"",uri:e.documentUri,clickUri:e.clickUri}}(e);return Object.assign({},...Object.keys(fo).map((e=>({[e]:t[e]}))))}(e))})(e),t.makeRecommendationOpen(((e,t)=>{var r;let n=(null==(r=t.productRecommendations)?void 0:r.recommendations.findIndex((({permanentid:t})=>e.permanentid===t)))||0;return function(e,t){return{collectionName:"",documentAuthor:"",documentPosition:t+1,documentTitle:e.ec_name||"",documentUri:e.documentUri,documentUriHash:e.documentUriHash,documentUrl:e.clickUri,rankingModifier:"",sourceName:"unknown",queryPipeline:""}}(e,n)})(e,r),(e=>(e.permanentid||console.warn("Missing field permanentid on productRecommendation. This might cause many issues with your Coveo deployment. See https://docs.coveo.com/en/1913 and https://docs.coveo.com/en/1640 for more information.",e),{contentIDKey:"permanentid",contentIDValue:e.permanentid||""}))(e)))),(e=>new xi(e))),vo=Wt("productrecommendations/setId",(e=>fr(e,{id:lr}))),yo=Wt("productrecommendations/setSku",(e=>fr(e,{skus:new B({required:!0,min:1,each:dr})}))),bo=Wt("productrecommendations/setBrand",(e=>fr(e,{brand:new N({required:!0,emptyAllowed:!0})}))),So=Wt("productrecommendations/setCategory",(e=>fr(e,{category:new N({required:!0,emptyAllowed:!0})}))),wo=Wt("productrecommendations/setAdditionalFields",(e=>fr(e,{additionalFields:new B({required:!0,each:dr})}))),ko=Wt("productrecommendations/setMaxNumberOfRecommendations",(e=>fr(e,{number:new _({required:!0,max:50,min:1})}))),Oo=ar("productRecommendations/get",(async(e,{getState:t,rejectWithValue:r,extra:{apiClient:n}})=>{let i=t(),o=(new Date).getTime(),a=await n.productRecommendations(await Io(i)),s=(new Date).getTime()-o;if((e=>void 0!==e.error)(a))return r(a.error);let c=i.productRecommendations.additionalFields||[];return{recommendations:a.success.results.map((e=>Co(e,{additionalFields:c}))),analyticsAction:po("analytics/productRecommendations/load",(e=>e.makeRecommendationInterfaceLoad()),(e=>new xi(e))),searchUid:a.success.searchUid,duration:s}})),Co=(e,{additionalFields:t})=>{let r=e.raw.ec_price,n=e.raw.ec_promo_price,i=e.raw.ec_in_stock,o={documentUri:e.uri,documentUriHash:e.raw.urihash,permanentid:e.raw.permanentid,clickUri:e.clickUri,ec_name:e.raw.ec_name,ec_brand:e.raw.ec_brand,ec_category:e.raw.ec_category,ec_item_group_id:e.raw.ec_item_group_id,ec_price:r,ec_shortdesc:e.raw.ec_shortdesc,ec_thumbnails:e.raw.ec_thumbnails,ec_images:e.raw.ec_images,ec_promo_price:void 0===n||void 0!==r&&n>=r?void 0:n,ec_in_stock:void 0===i?void 0:"yes"===i.toLowerCase()||"true"===i.toLowerCase(),ec_rating:e.raw.ec_rating,additionalFields:t.reduce(((t,r)=>({...t,[r]:e.raw[r]})),{}),childResults:[],totalNumberOfChildResults:0};return function(e){return e&&"childResults"in e&&"totalNumberOfChildResults"in e}(e)&&(o.childResults=e.childResults.map((e=>Co(e,{additionalFields:t}))),o.totalNumberOfChildResults=e.totalNumberOfChildResults),o},Io=async e=>({accessToken:e.configuration.accessToken,organizationId:e.configuration.organizationId,url:e.configuration.search.apiBaseUrl,locale:e.configuration.search.locale,timezone:e.configuration.search.timezone,...e.configuration.analytics.enabled&&{visitorId:await Oi(e.configuration.analytics)},recommendation:e.productRecommendations.id,numberOfResults:e.productRecommendations.maxNumberOfRecommendations,fieldsToInclude:[...Di,...e.productRecommendations.additionalFields||[]],mlParameters:{...e.productRecommendations.skus&&e.productRecommendations.skus.length>0&&{itemIds:e.productRecommendations.skus},...e.productRecommendations.filter.brand&&{brandFilter:e.productRecommendations.filter.brand},...e.productRecommendations.filter.category&&{categoryFilter:e.productRecommendations.filter.category}},actionsHistory:e.configuration.analytics.enabled?Ii.getHistory():[],...e.context&&{context:e.context.contextValues},...e.dictionaryFieldContext&&{dictionaryFieldContext:e.dictionaryFieldContext.contextValues},...e.searchHub&&{searchHub:e.searchHub}}),Eo=tr({id:"",skus:[],maxNumberOfRecommendations:5,filter:{brand:"",category:""},additionalFields:[],recommendations:[],error:null,isLoading:!1,searchUid:"",duration:0},(e=>{e.addCase(vo,((e,t)=>{e.id=t.payload.id})).addCase(yo,((e,t)=>{e.skus=t.payload.skus})).addCase(bo,((e,t)=>{e.filter.brand=t.payload.brand})).addCase(So,((e,t)=>{e.filter.category=t.payload.category})).addCase(ko,((e,t)=>{e.maxNumberOfRecommendations=t.payload.number})).addCase(wo,((e,t)=>{e.additionalFields=t.payload.additionalFields})).addCase(Oo.rejected,((e,t)=>{e.error=t.payload?t.payload:null,e.isLoading=!1})).addCase(Oo.fulfilled,((e,t)=>{e.error=null,e.searchUid=t.payload.searchUid,e.recommendations=t.payload.recommendations,e.isLoading=!1})).addCase(Oo.pending,(e=>{e.isLoading=!0}))})),Ao=Wt("searchHub/set",(e=>fr(e,new N({required:!0,emptyAllowed:!0})))),Do=Wt("history/undo"),Ro=Wt("history/redo"),Uo=(Wt("history/snapshot"),ar("history/back",(async(e,{dispatch:t})=>{t(Do()),await t(Uo())})),ar("history/forward",(async(e,{dispatch:t})=>{t(Ro()),await t(Uo())})),ar("history/change",(async(e,{getState:t})=>t().history.present))),xo=tr("default",(e=>{e.addCase(Ao,((e,t)=>t.payload)).addCase(Uo.fulfilled,((e,t)=>{var r,n;return null!=(n=null==(r=t.payload)?void 0:r.searchHub)?n:e})).addCase(wr,((e,t)=>t.payload.searchHub||e))})),jo=tr(Ri,(e=>e)),Po=e=>t=>r=>{var n,i;let o=null==(n=r.payload)?void 0:n.analyticsAction;void 0!==o&&(null==(i=r.payload)||delete i.analyticsAction);let a=t(r);return"search/executeSearch/fullfilled"===r.type&&void 0===o&&console.error("No analytics action associated with search:",r),"recommendation/get/fullfilled"===r.type&&void 0===o&&console.error("No analytics action associated with recommendation:",r),"productRecommendations/get/fullfilled"===r.type&&void 0===o&&console.error("No analytics action associated with product recommendation:",r),void 0!==o&&e.dispatch(o),a},To=u(C()),Fo={q:new N,enableQuerySyntax:new L,aq:new N,cq:new N,firstResult:new _({min:0}),numberOfResults:new _({min:0}),sortCriteria:new N,f:new z,fExcluded:new z,cf:new z,nf:new z,df:new z,debug:new L,sf:new z,tab:new N,af:new z},_o=Wt("searchParameters/restore",(e=>fr(e,Fo))),$o=(Wt("tab/register",(e=>{let t=new z({values:{id:lr,expression:hr}});return fr(e,t)})),Wt("tab/updateActiveTab",(e=>fr(e,lr)))),Lo=u(I()),qo=u(E()),Mo=u(A());Lo.default.extend(Mo.default),Lo.default.extend(qo.default);var No="/rest/search/v2",Vo="/rest/ua";var zo=tr({organizationId:"",accessToken:"",platformUrl:de(),search:{apiBaseUrl:`${de()}${No}`,locale:"en-US",timezone:Lo.default.tz.guess(),authenticationProviders:[]},analytics:{enabled:!0,apiBaseUrl:`${function(e){return ue("analytics",e)}()}${Vo}`,nextApiBaseUrl:"",originContext:"Search",originLevel2:"default",originLevel3:"default",anonymous:!1,deviceId:"",userDisplayName:"",documentLocation:"",trackingId:"",analyticsMode:"legacy"}},(e=>e.addCase(Sr,((e,t)=>{t.payload.accessToken&&(e.accessToken=t.payload.accessToken),t.payload.organizationId&&(e.organizationId=t.payload.organizationId),t.payload.platformUrl&&(e.platformUrl=t.payload.platformUrl,e.search.apiBaseUrl=`${t.payload.platformUrl}${No}`,e.analytics.apiBaseUrl=function(e,t){if((e=>/^https:\/\/platform(dev|stg|hipaa)?(-)?(eu|au)?\.cloud\.coveo\.com/.test(e))(e))return e.replace(/^(https:\/\/)platform/,"$1analytics")+Vo;let r=((e,t)=>{let r=ge(e);return r&&r.organizationId===t?r:null})(e,t);return r?le(t,r.environment).analytics:e}(t.payload.platformUrl,e.organizationId))})).addCase(wr,((e,t)=>{t.payload.apiBaseUrl&&(e.search.apiBaseUrl=t.payload.apiBaseUrl),t.payload.locale&&(e.search.locale=t.payload.locale),t.payload.timezone&&(e.search.timezone=t.payload.timezone),t.payload.authenticationProviders&&(e.search.authenticationProviders=t.payload.authenticationProviders)})).addCase(kr,((e,t)=>{F(t.payload.enabled)||(!t.payload.enabled&&e.analytics.enabled&&Ci(e.analytics),e.analytics.enabled=t.payload.enabled),F(t.payload.originContext)||(e.analytics.originContext=t.payload.originContext),F(t.payload.originLevel2)||(e.analytics.originLevel2=t.payload.originLevel2),F(t.payload.originLevel3)||(e.analytics.originLevel3=t.payload.originLevel3),F(t.payload.apiBaseUrl)||(e.analytics.apiBaseUrl=t.payload.apiBaseUrl),F(t.payload.nextApiBaseUrl)||(e.analytics.nextApiBaseUrl=t.payload.nextApiBaseUrl),F(t.payload.trackingId)||(e.analytics.trackingId=t.payload.trackingId),F(t.payload.analyticsMode)||(e.analytics.analyticsMode=t.payload.analyticsMode),(0,To.default)()&&(e.analytics.analyticsMode="next"),F(t.payload.runtimeEnvironment)||(e.analytics.runtimeEnvironment=t.payload.runtimeEnvironment),F(t.payload.anonymous)||(e.analytics.anonymous=t.payload.anonymous),F(t.payload.deviceId)||(e.analytics.deviceId=t.payload.deviceId),F(t.payload.userDisplayName)||(e.analytics.userDisplayName=t.payload.userDisplayName),F(t.payload.documentLocation)||(e.analytics.documentLocation=t.payload.documentLocation)})).addCase(Or,(e=>{e.analytics.enabled=!1,Ci(e.analytics)})).addCase(Cr,(e=>{e.analytics.enabled=!0})).addCase(Ir,((e,t)=>{e.analytics.originLevel2=t.payload.originLevel2})).addCase(Er,((e,t)=>{e.analytics.originLevel3=t.payload.originLevel3})).addCase($o,((e,t)=>{e.analytics.originLevel2=t.payload})).addCase(_o,((e,t)=>{e.analytics.originLevel2=t.payload.tab||e.analytics.originLevel2})))),Ho=zo,Bo=()=>e=>t=>e(function(e){return e.instantlyCallable}(t)?t():t),Qo=e=>()=>t=>r=>{var n;if(!r.error)return t(r);let i=r.error;return(null==(n=r.payload)?void 0:n.ignored)||e.error(i.stack||i.message||i.name||"Error",`Action dispatch error ${r.type}`,r),"SchemaValidationError"!==r.error.name?t(r):void 0},Go=e=>t=>r=>n=>(e.debug({action:n,nextState:t.getState()},`Action dispatched: ${n.type}`),r(n));function Yo(e,t){let r=0,n=function(e,t,r){var n,i,o;void 0===t&&(t=50),void 0===r&&(r={});var a=null!=(n=r.isImmediate)&&n,s=null!=(i=r.callback)&&i,c=r.maxWait,u=Date.now(),l=[],d=function(){var r=[].slice.call(arguments),n=this;return new Promise((function(i,d){var h=a&&void 0===o;if(void 0!==o&&clearTimeout(o),o=setTimeout((function(){if(o=void 0,u=Date.now(),!a){var t=e.apply(n,r);s&&s(t),l.forEach((function(e){return(0,e.resolve)(t)})),l=[]}}),function(){if(void 0!==c){var e=Date.now()-u;if(e+t>=c)return c-e}return t}()),h){var p=e.apply(n,r);return s&&s(p),i(p)}l.push({resolve:i,reject:d})}))};return d.cancel=function(e){void 0!==o&&clearTimeout(o),l.forEach((function(t){return(0,t.reject)(e)})),l=[]},d}((()=>r=0),500);return i=>o=>async a=>{if("function"!=typeof a)return o(a);let s=await o(a);if(!function(e){var t;return(null==(t=null==e?void 0:e.error)?void 0:t.name)===(new te).name}(s))return s;if("function"!=typeof t)return e.warn("Unable to renew the expired token because a renew function was not provided. Please specify the #renewAccessToken option when initializing the engine."),s;if(r>=5)return e.warn("Attempted to renew the token but was not successful. Please check the #renewAccessToken function."),s;r++,n();let c=await async function(e){try{return await e()}catch(e){return""}}(t);i.dispatch(Sr({accessToken:c})),i.dispatch(a)}}var Wo={configuration:Ho,version:jo};function Ko(e,t){var r;let n=function(e,t){var r;let{reducers:n}=e,i=function(e,t){let r,n={...e};return{get combinedReducer(){let e=function(e){let t={};for(let[r,n]of e)t[r]=n;return t}(Object.entries(t).filter((([e])=>!(e in n))).map((([e,t])=>[e,()=>t])));return(e=>(t,n)=>{let i=e(t,n);return r?r(i,n):i})(Ut({...e,...n}))},containsAll:e=>Object.keys(e).every((e=>e in n)),add(e){Object.keys(e).filter((e=>!(e in n))).forEach((t=>n[t]=e[t]))},addCrossReducer(e){r=e}}}({...Wo,...n},null!=(r=e.preloadedState)?r:{});e.crossReducer&&i.addCrossReducer(e.crossReducer);let o=t.logger,a=function(e,t,r){let{preloadedState:n,configuration:i}=e,o=i.name||"coveo-headless",a=function(e,t){let{renewAccessToken:r}=e.configuration,n=Yo(t,r);return[Bo,n,Qo(t),Po].concat(e.middlewares||[])}(e,t.logger);return function({reducer:e,preloadedState:t,middlewares:r=[],thunkExtraArguments:n,name:i}){return er({reducer:e,preloadedState:t,devTools:{stateSanitizer:e=>e.history?{...e,history:"<<OMIT>>"}:e,name:i,shouldHotReload:!1},middleware:e=>[...r,...e({thunk:{extraArgument:n}}),Go(n.logger)]})}({preloadedState:n,reducer:r.combinedReducer,middlewares:a,thunkExtraArguments:t,name:o})}(e,t,i);return{addReducers(e){i.containsAll(e)||(i.add(e),a.replaceReducer(i.combinedReducer))},dispatch:a.dispatch,subscribe:a.subscribe,enableAnalytics(){a.dispatch(Cr())},disableAnalytics(){a.dispatch(Or())},get state(){return a.getState()},logger:o,store:a}}(e,t),{accessToken:i,organizationId:o}=e.configuration,{organizationEndpoints:a}=e.configuration,s=(null==a?void 0:a.platform)||e.configuration.platformUrl;(function(e){var t;return!F(e.configuration.platformUrl)||F(null==(t=e.configuration.organizationEndpoints)?void 0:t.platform)})(e)&&n.logger.warn(`The \`platformUrl\` (${e.configuration.platformUrl}) option will be deprecated in the next major version. Consider using the \`organizationEndpoints\` option instead. See [Organization endpoints](https://docs.coveo.com/en/mcc80216).`),function(e){return T(e.configuration.organizationEndpoints)}(e)?n.logger.warn("The `organizationEndpoints` options was not explicitly set in the Headless engine configuration. Coveo recommends setting this option, as it has resiliency benefits and simplifies the overall configuration for multi-region deployments. See [Organization endpoints](https://docs.coveo.com/en/mcc80216)."):function(e){let{platform:t}=e.configuration.organizationEndpoints;if(T(t))return!1;let r=ge(t);return r&&r.organizationId!==e.configuration.organizationId}(e)&&n.logger.warn(`There is a mismatch between the \`organizationId\` option (${e.configuration.organizationId}) and the organization configured in the \`organizationEndpoints\` option (${null==(r=e.configuration.organizationEndpoints)?void 0:r.platform}). This could lead to issues that are complex to troubleshoot. Please make sure both values match.`),n.dispatch(Sr({accessToken:i,organizationId:o,platformUrl:s}));let c=function(e,t){var r,n;let i=(null==(r=e.configuration.organizationEndpoints)?void 0:r.analytics)||void 0,{analyticsClientMiddleware:o,...a}=null!=(n=e.configuration.analytics)?n:{},s={...a,nextApiBaseUrl:`${i}/rest/organizations/${e.configuration.organizationId}/events/v1`,apiBaseUrl:i};return ie()?(t.info("Analytics disabled since doNotTrack is active."),{...s,enabled:!1}):s}(e,n.logger);return c&&n.dispatch(kr(c)),n}var Jo=u(R());function Zo(e,t){let r=function(e){let{analytics:t}=e;return(null==t?void 0:t.analyticsClientMiddleware)||((e,t)=>t)}(e),n=gr,i=function(e){return e.preprocessRequest||Q}(e);return{analyticsClientMiddleware:r,validatePayload:n,preprocessRequest:i,logger:t}}var Xo={organizationId:lr,accessToken:lr,platformUrl:new N({required:!1,emptyAllowed:!1}),name:new N({required:!1,emptyAllowed:!1}),analytics:new z({options:{required:!1},values:{enabled:new L({required:!1}),originContext:new N({required:!1}),originLevel2:new N({required:!1}),originLevel3:new N({required:!1}),analyticsMode:new N({constrainTo:["legacy","next"],required:!1})}})},ea=new j({...Xo,searchHub:dr,locale:dr,timezone:dr});function ta(){return{organizationId:"searchuisamples",accessToken:"xx564559b1-0045-48e1-953c-3addd1ee4457",organizationEndpoints:le("searchuisamples"),searchHub:"default"}}var ra={searchHub:xo,productRecommendations:Eo};function na(e){let t=function(e){return(0,Jo.default)({name:"@coveo/headless",level:(null==e?void 0:e.level)||"warn",formatters:{log:null==e?void 0:e.logFormatter}})}(e.loggerOptions);!function(e,t){try{ea.validate(e)}catch(e){throw t.error("Product Recommendation engine configuration error",e),e}}(e.configuration,t);let r=function(e,t){return new be({logger:t,preprocessRequest:e.preprocessRequest||Q,postprocessSearchResponseMiddleware:we,postprocessFacetSearchResponseMiddleware:ke,postprocessQuerySuggestResponseMiddleware:Oe})}(e.configuration,t),n={...Zo(e.configuration,t),apiClient:r},i=Ko({...e,reducers:ra},n),{searchHub:o,timezone:a,locale:s}=e.configuration;return i.dispatch(wr({timezone:a,locale:s})),F(o)||i.dispatch(Ao(o)),{...i,get state(){return i.state}}}function ia(e){return e.addReducers({configuration:Ho}),{disableAnalytics:Or,enableAnalytics:Cr,setOriginLevel2:Ir,setOriginLevel3:Er,updateAnalyticsConfiguration:kr,updateBasicConfiguration:Sr}}function oa(e){return e.addReducers({productRecommendations:Eo}),{getProductRecommendations:Oo,setProductRecommendationsAdditionalFields:wo,setProductRecommendationsBrandFilter:bo,setProductRecommendationsCategoryFilter:So,setProductRecommendationsMaxNumberOfRecommendations:ko,setProductRecommendationsRecommenderId:vo,setProductRecommendationsSkus:yo}}function aa(e){return e.addReducers({}),{logProductRecommendationOpen:mo}}var sa=new B({each:lr,required:!0}),ca=(e,t)=>(fr(e,lr),V(t)?fr(t,lr):fr(t,sa),{payload:{contextKey:e,contextValue:t}}),ua=Wt("context/set",(e=>{for(let[t,r]of Object.entries(e))ca(t,r);return{payload:e}})),la=Wt("context/add",(e=>ca(e.contextKey,e.contextValue))),da=Wt("context/remove",(e=>fr(e,lr))),ha=tr({contextValues:{}},(e=>{e.addCase(ua,((e,t)=>{e.contextValues=t.payload})).addCase(la,((e,t)=>{e.contextValues[t.payload.contextKey]=t.payload.contextValue})).addCase(da,((e,t)=>{delete e.contextValues[t.payload]})).addCase(Uo.fulfilled,((e,t)=>{!t.payload||(e.contextValues=t.payload.context.contextValues)}))}));function pa(e){return e.addReducers({context:ha}),{addContext:la,removeContext:da,setContext:ua}}var ga=Wt("dictionaryFieldContext/set",(e=>{let t=new z({options:{required:!0}}),r=fr(e,t).error;if(r)return{payload:e,error:r};let n=Object.values(e),i=new B({each:hr}),o=fr(n,i).error;return o?{payload:e,error:o}:{payload:e}})),fa=Wt("dictionaryFieldContext/add",(e=>{let t=new z({options:{required:!0},values:{field:hr,key:hr}});return fr(e,t)})),ma=Wt("dictionaryFieldContext/remove",(e=>fr(e,hr))),va=tr({contextValues:{}},(e=>{e.addCase(ga,((e,t)=>{e.contextValues=t.payload})).addCase(fa,((e,t)=>{let{field:r,key:n}=t.payload;e.contextValues[r]=n})).addCase(ma,((e,t)=>{delete e.contextValues[t.payload]})).addCase(Uo.fulfilled,((e,t)=>{!t.payload||(e.contextValues=t.payload.dictionaryFieldContext.contextValues)}))}));function ya(e){return e.addReducers({dictionaryFieldContext:va}),{addContext:fa,removeContext:ma,setContext:ga}}function ba(e){return e.addReducers({searchHub:xo}),{setSearchHub:Ao}}function Sa(e){let t,r=new Map,n=()=>0===r.size;return{subscribe(i){i();let o,a=Symbol();return n()&&(t=JSON.stringify(this.state),o=e.subscribe((()=>{(e=>{try{let r=JSON.stringify(e),n=t!==r;return t=r,n}catch(e){return console.warn('Could not detect if state has changed, check the controller "get state method"',e),!0}})(this.state)&&r.forEach((e=>e()))}))),r.set(a,i),()=>{r.delete(a),n()&&o&&o()}},get state(){return{}}}}var wa={additionalFields:new B({required:!1,each:dr}),skus:new B({required:!1,each:dr}),maxNumberOfRecommendations:new _({required:!1,max:50,min:1,default:5})},ka=new j({id:lr,...wa}),Oa=(e,t={})=>{if(!function(e){return e.addReducers({productRecommendations:Eo,configuration:Ho}),!0}(e))throw ee;let r=Sa(e),{dispatch:n}=e,i=mr(e,ka,t.options,"buildBaseProductRecommendationsList");return n(vo({id:i.id})),n(ko({number:i.maxNumberOfRecommendations})),i.additionalFields&&n(wo({additionalFields:i.additionalFields})),i.skus&&n(yo({skus:i.skus})),{...r,setSkus(e){n(yo({skus:e}))},refresh(){n(Oo())},get state(){let{skus:t,maxNumberOfRecommendations:r,recommendations:n,error:i,isLoading:o}=e.state.productRecommendations;return{skus:t,maxNumberOfRecommendations:r,recommendations:n,error:i,isLoading:o}}}},Ca=new j({sku:new N({required:!0,emptyAllowed:!1}),maxNumberOfRecommendations:wa.maxNumberOfRecommendations,additionalFields:wa.additionalFields});function Ia(e,t){let r=mr(e,Ca,t.options,"buildFrequentlyBoughtTogetherList"),n=Oa(e,{...t,options:{maxNumberOfRecommendations:r.maxNumberOfRecommendations,additionalFields:r.additionalFields,skus:[r.sku],id:"frequentBought"}}),{setSkus:i,...o}=n;return{...o,setSku(e){i([e])},get state(){let{skus:e,...t}=n.state;return{...t,sku:e[0]}}}}var Ea=new j({...wa});function Aa(e,t){let r=mr(e,Ea,t.options,"buildCartRecommendationsList");return Oa(e,{...t,options:{...r,id:"cart"}})}var Da=new j({...wa});function Ra(e,t){let r=mr(e,Da,t.options,"buildFrequentlyViewedTogetherList");return Oa(e,{...t,options:{...r,id:"frequentViewed"}})}var Ua=new j({maxNumberOfRecommendations:wa.maxNumberOfRecommendations,additionalFields:wa.additionalFields});function xa(e,t={}){let r=mr(e,Ua,t.options,"buildPopularBoughtRecommendationsList"),n=Oa(e,{...t,options:{...r,id:"popularBought"}}),{setSkus:i,...o}=n;return{...o,get state(){let{skus:e,...t}=n.state;return{...t}}}}var ja=new j({maxNumberOfRecommendations:wa.maxNumberOfRecommendations,additionalFields:wa.additionalFields});function Pa(e,t={}){let r=mr(e,ja,t.options,"buildPopularViewedRecommendationsList"),n=Oa(e,{...t,options:{...r,id:"popularViewed"}}),{setSkus:i,...o}=n;return{...o,get state(){let{skus:e,...t}=n.state;return{...t}}}}var Ta=new j({maxNumberOfRecommendations:wa.maxNumberOfRecommendations,additionalFields:wa.additionalFields});function Fa(e,t){let r=mr(e,Ta,t.options,"buildUserInterestRecommendationsList"),n=Oa(e,{...t,options:{...r,id:"user"}}),{setSkus:i,...o}=n;return{...o,get state(){let{skus:e,...t}=n.state;return{...t}}}}function _a(e){return function(e){if(!function(e){return e.addReducers({context:ha}),!0}(e))throw ee;let t=Sa(e),{dispatch:r}=e;return{...t,get state(){return{values:e.state.context.contextValues}},set(e){r(ua(e))},add(e,t){r(la({contextKey:e,contextValue:t}))},remove(e){r(da(e))}}}(e)}function $a(e){if(!function(e){return e.addReducers({dictionaryFieldContext:va}),!0}(e))throw ee;let t=Sa(e),{dispatch:r}=e;return{...t,get state(){return{values:e.state.dictionaryFieldContext.contextValues}},set(e){r(ga(e))},add(e,t){r(fa({field:e,key:t}))},remove(e){r(ma(e))}}}var La=new j({...wa});function qa(e,t){let r=mr(e,La,t.options,"buildFrequentlyViewedSameCategoryList");return Oa(e,{...t,options:{...r,id:"frequentViewedSameCategory"}})}var Ma=new j({...wa});function Na(e,t){let r=mr(e,Ma,t.options,"buildFrequentlyViewedDifferentCategoryList");return Oa(e,{...t,options:{...r,id:"frequentViewedDifferentCategory"}})}"undefined"==typeof window&&(U()||(global.crypto=require("crypto")),!U().getRandomValues&&U().webcrypto&&(global.crypto.getRandomValues=U().webcrypto.getRandomValues.bind(U().webcrypto)))}));