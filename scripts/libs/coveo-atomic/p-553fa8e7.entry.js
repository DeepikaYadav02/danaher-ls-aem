import{r as t,h as i,g as e}from"./p-591772f1.js";import{$ as s,d as n,e as a,x as h,_ as o,K as r}from"./p-127d2a71.js";import{c,a as l,b as u,i as d,C as f,m as p}from"./p-ed922ba8.js";import{A as g}from"./p-95642beb.js";import{c as m}from"./p-62349d50.js";import"./p-eab67c09.js";import"./p-f840f03f.js";import"./p-a5540571.js";import"./p-d2151deb.js";import"./p-3eb3e1ff.js";function b(e,t){const i=(t,i)=>y(t,i,e),n={analyticsClientMiddleware:i,enabled:t,...c()};return e.analytics?{...n,...e.analytics,analyticsClientMiddleware:i}:n}function y(e,t,i){let n=l(e,t,i);return n=u(n),n}function j(){return{...m({loadingFlags:[],facets:{},numericFacets:{},dateFacets:{},categoryFacets:{},iconAssetsPath:"",facetElements:[],fieldsToInclude:[]}),getUniqueIDFromEngine:e=>e.state.recommendation.searchUid}}var v=function(e,t,i,n){var s,a=arguments.length,o=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var r=e.length-1;r>=0;r--)(s=e[r])&&(o=(a<3?s(o):a>3?s(t,i,o):s(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o};const A="firstRecommendationExecuted",I=class{constructor(e){t(this,e),this.store=j(),this.initialized=!1,this.analytics=!0,this.i18n=d.createInstance(),this.localizationCompatibilityVersion="v3",this.language="en",this.fieldsToInclude="[]",this.languageAssetsPath="./lang",this.iconAssetsPath="./assets",this.error=void 0,this.pipeline=void 0,this.searchHub=void 0,this.timezone=void 0,this.engine=void 0,this.analytics=!0,this.i18n=d.createInstance(),this.logLevel=void 0,this.localizationCompatibilityVersion="v3",this.language="en",this.fieldsToInclude="[]",this.languageAssetsPath="./lang",this.iconAssetsPath="./assets",this.commonInterfaceHelper=new f(this,"CoveoAtomicRecs")}get bindings(){return{engine:this.engine,i18n:this.i18n,store:this.store,interfaceElement:this.host}}connectedCallback(){this.store.setLoadingFlag(A)}initialize(e){return this.internalInitialization((()=>this.initEngine(e)))}initializeWithRecommendationEngine(e){return this.pipeline&&this.pipeline!==e.state.pipeline&&console.warn(p("recommendation","query pipeline")),this.searchHub&&this.searchHub!==e.state.searchHub&&console.warn(p("recommendation","search hub")),this.internalInitialization((()=>this.engine=e))}async getRecommendations(){this.commonInterfaceHelper.engineIsCreated(this.engine)&&(this.initialized?this.engine.dispatch(s(this.engine).getRecommendations()):console.error('You have to wait until the "initialize" promise is fulfilled before executing a search.',this.host))}async getOrganizationEndpoints(e,t="prod"){return n(e,t)}updateIconAssetsPath(){this.store.set("iconAssetsPath",this.iconAssetsPath)}handleInitialization(e){this.commonInterfaceHelper.onComponentInitializing(e)}updateLanguage(){if(!this.commonInterfaceHelper.engineIsCreated(this.engine))return;const{updateSearchConfiguration:e}=a(this.engine);this.engine.dispatch(e({locale:this.language})),this.commonInterfaceHelper.onLanguageChange()}toggleAnalytics(){this.commonInterfaceHelper.engineIsCreated(this.engine)&&this.commonInterfaceHelper.onAnalyticsChange()}registerFieldsToInclude(){const e=r.concat([...this.fieldsToInclude].filter((e=>!!e)));this.engine.dispatch(h(this.engine).registerFieldsToInclude(e))}async internalInitialization(e){await this.commonInterfaceHelper.onInitialization(e),this.pipeline=this.engine.state.pipeline,this.searchHub=this.engine.state.searchHub,this.store.unsetLoadingFlag(A),this.initialized=!0}initEngine(e){var t;const i=b(e,this.analytics);try{this.engine=o({configuration:{pipeline:this.pipeline,searchHub:null!==(t=this.searchHub)&&void 0!==t?t:"default",locale:this.language,timezone:this.timezone,...e,analytics:i},loggerOptions:{level:this.logLevel}})}catch(e){throw this.error=e,e}}render(){return this.engine&&i("slot",null)}get host(){return e(this)}static get watchers(){return{iconAssetsPath:["updateIconAssetsPath"],language:["updateLanguage"],analytics:["toggleAnalytics"]}}};v([g()],I.prototype,"fieldsToInclude",void 0);export{I as atomic_recs_interface};