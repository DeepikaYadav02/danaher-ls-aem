{"version":3,"names":["resultCss","AtomicRecsResult","this","executedRenderingFunctionOnce","display","density","imageSize","classes","resolveResult","event","preventDefault","stopPropagation","detail","result","resolveInteractiveResult","interactiveResult","resolveStopPropagation","resolveResultDisplayConfig","connectedCallback","layout","ResultLayout","content","children","getContentHTML","Array","from","map","child","outerHTML","join","isCustomRenderFunctionMode","renderingFunction","undefined","shouldExecuteRenderFunction","resultRootRef","render","h","Host","class","resultComponentClass","ref","getClasses","concat","innerHTML","componentDidLoad","loadingFlag","store","unsetLoadingFlag","applyFocusVisiblePolyfill","host","componentDidRender","customRenderOutputAsString","className"],"sources":["src/components/common/result/result.pcss?tag=atomic-recs-result&encapsulation=shadow","src/components/recommendations/atomic-recs-result/atomic-recs-result.tsx"],"sourcesContent":["@import '../../../global/global.pcss';\n@import '../../../global/mixins.pcss';\n@import './result-with-sections.pcss';\n@import './result-row-desktop.pcss';\n@import './result-row-mobile.pcss';\n@import './result-cell-desktop.pcss';\n@import './result-cell-mobile.pcss';\n\n:host {\n  @apply font-sans font-normal;\n}\n\n.result-root {\n  &.with-sections {\n    @mixin result-with-sections;\n\n    &.display-list {\n      @screen desktop-only {\n        @mixin row-result-desktop;\n      }\n      @screen mobile-only {\n        @mixin row-result-mobile;\n      }\n    }\n    &.display-grid {\n      a,\n      button {\n        position: relative;\n      }\n\n      &.image-large {\n        @screen desktop-only {\n          @mixin cell-result-desktop;\n        }\n        @screen mobile-only {\n          @mixin row-result-mobile;\n        }\n      }\n      &.image-small,\n      &.image-icon,\n      &.image-none {\n        @screen desktop-only {\n          @mixin cell-result-desktop;\n        }\n        @screen mobile-only {\n          @mixin cell-result-mobile;\n        }\n      }\n    }\n    &.display-table {\n      @mixin row-result-desktop;\n    }\n  }\n\n  atomic-table-element {\n    display: none;\n  }\n}\n","import {Component, h, Prop, Element, Listen, Host} from '@stencil/core';\nimport {RecsInteractiveResult, RecsResult} from '..';\nimport {applyFocusVisiblePolyfill} from '../../../utils/initialization-utils';\nimport {\n  ResultLayout,\n  ResultDisplayDensity,\n  ResultDisplayImageSize,\n  ResultDisplayLayout,\n} from '../../common/layout/display-options';\nimport {resultComponentClass} from '../../common/result-list/result-list-common';\nimport {ResultRenderingFunction} from '../../common/result-list/result-list-common-interface';\nimport {\n  DisplayConfig,\n  InteractiveResultContextEvent,\n  ResultContextEvent,\n} from '../../search/result-template-components/result-template-decorators';\nimport {AtomicRecsStore} from '../atomic-recs-interface/store';\n\n/**\n * The `atomic-recs-result` component is used internally by the `atomic-recs-list` component.\n */\n@Component({\n  tag: 'atomic-recs-result',\n  styleUrl: '../../common/result/result.pcss',\n  shadow: true,\n})\nexport class AtomicRecsResult {\n  private layout!: ResultLayout;\n  private resultRootRef?: HTMLElement;\n  private executedRenderingFunctionOnce = false;\n  @Element() host!: HTMLElement;\n\n  /**\n   * Whether an atomic-result-link inside atomic-recs-result should stop click event propagation.\n   */\n  @Prop() stopPropagation?: boolean;\n\n  /**\n   * The result item.\n   */\n  @Prop() result!: RecsResult;\n\n  /**\n   * The InteractiveResult item.\n   * @internal\n   */\n  @Prop() interactiveResult!: RecsInteractiveResult;\n\n  /**\n   * Global Atomic state.\n   * @internal\n   */\n  @Prop() store?: AtomicRecsStore;\n\n  /**\n   * The result content to display.\n   */\n  @Prop() content?: ParentNode;\n\n  /**\n   * The layout to apply to display results.\n   */\n  @Prop() display: ResultDisplayLayout = 'list';\n\n  /**\n   * The size of the results.\n   */\n  @Prop() density: ResultDisplayDensity = 'normal';\n\n  /**\n   * The size of the visual section in result list items.\n   *\n   * This is overwritten by the image size defined in the result content, if it exists.\n   */\n  @Prop() imageSize: ResultDisplayImageSize = 'icon';\n\n  /**\n   * The classes to add to the result element.\n   */\n  @Prop() classes = '';\n\n  /**\n   * @internal\n   */\n  @Prop() loadingFlag?: string;\n\n  /**\n   * Internal function used by atomic-recs-list in advanced setups, which lets you bypass the standard HTML template system.\n   * Particularly useful for Atomic React\n   *\n   * @internal\n   */\n  @Prop() renderingFunction: ResultRenderingFunction;\n\n  @Listen('atomic/resolveResult')\n  public resolveResult(event: ResultContextEvent<RecsResult>) {\n    event.preventDefault();\n    event.stopPropagation();\n    event.detail(this.result);\n  }\n\n  @Listen('atomic/resolveInteractiveResult')\n  public resolveInteractiveResult(event: InteractiveResultContextEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n    event.detail(this.interactiveResult);\n  }\n\n  @Listen('atomic/resolveStopPropagation')\n  public resolveStopPropagation(event: CustomEvent) {\n    event.detail(this.stopPropagation);\n  }\n\n  @Listen('atomic/resolveResultDisplayConfig')\n  public resolveResultDisplayConfig(event: ResultContextEvent<DisplayConfig>) {\n    event.preventDefault();\n    event.stopPropagation();\n    event.detail({\n      density: this.density,\n      imageSize: this.imageSize!,\n    });\n  }\n\n  public connectedCallback() {\n    this.layout = new ResultLayout(\n      this.content!.children,\n      this.display,\n      this.density,\n      this.imageSize\n    );\n  }\n\n  private getContentHTML() {\n    return Array.from(this.content!.children)\n      .map((child) => child.outerHTML)\n      .join('');\n  }\n\n  private get isCustomRenderFunctionMode() {\n    return this.renderingFunction !== undefined;\n  }\n\n  private shouldExecuteRenderFunction() {\n    return (\n      this.isCustomRenderFunctionMode &&\n      this.resultRootRef &&\n      !this.executedRenderingFunctionOnce\n    );\n  }\n\n  public render() {\n    if (this.isCustomRenderFunctionMode) {\n      return (\n        <Host class={resultComponentClass}>\n          <div\n            class=\"result-root\"\n            ref={(ref) => (this.resultRootRef = ref)}\n          ></div>\n        </Host>\n      );\n    }\n    return (\n      // deepcode ignore ReactSetInnerHtml: This is not React code\n      <Host class={resultComponentClass}>\n        <div\n          class={`result-root ${this.layout\n            .getClasses()\n            .concat(this.classes)\n            .join(' ')}`}\n          innerHTML={this.getContentHTML()}\n        ></div>\n      </Host>\n    );\n  }\n\n  public componentDidLoad() {\n    if (this.loadingFlag && this.store) {\n      this.store.unsetLoadingFlag(this.loadingFlag);\n    }\n    applyFocusVisiblePolyfill(this.host);\n  }\n\n  public componentDidRender() {\n    if (this.shouldExecuteRenderFunction()) {\n      const customRenderOutputAsString = this.renderingFunction!(\n        this.result,\n        this.resultRootRef!\n      );\n\n      this.resultRootRef!.className += ` ${this.layout\n        .getClasses(customRenderOutputAsString)\n        .concat(this.classes)\n        .join(' ')}`;\n\n      this.executedRenderingFunctionOnce = true;\n    }\n  }\n}\n"],"mappings":"6aAAA,MAAMA,EAAY,s26G,MC0BLC,EAAgB,M,yBAGnBC,KAAAC,8BAAgC,MAiChCD,KAAAE,QAA+B,OAK/BF,KAAAG,QAAgC,SAOhCH,KAAAI,UAAoC,OAKpCJ,KAAAK,QAAU,G,+IAjBqB,O,aAKC,S,eAOI,O,aAK1B,G,4DAgBX,aAAAC,CAAcC,GACnBA,EAAMC,iBACND,EAAME,kBACNF,EAAMG,OAAOV,KAAKW,O,CAIb,wBAAAC,CAAyBL,GAC9BA,EAAMC,iBACND,EAAME,kBACNF,EAAMG,OAAOV,KAAKa,kB,CAIb,sBAAAC,CAAuBP,GAC5BA,EAAMG,OAAOV,KAAKS,gB,CAIb,0BAAAM,CAA2BR,GAChCA,EAAMC,iBACND,EAAME,kBACNF,EAAMG,OAAO,CACXP,QAASH,KAAKG,QACdC,UAAWJ,KAAKI,W,CAIb,iBAAAY,GACLhB,KAAKiB,OAAS,IAAIC,EAChBlB,KAAKmB,QAASC,SACdpB,KAAKE,QACLF,KAAKG,QACLH,KAAKI,U,CAID,cAAAiB,GACN,OAAOC,MAAMC,KAAKvB,KAAKmB,QAASC,UAC7BI,KAAKC,GAAUA,EAAMC,YACrBC,KAAK,G,CAGV,8BAAYC,GACV,OAAO5B,KAAK6B,oBAAsBC,S,CAG5B,2BAAAC,GACN,OACE/B,KAAK4B,4BACL5B,KAAKgC,gBACJhC,KAAKC,6B,CAIH,MAAAgC,GACL,GAAIjC,KAAK4B,2BAA4B,CACnC,OACEM,EAACC,EAAI,CAACC,MAAOC,GACXH,EAAA,OACEE,MAAM,cACNE,IAAMA,GAAStC,KAAKgC,cAAgBM,I,CAK5C,OAEEJ,EAACC,EAAI,CAACC,MAAOC,GACXH,EAAA,OACEE,MAAO,eAAepC,KAAKiB,OACxBsB,aACAC,OAAOxC,KAAKK,SACZsB,KAAK,OACRc,UAAWzC,KAAKqB,mB,CAMjB,gBAAAqB,GACL,GAAI1C,KAAK2C,aAAe3C,KAAK4C,MAAO,CAClC5C,KAAK4C,MAAMC,iBAAiB7C,KAAK2C,Y,CAEnCG,EAA0B9C,KAAK+C,K,CAG1B,kBAAAC,GACL,GAAIhD,KAAK+B,8BAA+B,CACtC,MAAMkB,EAA6BjD,KAAK6B,kBACtC7B,KAAKW,OACLX,KAAKgC,eAGPhC,KAAKgC,cAAekB,WAAa,IAAIlD,KAAKiB,OACvCsB,WAAWU,GACXT,OAAOxC,KAAKK,SACZsB,KAAK,OAER3B,KAAKC,8BAAgC,I"}