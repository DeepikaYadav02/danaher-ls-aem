{"version":3,"names":["disconnectedException","noEndpointsException","invalidTokenException","organizationIsPausedException","QueryErrorCommon","props","renderShowMoreInfo","showMoreInfo","h","Button","part","style","class","onClick","onShowMoreInfo","text","bindings","i18n","t","JSON","stringify","queryErrorState","error","getOrg","engine","state","configuration","organizationId","getUrl","platformUrl","getErrorType","type","getDetails","icon","NoConnection","title","description","url","interpolation","escapeValue","Indexing","org","link","CannotAccess","SearchInactive","SomethingWrong","hasError","details","setAriaLive","href"],"sources":["src/components/common/query-error/query-error-common.tsx"],"sourcesContent":["import {FunctionalComponent, h} from '@stencil/core';\nimport CannotAccess from '../../../images/cannot-access.svg';\nimport Indexing from '../../../images/indexing.svg';\nimport NoConnection from '../../../images/no-connection.svg';\nimport SearchInactive from '../../../images/search-inactive.svg';\nimport SomethingWrong from '../../../images/something-wrong.svg';\nimport {Button} from '../button';\nimport {AnyBindings} from '../interface/bindings';\n\nconst disconnectedException = 'Disconnected';\nconst noEndpointsException = 'NoEndpointsException';\nconst invalidTokenException = 'InvalidTokenException';\nconst organizationIsPausedException = 'OrganizationIsPausedException';\n\ninterface QueryErrorDetails {\n  icon: string;\n  title: string;\n  description: string;\n  link?: string;\n}\n\ninterface QueryErrorCommonProps {\n  showMoreInfo: boolean;\n  onShowMoreInfo: () => void;\n  bindings: AnyBindings;\n  queryErrorState: {\n    hasError: boolean;\n    error: {\n      /**\n       * The HTTP status code.\n       */\n      statusCode: number;\n      /**\n       * The error message.\n       */\n      message: string;\n      /**\n       * The error stack.\n       */\n      stack?: string;\n      /**\n       * The error type.\n       */\n      type: string;\n    } | null;\n  };\n  setAriaLive: (message: string) => void;\n}\n\nexport const QueryErrorCommon: FunctionalComponent<QueryErrorCommonProps> = (\n  props\n) => {\n  const renderShowMoreInfo = () => {\n    if (!props.showMoreInfo) {\n      return (\n        <Button\n          part=\"more-info-btn\"\n          style=\"primary\"\n          class=\"p-3 mt-8\"\n          onClick={props.onShowMoreInfo}\n          text={props.bindings.i18n.t('more-info')}\n        ></Button>\n      );\n    }\n\n    return (\n      <pre\n        part=\"error-info\"\n        class=\"text-left border border-neutral bg-neutral-light p-3 rounded mt-8 whitespace-pre-wrap\"\n      >\n        <code>{JSON.stringify(props.queryErrorState.error, null, 2)}</code>\n      </pre>\n    );\n  };\n\n  const getOrg = () => {\n    return props.bindings.engine.state.configuration.organizationId;\n  };\n\n  const getUrl = () => {\n    return props.bindings.engine.state.configuration.platformUrl;\n  };\n\n  const getErrorType = () => {\n    return props.queryErrorState.error!.type;\n  };\n\n  const getDetails = (): QueryErrorDetails => {\n    switch (getErrorType()) {\n      case disconnectedException:\n        return {\n          icon: NoConnection,\n          title: props.bindings.i18n.t('disconnected'),\n          description: props.bindings.i18n.t('check-your-connection', {\n            url: getUrl(),\n            interpolation: {escapeValue: false},\n          }),\n        };\n      case noEndpointsException:\n        return {\n          icon: Indexing,\n          title: props.bindings.i18n.t('no-endpoints', {org: getOrg()}),\n          description: props.bindings.i18n.t('add-sources'),\n          link: 'https://docs.coveo.com/', // TODO: KIT-1061 update link\n        };\n      case invalidTokenException:\n        return {\n          icon: CannotAccess,\n          title: props.bindings.i18n.t('cannot-access', {org: getOrg()}),\n          description: props.bindings.i18n.t('invalid-token'),\n          link: 'https://docs.coveo.com/', // TODO: KIT-1061 update link\n        };\n      case organizationIsPausedException:\n        return {\n          icon: SearchInactive,\n          title: props.bindings.i18n.t('organization-is-paused', {\n            org: getOrg(),\n          }),\n          description: props.bindings.i18n.t('organization-will-resume', {\n            org: getOrg(),\n          }),\n          link: 'https://docs.coveo.com/l6af0467',\n        };\n      default:\n        return {\n          icon: SomethingWrong,\n          title: props.bindings.i18n.t('something-went-wrong'),\n          description: props.bindings.i18n.t('if-problem-persists'),\n        };\n    }\n  };\n\n  if (!props.queryErrorState.hasError) {\n    return;\n  }\n\n  const details = getDetails();\n\n  props.setAriaLive(`${details.title} ${details.description}`);\n\n  return (\n    <div class=\"text-center\">\n      <atomic-icon\n        part=\"icon\"\n        icon={details.icon}\n        class=\"w-1/2 mt-8 max-w-lg\"\n      ></atomic-icon>\n      <p part=\"title\" class=\"text-2xl text-on-background mt-8\">\n        {details.title}\n      </p>\n      <p part=\"description\" class=\"text-lg text-neutral-dark mt-2.5\">\n        {details.description}\n      </p>\n      {details.link ? (\n        <a\n          href={details.link}\n          part=\"doc-link\"\n          class=\"btn-primary p-3 mt-10 inline-block\"\n        >\n          {props.bindings.i18n.t('coveo-online-help')}\n        </a>\n      ) : (\n        renderShowMoreInfo()\n      )}\n    </div>\n  );\n};\n"],"mappings":"okjFASA,MAAMA,EAAwB,eAC9B,MAAMC,EAAuB,uBAC7B,MAAMC,EAAwB,wBAC9B,MAAMC,EAAgC,gC,MAqCzBC,EACXC,IAEA,MAAMC,EAAqB,KACzB,IAAKD,EAAME,aAAc,CACvB,OACEC,EAACC,EAAM,CACLC,KAAK,gBACLC,MAAM,UACNC,MAAM,WACNC,QAASR,EAAMS,eACfC,KAAMV,EAAMW,SAASC,KAAKC,EAAE,c,CAKlC,OACEV,EAAA,OACEE,KAAK,aACLE,MAAM,yFAENJ,EAAA,YAAOW,KAAKC,UAAUf,EAAMgB,gBAAgBC,MAAO,KAAM,IACrD,EAIV,MAAMC,EAAS,IACNlB,EAAMW,SAASQ,OAAOC,MAAMC,cAAcC,eAGnD,MAAMC,EAAS,IACNvB,EAAMW,SAASQ,OAAOC,MAAMC,cAAcG,YAGnD,MAAMC,EAAe,IACZzB,EAAMgB,gBAAgBC,MAAOS,KAGtC,MAAMC,EAAa,KACjB,OAAQF,KACN,KAAK9B,EACH,MAAO,CACLiC,KAAMC,EACNC,MAAO9B,EAAMW,SAASC,KAAKC,EAAE,gBAC7BkB,YAAa/B,EAAMW,SAASC,KAAKC,EAAE,wBAAyB,CAC1DmB,IAAKT,IACLU,cAAe,CAACC,YAAa,UAGnC,KAAKtC,EACH,MAAO,CACLgC,KAAMO,EACNL,MAAO9B,EAAMW,SAASC,KAAKC,EAAE,eAAgB,CAACuB,IAAKlB,MACnDa,YAAa/B,EAAMW,SAASC,KAAKC,EAAE,eACnCwB,KAAM,2BAEV,KAAKxC,EACH,MAAO,CACL+B,KAAMU,EACNR,MAAO9B,EAAMW,SAASC,KAAKC,EAAE,gBAAiB,CAACuB,IAAKlB,MACpDa,YAAa/B,EAAMW,SAASC,KAAKC,EAAE,iBACnCwB,KAAM,2BAEV,KAAKvC,EACH,MAAO,CACL8B,KAAMW,EACNT,MAAO9B,EAAMW,SAASC,KAAKC,EAAE,yBAA0B,CACrDuB,IAAKlB,MAEPa,YAAa/B,EAAMW,SAASC,KAAKC,EAAE,2BAA4B,CAC7DuB,IAAKlB,MAEPmB,KAAM,mCAEV,QACE,MAAO,CACLT,KAAMY,EACNV,MAAO9B,EAAMW,SAASC,KAAKC,EAAE,wBAC7BkB,YAAa/B,EAAMW,SAASC,KAAKC,EAAE,wB,EAK3C,IAAKb,EAAMgB,gBAAgByB,SAAU,CACnC,M,CAGF,MAAMC,EAAUf,IAEhB3B,EAAM2C,YAAY,GAAGD,EAAQZ,SAASY,EAAQX,eAE9C,OACE5B,EAAA,OAAKI,MAAM,eACTJ,EAAA,eACEE,KAAK,OACLuB,KAAMc,EAAQd,KACdrB,MAAM,wBAERJ,EAAA,KAAGE,KAAK,QAAQE,MAAM,oCACnBmC,EAAQZ,OAEX3B,EAAA,KAAGE,KAAK,cAAcE,MAAM,oCACzBmC,EAAQX,aAEVW,EAAQL,KACPlC,EAAA,KACEyC,KAAMF,EAAQL,KACdhC,KAAK,WACLE,MAAM,sCAELP,EAAMW,SAASC,KAAKC,EAAE,sBAGzBZ,IAEE,S"}