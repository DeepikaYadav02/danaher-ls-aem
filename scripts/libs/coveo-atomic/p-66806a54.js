import{h as t,F as e}from"./p-591772f1.js";import{g as s}from"./p-a7ba7276.js";import{u as i}from"./p-38b8e15b.js";import{o as r,d as n}from"./p-a5540571.js";import{R as l,T as a}from"./p-0edd74fe.js";import{e as o}from"./p-1e65cba6.js";import{g as u}from"./p-8e330e22.js";import{L as c}from"./p-72d5eb61.js";import{t as h}from"./p-4328fcc3.js";const d=e=>e.getResultListState().results.map(((s,i)=>{const l=o(s),r=e.getInteractiveResult(l);return t("div",{part:"result-list-grid-clickable-container outline",ref:t=>e.setNewResultRef(t,i),onClick:t=>{t.preventDefault(),r.select(),window.open(l.clickUri,t.ctrlKey||t.metaKey?"_blank":e.gridCellLinkTarget,"noopener")}},t(c,{part:"result-list-grid-clickable",onSelect:()=>r.select(),onBeginDelayedSelect:()=>r.beginDelayedSelect(),onCancelPendingSelect:()=>r.cancelPendingSelect(),href:l.clickUri,title:l.title,target:e.gridCellLinkTarget,rel:"noopener"},l.title),e.renderResult({key:e.getResultId(s),result:s,interactiveResult:e.getInteractiveResult(l),store:e.bindings.store,content:e.resultTemplateProvider.getTemplateContent(s),loadingFlag:e.loadingFlag,display:e.getResultDisplay(),density:e.getDensity(),imageSize:e.getImageSize(),renderingFunction:e.getResultRenderingFunction()}))})),p=t=>t.getResultListState().results.map(((e,s)=>t.renderResult({key:t.getResultId(e),part:"outline",result:e,interactiveResult:t.getInteractiveResult(o(e)),store:t.bindings.store,content:t.resultTemplateProvider.getTemplateContent(e),loadingFlag:t.loadingFlag,display:t.getResultDisplay(),density:t.getDensity(),imageSize:t.getImageSize(),ref:e=>t.setNewResultRef(e,s),renderingFunction:t.getResultRenderingFunction()}))),f=e=>{const s=m(e);return s.length||e.bindings.engine.logger.error("atomic-table-element elements missing in the result template to display columns.",e.host),t("table",{class:`list-root ${e.listClasses}`,part:"result-table"},t("thead",{part:"result-table-heading"},t("tr",{part:"result-table-heading-row"},s.map((e=>t("th",{part:"result-table-heading-cell"},t("atomic-text",{value:e.getAttribute("label")})))))),t("tbody",{part:"result-table-body"},e.getResultListState().results.map(((i,l)=>t("tr",{key:e.getResultId(i),part:"result-table-row "+(l%2==1?"result-table-row-even":"result-table-row-odd"),ref:t=>e.setNewResultRef(t,l)},s.map((s=>{const l=s.getAttribute("label")+e.getResultId(i);return t("td",{key:l,part:"result-table-cell"},e.renderResult({result:i,interactiveResult:e.getInteractiveResult(o(i)),store:e.bindings.store,content:s,loadingFlag:e.loadingFlag,display:e.getResultDisplay(),density:e.getDensity(),imageSize:e.getImageSize()}))})))))))},m=t=>t.getResultRenderingFunction()?g(t):b(t),g=t=>{const e=document.createElement("div"),s=t.getResultRenderingFunction()(t.getResultListState().results[0],document.createElement("div"));return e.innerHTML=s,Array.from(e.querySelectorAll(h))},b=t=>Array.from(t.resultTemplateProvider.getTemplateContent(t.getResultListState().results[0]).querySelectorAll(h)),y="result-component";class v{constructor(t){this.props=t,this.props.bindings.store.setLoadingFlag(this.props.loadingFlag),this.props.bindings.store.registerResultList(this),this.addUpdateBreakpointOnce()}addUpdateBreakpointOnce(){this.updateBreakpoints=r((t=>{i(t)}))}getResultId(t){return`${o(t).uniqueId}${this.props.getResultListState().searchResponseId}${this.props.getDensity()}${this.props.getImageSize()}`}setNewResultRef(t,e){var i,l;if(0===e&&(this.firstResultEl=t),e!==this.indexOfResultToFocus)return;if(!t.children.length&&!(null===(i=t.shadowRoot)||void 0===i?void 0:i.children.length))return;this.indexOfResultToFocus=void 0;const r=null!==(l=s(t))&&void 0!==l?l:t;this.props.nextNewResultTarget.setTarget(r)}focusOnNextNewResult(){this.indexOfResultToFocus=this.props.getResultListState().results.length,this.props.nextNewResultTarget.focusOnNextTarget()}async focusOnFirstResultAfterNextSearch(){return await n(),new Promise((t=>{this.props.getResultListState().isLoading&&(this.firstResultEl=void 0);const e=this.props.bindings.engine.subscribe((async()=>{var i;if(await n(),!this.props.getResultListState().isLoading&&this.firstResultEl){const l=null!==(i=s(this.firstResultEl))&&void 0!==i?i:this.firstResultEl;this.props.nextNewResultTarget.setTarget(l),this.props.nextNewResultTarget.focus(),this.firstResultEl=void 0,e(),t()}}))}))}get displayPlaceholders(){return!this.props.bindings.store.isAppLoaded()}get listClasses(){const t=u(this.props.getLayoutDisplay(),this.props.getDensity(),this.props.getImageSize());return this.props.getResultListState().firstSearchExecuted&&this.props.getResultListState().isLoading&&t.push("loading"),this.displayPlaceholders&&t.push("placeholder"),t.join(" ")}render(){var s;if(null===(s=this.updateBreakpoints)||void 0===s||s.call(this,this.props.host),this.props.resultTemplateProvider.templatesRegistered&&!this.props.getResultListState().hasError&&(!this.props.getResultListState().firstSearchExecuted||this.props.getResultListState().hasResults))return t(e,null,this.props.resultTemplateProvider.hasError&&t("slot",null),t("div",{class:`list-wrapper ${this.listClasses}`},t(w,{listClasses:this.listClasses,display:this.props.getLayoutDisplay()},this.displayPlaceholders&&t(R,{numberOfPlaceholders:this.props.getNumberOfPlaceholders(),density:this.props.getDensity(),display:this.props.getResultDisplay(),imageSize:this.props.getImageSize()}),this.props.getResultListState().firstSearchExecuted&&t(j,{getResultId:t=>this.getResultId(t),listClasses:this.listClasses,setNewResultRef:(...t)=>this.setNewResultRef(...t),...this.props}))))}}const w=(e,s)=>"table"===e.display?s:t("div",{class:`list-root ${e.listClasses}`,part:"result-list"},s),R=e=>"table"===e.display?t(a,{...e}):t(l,{...e}),j=e=>{if(!e.getResultListState().results.length)return null;switch(e.getLayoutDisplay()){case"table":return t(f,{...e});case"grid":return t(d,{...e});default:return t(p,{...e})}};export{v as R,y as r};