{"version":3,"names":["atomicFieldConditionCss","AtomicFieldCondition","this","conditions","mustMatch","mustNotMatch","shouldBeRemoved","componentWillLoad","ifDefined","fieldNames","split","push","ResultTemplatesHelpers","fieldsMustBeDefined","ifNotDefined","fieldsMustNotBeDefined","makeMatchConditions","render","every","condition","result","h","componentDidLoad","host","remove","__decorate","MapProp","splitValues","ResultContext"],"sources":["src/components/search/result-template-components/atomic-field-condition/atomic-field-condition.pcss?tag=atomic-field-condition","src/components/search/result-template-components/atomic-field-condition/atomic-field-condition.tsx"],"sourcesContent":["atomic-field-condition {\n  max-width: 100%;\n}\n","import {\n  Result,\n  ResultTemplateCondition,\n  ResultTemplatesHelpers,\n} from '@coveo/headless';\nimport {Component, Prop, h, Element} from '@stencil/core';\nimport {MapProp} from '../../../../utils/props-utils';\nimport {makeMatchConditions} from '../../../common/result-templates/result-template-common';\nimport {ResultContext} from '../result-template-decorators';\n\n/**\n * The `atomic-field-condition` component takes a list of conditions that, if fulfilled, apply the template in which it's defined.\n * @MapProp name: mustMatch;attr: must-match;docs: The field and values that define which result items the condition must be applied to. For example, a template with the following attribute only applies to result items whose `filetype` is `lithiummessage` or `YouTubePlaylist`: `must-match-filetype=\"lithiummessage,YouTubePlaylist\"`;type: Record<string, string[]> ;default: {}\n * @MapProp name: mustNotMatch;attr: must-not-match;docs: The field and values that define which result items the condition must not be applied to. For example, a template with the following attribute only applies to result items whose `filetype` is not `lithiummessage`: `must-not-match-filetype=\"lithiummessage\";type: Record<string, string[]> ;default: {}\n */\n@Component({\n  tag: 'atomic-field-condition',\n  styleUrl: 'atomic-field-condition.pcss',\n  shadow: false,\n})\nexport class AtomicFieldCondition {\n  @Element() host!: HTMLElement;\n\n  /**\n   * Verifies whether the specified fields are defined.\n   */\n  @Prop({reflect: true}) ifDefined?: string;\n  /**\n   * Verifies whether the specified fields are not defined.\n   */\n  @Prop({reflect: true}) ifNotDefined?: string;\n  /**\n   * A function that must return true on results for the result template to apply.\n   * Set programmatically before initialization, not via attribute.\n   *\n   * For example, the following targets a template and sets a condition to make it apply only to results whose `title` contains `singapore`:\n   * `document.querySelector('#target-template').conditions = [(result) => /singapore/i.test(result.title)];`\n   */\n  @Prop() conditions: ResultTemplateCondition[] = [];\n\n  @MapProp({splitValues: true}) mustMatch: Record<string, string[]> = {};\n\n  @MapProp({splitValues: true}) mustNotMatch: Record<string, string[]> = {};\n\n  private shouldBeRemoved = false;\n\n  @ResultContext() private result!: Result;\n\n  public componentWillLoad() {\n    if (this.ifDefined) {\n      const fieldNames = this.ifDefined.split(',');\n      this.conditions.push(\n        ResultTemplatesHelpers.fieldsMustBeDefined(fieldNames)\n      );\n    }\n\n    if (this.ifNotDefined) {\n      const fieldNames = this.ifNotDefined.split(',');\n      this.conditions.push(\n        ResultTemplatesHelpers.fieldsMustNotBeDefined(fieldNames)\n      );\n    }\n\n    this.conditions.push(\n      ...makeMatchConditions(this.mustMatch, this.mustNotMatch)\n    );\n  }\n\n  public render() {\n    if (!this.conditions.every((condition) => condition(this.result))) {\n      this.shouldBeRemoved = true;\n      return '';\n    }\n\n    return <slot />;\n  }\n\n  public componentDidLoad() {\n    this.shouldBeRemoved && this.host.remove();\n  }\n}\n"],"mappings":"kVAAA,MAAMA,EAA0B,yC,iXCoBnBC,EAAoB,M,yBAkBvBC,KAAAC,WAAwC,GAElBD,KAAAE,UAAsC,GAEtCF,KAAAG,aAAyC,GAE/DH,KAAAI,gBAAkB,M,qEANsB,E,CAUzC,iBAAAC,GACL,GAAIL,KAAKM,UAAW,CAClB,MAAMC,EAAaP,KAAKM,UAAUE,MAAM,KACxCR,KAAKC,WAAWQ,KACdC,EAAuBC,oBAAoBJ,G,CAI/C,GAAIP,KAAKY,aAAc,CACrB,MAAML,EAAaP,KAAKY,aAAaJ,MAAM,KAC3CR,KAAKC,WAAWQ,KACdC,EAAuBG,uBAAuBN,G,CAIlDP,KAAKC,WAAWQ,QACXK,EAAoBd,KAAKE,UAAWF,KAAKG,c,CAIzC,MAAAY,GACL,IAAKf,KAAKC,WAAWe,OAAOC,GAAcA,EAAUjB,KAAKkB,UAAU,CACjElB,KAAKI,gBAAkB,KACvB,MAAO,E,CAGT,OAAOe,EAAA,Y,CAGF,gBAAAC,GACLpB,KAAKI,iBAAmBJ,KAAKqB,KAAKC,Q,6BAtCNC,EAAA,CAA7BC,EAAQ,CAACC,YAAa,Q,gCAEOF,EAAA,CAA7BC,EAAQ,CAACC,YAAa,Q,mCAIEF,EAAA,CAAxBG,K"}